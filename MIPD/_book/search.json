[
  {
    "objectID": "Machine_Learning.html",
    "href": "Machine_Learning.html",
    "title": "3  Machine learning dose prediction",
    "section": "",
    "text": "3.1 XGboost\nThe data is preprocessed to have the log-transformed daily dose as target variable which allows to reach the target concentration and the data is stratified based on dosing scheme.\nFor ML, algorithms are trained on covariates to predict the daily dose which allows to reach a concentration of 60 mg/L. The target dose is obtained by linear extrapolation to attain 60 mg/L. For intermittent infusion, the daily dose is fractioned by the number of administrations. The predictors are the covariates (WT, CREAT, BURN, OBESE, ICU, SEX, AGE) as well as the dosing scheme coded as the number of daily administrations (INF - 1 for continuous infusion).\nThe tidymodels workflow is used which is incorporated in a fit-for-purpose way in our openMIPD package.\nXGBoost is based on decision trees and the boosting algorithm, developing trees sequentially to correct the prediction errors of previous trees. Model overfitting is controlled by incorporating Lasso (L1) and Ridge (L2) algorithms. XGBoost is faster and has better computational efficiency compared to Random Forest. While XGBoost is less interpretable, it is better suited for larger datasets than Random Forest. Whereas Random Forest helps reduce variance, XGBoost primarily reduces bias.\nThe hyperparameters to define are as follows:\nShow the code\nXGB_results &lt;- openMIPD::xgb_train(train = train_preprocessed, continuous_cov = c(\"WT\", \"CREAT\", \"AGE\", \"INF\"), categorical_cov = c(\"BURN\", \"OBESE\", \"SEX\", \"ICU\"))\nA variable importance plot is generated which show the contribution of different predictors to the results. Also, the tuning and hyperparameter optimization is visualized.\nShow the code\nXGB_results$tune_plot_xgb # tuning\n\n\n\n\n\n\n\n\n\nShow the code\nXGB_results$final_wf_xgb # optimized hyperparameters\n\n\n══ Workflow ════════════════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: boost_tree()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n2 Recipe Steps\n\n• step_mutate_at()\n• step_dummy()\n\n── Model ───────────────────────────────────────────────────────────────────────\nBoosted Tree Model Specification (regression)\n\nMain Arguments:\n  trees = 2000\n  min_n = 31\n  tree_depth = 4\n  learn_rate = 0.0464158883361278\n\nComputational engine: xgboost \n\n\nShow the code\nXGB_VIP &lt;- XGB_results$xgb_vip # variable importance plot\nXGB_VIP\n\n\n\n\n\n\n\n\n\nShow the code\nggsave(filename = here(\"Amoxicillin/Figures/S16a.jpg\"),\n       plot = XGB_VIP,\n       width = 8, height = 6, dpi = 600)\n\nfinal_xgb_fit &lt;- XGB_results$final_xgb_fit\nShow the code\ntest_XGB &lt;- openMIPD::xgb_test(final_fit = final_xgb_fit, test = test_preprocessed)\nShow the code\nta_results_XGB &lt;- explore_predictions(data = test_XGB, DOSE_PRED = \"XGBoost\")\nta_results_XGB$target_attainment\n\n\n\n\n\n\n\n\n\nShow the code\nta_results_XGB$summary_stats\n\n\n# A tibble: 2 × 10\n  Prediction_correctness Count Obese mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE\n  &lt;chr&gt;                  &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 Correct                  218    67      0.998    0.568    82.1  17.5     62.0\n2 Incorrect                382   150      0.923    0.584    85.7  19.2     58.7\n# ℹ 2 more variables: sd_AGE &lt;dbl&gt;, Proportion &lt;dbl&gt;",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Machine learning dose prediction</span>"
    ]
  },
  {
    "objectID": "Machine_Learning.html#xgboost",
    "href": "Machine_Learning.html#xgboost",
    "title": "3  Machine learning dose prediction",
    "section": "",
    "text": "η – learning rate (default: 0.3)\nγ – the minimum loss required for a new split; if increased, the algorithm becomes more conservative\nmax depth – tree depth (typical values range from 3 to 10)\nminimum child weight - minimum number of observations in the terminal node\nλ/α – regularization parameters for Ridge/Lasso\nmax levels – maximum number of nodes",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Machine learning dose prediction</span>"
    ]
  },
  {
    "objectID": "Machine_Learning.html#random-forest",
    "href": "Machine_Learning.html#random-forest",
    "title": "3  Machine learning dose prediction",
    "section": "3.2 Random forest",
    "text": "3.2 Random forest\nA decision tree is a model that represents possible decision paths in a schematic tree-like structure. In regression trees, node splitting is done to minimize intra-group variance. In classification trees, node purity can be measured using the Gini index, where f is the frequency of observations:\n\\[\n\\text{Gini index} = 2 \\cdot f \\cdot (1 - f)\n\\]\nIntroduced in 2001, Random Forest (RF) is a machine learning method based on an ensemble of decision trees. It uses the bootstrap aggregating algorithm (commonly known as bagging). The performance of an RF model is measured by prediction error, which corresponds to the mean squared error (MSE) for regression problems. Random Forest helps reduce variance, making it suitable for unstable, unbiased data.\nHyperparameters to define:\n\nNumber of trees (typically around 400)\nmtry – the number of variables considered at each node. Default value is \\(\\sqrt{\\text{number of predictors}}\\)\nNumber of observations in the terminal node (leaf)\n\n\n\nShow the code\nRF_results &lt;- openMIPD::rf_train(train = train_preprocessed, continuous_cov = c(\"WT\", \"CREAT\", \"AGE\", \"INF\"), categorical_cov = c(\"BURN\", \"OBESE\", \"SEX\", \"ICU\"))\n\n\nA variable importance plot is generated which show the contribution of different predictors to the results. Also, the tuning and hyperparameter optimization is visualized.\n\n\nShow the code\nRF_results$tune_plot_rf # tuning\n\n\n\n\n\n\n\n\n\nShow the code\nRF_results$final_wf_rf # optimized hyperparameters\n\n\n══ Workflow ════════════════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: rand_forest()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n2 Recipe Steps\n\n• step_mutate_at()\n• step_dummy()\n\n── Model ───────────────────────────────────────────────────────────────────────\nRandom Forest Model Specification (regression)\n\nMain Arguments:\n  mtry = 3\n  trees = 1777\n\nEngine-Specific Arguments:\n  importance = impurity\n\nComputational engine: ranger \n\n\nShow the code\nRF_VIP &lt;- RF_results$rf_vip # variable importance plot\nRF_VIP\n\n\n\n\n\n\n\n\n\nShow the code\nggsave(filename = here(\"Amoxicillin/Figures/S16b.jpg\"),\n       plot = RF_VIP,\n       width = 8, height = 6, dpi = 600)\nfinal_rf_fit &lt;- RF_results$final_rf_fit\n\n\n\n\nShow the code\ntest_RF &lt;- openMIPD::rf_test(final_fit = final_rf_fit, test = test_preprocessed)\n\n\n\n\nShow the code\nta_results_RF &lt;- explore_predictions(test_RF, DOSE_PRED = \"RF\")\nta_results_RF$target_attainment\n\n\n\n\n\n\n\n\n\nShow the code\nta_results_RF$summary_stats\n\n\n# A tibble: 2 × 10\n  Prediction_correctness Count Obese mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE\n  &lt;chr&gt;                  &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 Correct                  221    69      1.03     0.590    82.1  17.9     63.4\n2 Incorrect                379   148      0.903    0.568    85.8  19.0     57.9\n# ℹ 2 more variables: sd_AGE &lt;dbl&gt;, Proportion &lt;dbl&gt;",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Machine learning dose prediction</span>"
    ]
  },
  {
    "objectID": "Machine_Learning.html#support-vector-machine",
    "href": "Machine_Learning.html#support-vector-machine",
    "title": "3  Machine learning dose prediction",
    "section": "3.3 Support Vector Machine",
    "text": "3.3 Support Vector Machine\nIntroduced in 1995, Support Vector Machines (SVM) classify data by finding a hyperplane that maximizes the distance between classes in a multi-dimensional space. SVM regression predicts a continuous target by fitting a function with a tolerance for small deviations from the true values and penalizing large errors. SVM regression can capture non-linear relationships and is less sensible to outliers compared to linear regression. Unlike K-Nearest Neighbors (KNN), SVM is effective for high-dimensional data.\n\nCost – regularization parameter that determines the weight given to classification errors. If cost increases, tolerance for classification errors decreases. A smaller cost improves generalizability.\nσ – controls the shape of the decision boundary. A smaller value captures local trends better but may lead to overfitting and reduced generalizability.\n\n\n\nShow the code\nSVM_results &lt;- openMIPD::svm_train(train = train_preprocessed, continuous_cov = c(\"WT\", \"CREAT\", \"AGE\", \"INF\"), categorical_cov = c(\"BURN\", \"OBESE\", \"SEX\", \"ICU\"))\n\n\n\n\nShow the code\nSVM_results$tune_plot_svm # tuning\n\n\n\n\n\n\n\n\n\nShow the code\nSVM_results$final_wf_svm # optimized hyperparameters\n\n\n══ Workflow ════════════════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: svm_rbf()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n3 Recipe Steps\n\n• step_mutate_at()\n• step_dummy()\n• step_normalize()\n\n── Model ───────────────────────────────────────────────────────────────────────\nRadial Basis Function Support Vector Machine Model Specification (regression)\n\nMain Arguments:\n  cost = 0.0992125657480125\n  rbf_sigma = 0.0774263682681128\n\nComputational engine: kernlab \n\n\nShow the code\nfinal_svm_fit &lt;- SVM_results$final_svm_fit\n\n\n\n\nShow the code\ntest_SVM &lt;- openMIPD::svm_test(final_fit = final_svm_fit, test = test_preprocessed)\n\n\n\n\nShow the code\nta_results_SVM &lt;- explore_predictions(test_SVM, DOSE_PRED = \"SVM\")\nta_results_SVM$target_attainment\n\n\n\n\n\n\n\n\n\nShow the code\nta_results_SVM$summary_stats\n\n\n# A tibble: 2 × 10\n  Prediction_correctness Count Obese mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE\n  &lt;chr&gt;                  &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 Correct                  222    84      0.987    0.543    84.7  19.2     61.3\n2 Incorrect                378   133      0.929    0.598    84.2  18.4     59.1\n# ℹ 2 more variables: sd_AGE &lt;dbl&gt;, Proportion &lt;dbl&gt;",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Machine learning dose prediction</span>"
    ]
  },
  {
    "objectID": "Machine_Learning.html#k-nearest-neighbors-knn",
    "href": "Machine_Learning.html#k-nearest-neighbors-knn",
    "title": "3  Machine learning dose prediction",
    "section": "3.4 K-nearest neighbors (KNN)",
    "text": "3.4 K-nearest neighbors (KNN)\nKNN is a simple, non-parametric algorithm that is less sensitive to outliers and is used to create clusters and make predictions based on the similarity of data points. The disadvantage of KNN is that the algorithm can take a long time to run, and it is less suited for high-dimensional data.\n\nThe value of k is determined through 10-fold cross-validation.\nThe distance is calculated between all data points and the target point.\nThe k nearest neighbors are selected.\nThe average of the target values of these nearest neighbors will be the prediction for the given point.\n\nThe most commonly used distance metrics are as follows:\n\nEuclidean Distance: The most commonly used; a straight line connecting two points in vector space. This distance is well-suited for outliers and noise but less suitable for data with different scales or high dimensionality. \\[\nd(x, y) = \\sqrt{(x - y)^2}\n\\]\nManhattan Distance: Well-suited for categorical data and high-dimensional data. It is less suitable for data with different scales.\n\n\\[\nd(x, y) = |x - y|\n\\]\n\nMinkowski Distance: A generalization of the two previous distances. It has an additional parameter, p, that controls the importance given to differences between data points. If p = 2, it becomes the Euclidean distance, and if p = 1, it becomes the Manhattan distance. This distance is suitable for mixed data but is less interpretable, and the value of p needs to be defined.\n\n\\[\nd(x, y) = \\left| (x - y)^p \\right|^{1/p}\n\\]\nEuclidean distance is the default distance used and it is the most interpretable and intuitive. Hyperparameters to define:\n\nk\np (if Minkowski distance is used)\n\n\n\nShow the code\nKNN_results &lt;- openMIPD::knn_train(train = train_preprocessed, continuous_cov = c(\"WT\", \"CREAT\", \"AGE\", \"INF\"), categorical_cov = c(\"BURN\", \"OBESE\", \"SEX\", \"ICU\"))\n\n\n\n\nShow the code\nKNN_results$tune_plot_knn # tuning\n\n\n\n\n\n\n\n\n\nShow the code\nKNN_results$final_wf_knn # optimized hyperparameters\n\n\n══ Workflow ════════════════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: nearest_neighbor()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n3 Recipe Steps\n\n• step_mutate_at()\n• step_dummy()\n• step_normalize()\n\n── Model ───────────────────────────────────────────────────────────────────────\nK-Nearest Neighbor Model Specification (regression)\n\nMain Arguments:\n  neighbors = 15\n\nComputational engine: kknn \n\n\nShow the code\nfinal_knn_fit &lt;- KNN_results$final_knn_fit\n\n\n\n\nShow the code\ntest_KNN &lt;- openMIPD::knn_test(final_fit = final_knn_fit, test = test_preprocessed)\n\n\n\n\nShow the code\nta_results_KNN &lt;- explore_predictions(test_KNN, DOSE_PRED = \"KNN\")\nta_results_KNN$target_attainment\n\n\n\n\n\n\n\n\n\nShow the code\nta_results_KNN$summary_stats\n\n\n# A tibble: 2 × 10\n  Prediction_correctness Count Obese mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE\n  &lt;chr&gt;                  &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 Correct                  218    77      1.02     0.621    82.8  19.5     62.8\n2 Incorrect                382   140      0.909    0.550    85.3  18.2     58.3\n# ℹ 2 more variables: sd_AGE &lt;dbl&gt;, Proportion &lt;dbl&gt;",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Machine learning dose prediction</span>"
    ]
  },
  {
    "objectID": "Machine_Learning.html#stacking",
    "href": "Machine_Learning.html#stacking",
    "title": "3  Machine learning dose prediction",
    "section": "3.5 Stacking",
    "text": "3.5 Stacking\nThe blend_predictions function determines how member model output will ultimately be combined in the final prediction by fitting a Lasso model on the data stack, predicting the true assessment set outcome using the predictions from each of the candidate members. Candidates with nonzero stacking coefficients become members.\nThese plots the meta-learning model over a predefined grid of lasso penalty values and uses an internal resampling method to determine the best value. The autoplot() method, shown helps us understand if the default penalization method was sufficient. It can also be used to visualize the contribution of each model type.\n\n\nShow the code\namox_cmin &lt;- stacks() %&gt;%\n    add_candidates(XGB_results$tune_res_xgb) %&gt;%\n    add_candidates(SVM_results$tune_res_svm) %&gt;%\n    add_candidates(RF_results$tune_res_rf) %&gt;%\n    add_candidates(KNN_results$tune_res_knn)\n  \n  conflicted::conflicts_prefer(brulee::coef)\n  \n  set.seed(1234)\n  amox_cmin_ens &lt;- amox_cmin %&gt;% blend_predictions()\n  \n  # fit ensembled members\n  set.seed(1234)\n  amox_cmin_ens &lt;- amox_cmin_ens %&gt;% fit_members()\n\n\nTo evaluate training, the evolution of metrics with the number of members and the contribution of different stacking members are plotted.\n\n\nShow the code\n  # Stacking plots\n  stacking_autoplot_default &lt;- autoplot(amox_cmin_ens)\n  stacking_members_plot &lt;- autoplot(amox_cmin_ens, type = \"members\")\n  stacking_weights_plot &lt;- autoplot(amox_cmin_ens, type = \"weights\")\n  ggsave(filename = here(\"Amoxicillin/Figures/S17.jpg\"),\n       plot = stacking_weights_plot,\n       width = 8, height = 6, dpi = 600)\n  \n  stacking_autoplot_default\n\n\n\n\n\n\n\n\n\nShow the code\n  stacking_members_plot\n\n\n\n\n\n\n\n\n\nShow the code\n  stacking_weights_plot\n\n\n\n\n\n\n\n\n\n\n\nShow the code\n  # Make predictions with stacking\n  stack_preds &lt;- predict(amox_cmin_ens, new_data = test_preprocessed) %&gt;%\n    dplyr::pull(.pred)\n\n\nTarget attainment and corresponding statistics are calculated for the predictions.\n\n\nShow the code\n  # Add stacking to the test table\n  test_STACK &lt;- test_preprocessed %&gt;%\n    dplyr::mutate(\n      STACK = exp(stack_preds) * (II / 24)\n    )\n  \nta_results_STACK &lt;- explore_predictions(test_STACK, DOSE_PRED = \"STACK\")\nta_results_STACK$target_attainment\n\n\n\n\n\n\n\n\n\nShow the code\nta_results_STACK$summary_stats\n\n\n# A tibble: 2 × 10\n  Prediction_correctness Count Obese mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE\n  &lt;chr&gt;                  &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 Correct                  164    50      0.983    0.557    80.4  16.6     66.1\n2 Incorrect                436   167      0.938    0.587    85.9  19.2     57.6\n# ℹ 2 more variables: sd_AGE &lt;dbl&gt;, Proportion &lt;dbl&gt;",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Machine learning dose prediction</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Agema, Bram C, Tolra Kocher, Ayşenur B Öztürk, Eline L Giraud, Nielka P\nvan Erp, Brenda C M de Winter, Ron H J Mathijssen, Stijn L W Koolen,\nBirgit C P Koch, and Sebastiaan D T Sassen. 2024. “Selecting the\nBest Pharmacokinetic Models for a Priori Model-Informed Precision Dosing\nwith Model Ensembling.” Clin. Pharmacokinet. 63 (10):\n1449–61.\n\n\nGuilhaumou, Romain, Sihem Benaboud, Youssef Bennis, Claire\nDahyot-Fizelier, Eric Dailly, Peggy Gandia, Sylvain Goutelle, et al.\n2019. “Optimization of the Treatment with Beta-Lactam Antibiotics\nin Critically Ill Patients-Guidelines from the French Society of\nPharmacology and Therapeutics (Société\nFrançaise de Pharmacologie Et Thérapeutique-SFPT) and the French Society of\nAnaesthesia and Intensive Care Medicine\n(Société Française\nd’anesthésie Et Réanimation-SFAR).” Crit.\nCare 23 (1): 104.\n\n\nRambaud, Antoine, Benjamin Jean Gaborit, Colin Deschanvres, Paul Le\nTurnier, Raphaël Lecomte, Nathalie Asseray-Madani, Anne-Gaëlle Leroy, et\nal. 2020. “Development and Validation of a Dosing Nomogram for\nAmoxicillin in Infective Endocarditis.” The Journal of\nAntimicrobial Chemotherapy 75 (10): 2941–50. https://doi.org/10.1093/jac/dkaa232.",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "Precision_dosing_methods.html",
    "href": "Precision_dosing_methods.html",
    "title": "2  Precision dosing approaches",
    "section": "",
    "text": "3 Generate predictions with each model\nShow the code\nAMOX_CMIN_OBS_TRAIN &lt;- read.csv(here(\"Amoxicillin/Data/AMOX_CMIN_OBS_TRAIN.csv\"), quote = \"\") |&gt; \n  mutate(\n    SEX_CAT = case_when(\n      SEX == 0 ~ \"M\",\n      SEX == 1 ~ \"F\"\n    )\n  ) |&gt;\n  rowwise() |&gt; \n  mutate(CRCL_CKD_EPI_BSA_NORM = estimate_GFR(AGE,CREAT,SEX_CAT)) |&gt; \n  ungroup() |&gt; \n  mutate(CRCL_CKD_EPI_ABSOLUTE = CRCL_CKD_EPI_BSA_NORM * (BSA/1.73))\n\nAMOX_CMIN_OBS_TEST &lt;- read.csv(here(\"Amoxicillin/Data/AMOX_CMIN_OBS_TEST.csv\"), quote = \"\") |&gt; \n  mutate(\n    SEX_CAT = case_when(\n      SEX == 0 ~ \"M\",\n      SEX == 1 ~ \"F\"\n    )\n  ) |&gt;\n  rowwise() |&gt; \n  mutate(CRCL_CKD_EPI_BSA_NORM = estimate_GFR(AGE,CREAT,SEX_CAT)) |&gt; \n  ungroup() |&gt; \n  mutate(CRCL_CKD_EPI_ABSOLUTE = CRCL_CKD_EPI_BSA_NORM * (BSA/1.73))\nShow the code\nperform_mrgsolve_prediction &lt;- function(input_data,\n                                        mrgsolve_model_path,\n                                        model_name,\n                                        cmin_target) {\n  \n  full_data &lt;- select(input_data,-MODEL) #MODEL column identifies the model with which the prediction was made thus we have to drop it to be able to join later on\n\ndata_for_mrgsolve &lt;- input_data |&gt;\n  select(\n    ID,\n    TIME,\n    CREAT,\n    BURN,\n    ICU,\n    OBESE,\n    AGE,\n    SEX,\n    HT,\n    BSA,\n    DOSE_ADM,\n    FREQ,\n    DUR,\n    CMIN_IND,\n    MODEL_COHORT\n  ) |&gt; distinct()\n\nmrgsolve_model &lt;- mread_cache(mrgsolve_model_path)\n\nmrgsolve_dose_data &lt;- \n      rename(data_for_mrgsolve,\n           AMT = DOSE_ADM,\n           II = FREQ\n           ) |&gt; \n  mutate(RATE = AMT/DUR,\n         ADDL = TIME/II - 1,\n         TIME = 0,\n         EVID = 1,\n         CMT = 1)\n\nmrgsolve_obs_data &lt;- rename(data_for_mrgsolve,\n           AMT = DOSE_ADM,\n           II = FREQ\n           ) |&gt; \n  mutate(RATE = NA,\n         ADDL = NA,\n         EVID = 0,\n         CMT = 1)\n  \nmrgsolve_input_data &lt;- bind_rows(mrgsolve_dose_data,\n                                        mrgsolve_obs_data) |&gt; \n  arrange(ID,-EVID)\n\nmrgsolve_model |&gt; \n  data_set(mrgsolve_input_data) |&gt; \n  zero_re() |&gt;  \n  mrgsim(obsonly = TRUE,\n         recover = colnames(mrgsolve_input_data)) |&gt;\n  as_tibble() |&gt; \n  rename(CMIN_PRED = IPRED) |&gt; \n  mutate(MODEL = model_name) |&gt; \n  select(ID,MODEL,CMIN_PRED) |&gt; \n  right_join(full_data) |&gt; \n  mutate(DOSE_PRED = cmin_target/CMIN_PRED * DOSE_ADM)\n  \n}",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "Precision_dosing_methods.html#carlier",
    "href": "Precision_dosing_methods.html#carlier",
    "title": "2  Precision dosing approaches",
    "section": "3.1 CARLIER",
    "text": "3.1 CARLIER\n\n\nShow the code\nAMOX_CMIN_PRED_TRAIN_CARLIER &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TRAIN ,\n  mrgsolve_model_path = here(\n    \"Amoxicillin/Simulations/amox_Carlier\"\n  ),\n  model_name = \"CARLIER\",\n  cmin_target = 60 #mg/L\n) \n\nAMOX_CMIN_PRED_TEST_CARLIER &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TEST ,\n  mrgsolve_model_path = here(\n    \"Amoxicillin/Simulations/amox_Carlier\"\n  ),\n  model_name = \"CARLIER\",\n  cmin_target = 60 #mg/L\n)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "Precision_dosing_methods.html#fournier",
    "href": "Precision_dosing_methods.html#fournier",
    "title": "2  Precision dosing approaches",
    "section": "3.2 FOURNIER",
    "text": "3.2 FOURNIER\n\n\nShow the code\nAMOX_CMIN_PRED_TRAIN_FOURNIER &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TRAIN ,\n  mrgsolve_model_path = here(\n    \"Amoxicillin/Simulations/amox_Fournier\"\n  ),\n  model_name = \"FOURNIER\",\n  cmin_target = 60 #mg/L\n) \n\nAMOX_CMIN_PRED_TEST_FOURNIER &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TEST ,\n  mrgsolve_model_path = here(\n    \"Amoxicillin/Simulations/amox_Fournier\"\n  ),\n  model_name = \"FOURNIER\",\n  cmin_target = 60 #mg/L\n)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "Precision_dosing_methods.html#mellon",
    "href": "Precision_dosing_methods.html#mellon",
    "title": "2  Precision dosing approaches",
    "section": "3.3 MELLON",
    "text": "3.3 MELLON\n\n\nShow the code\nAMOX_CMIN_PRED_TRAIN_MELLON &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TRAIN ,\n  mrgsolve_model_path = here(\n    \"Amoxicillin/Simulations/amox_Mellon\"\n  ),\n  model_name = \"MELLON\",\n  cmin_target = 60 #mg/L\n) \n\nAMOX_CMIN_PRED_TEST_MELLON &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TEST ,\n  mrgsolve_model_path = here(\n    \"Amoxicillin/Simulations/amox_Mellon\"\n  ),\n  model_name = \"MELLON\",\n  cmin_target = 60 #mg/L\n)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "Precision_dosing_methods.html#rambaud",
    "href": "Precision_dosing_methods.html#rambaud",
    "title": "2  Precision dosing approaches",
    "section": "3.4 RAMBAUD",
    "text": "3.4 RAMBAUD\n\n\nShow the code\nAMOX_CMIN_PRED_TRAIN_RAMBAUD &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TRAIN ,\n  mrgsolve_model_path = here(\n    \"Amoxicillin/Simulations/amox_Rambaud\"\n  ),\n  model_name = \"RAMBAUD\",\n  cmin_target = 60 #mg/L\n) \n\nAMOX_CMIN_PRED_TEST_RAMBAUD &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TEST ,\n  mrgsolve_model_path = here(\n    \"Amoxicillin/Simulations/amox_Rambaud\"\n  ),\n  model_name = \"RAMBAUD\",\n  cmin_target = 60 #mg/L\n)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "Precision_dosing_methods.html#pool-all-predictions-and-save-them",
    "href": "Precision_dosing_methods.html#pool-all-predictions-and-save-them",
    "title": "2  Precision dosing approaches",
    "section": "3.5 Pool all predictions and save them",
    "text": "3.5 Pool all predictions and save them\n\n\nShow the code\nAMOX_CMIN_TRAIN &lt;- bind_rows(\n  AMOX_CMIN_PRED_TRAIN_CARLIER,\n  AMOX_CMIN_PRED_TRAIN_FOURNIER,\n  AMOX_CMIN_PRED_TRAIN_MELLON,\n  AMOX_CMIN_PRED_TRAIN_RAMBAUD\n  ) |&gt; \n  arrange(ID,MODEL) |&gt; \n  mutate(REFERENCE = if_else(MODEL == MODEL_COHORT, 1, 0)) # Add a variable called REFERENCE which is 1 for the the line where the model used for simulation is the same as the model cohort (otherwise 0) and take only observed values\n\nwrite.csv(AMOX_CMIN_TRAIN, here(\"Amoxicillin/Data/AMOX_CMIN_TRAIN.csv\"), row.names = FALSE, quote = FALSE)\n\nAMOX_CMIN_TEST &lt;- bind_rows(\n  AMOX_CMIN_PRED_TEST_CARLIER,\n  AMOX_CMIN_PRED_TEST_FOURNIER,\n  AMOX_CMIN_PRED_TEST_MELLON,\n  AMOX_CMIN_PRED_TEST_RAMBAUD\n  ) |&gt; \n  arrange(ID,MODEL) |&gt; \n  mutate(REFERENCE = if_else(MODEL == MODEL_COHORT, 1, 0)) # Add a variable called REFERENCE which is 1 for the the line where the model used for simulation is the same as the model cohort (otherwise 0) and take only observed values\n\nwrite.csv(AMOX_CMIN_TEST, here(\"Amoxicillin/Data/AMOX_CMIN_TEST.csv\"), row.names = FALSE, quote = FALSE)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "Precision_dosing_methods.html#global-inspection-of-model-predictions",
    "href": "Precision_dosing_methods.html#global-inspection-of-model-predictions",
    "title": "2  Precision dosing approaches",
    "section": "3.6 Global inspection of model predictions",
    "text": "3.6 Global inspection of model predictions\n\n3.6.1 Within-cohort performance (inter-individual variability)\nVisualization of the inter-individual variability of models by dividing PRED (predicted) values by IPRED (observed) both generated by the same model.\n\n\nShow the code\n# CMIN\n# Divide each PRED by the IPRED reference \nAMOX_CMIN2 &lt;- bind_rows(AMOX_CMIN_TRAIN,AMOX_CMIN_TEST) %&gt;%\n  filter(REFERENCE == 1) |&gt; \n  group_by(ID, MODEL) %&gt;%\n  mutate(\n    ratio = (CMIN_PRED / CMIN_IND) * 100\n  ) %&gt;%\n  ungroup()\n\n# Boxplot of ratios stratified by model\nstratified_ratios_CMIN &lt;- ggplot(AMOX_CMIN2, aes(x = MODEL, y = ratio, fill = MODEL)) +\n  geom_boxplot() +\n  geom_hline(yintercept = 80, linetype = \"dashed\", color = \"red\") + \n  geom_hline(yintercept = 125, linetype = \"dashed\", color = \"red\") +\n  labs(\n    title = \"Predicted/observed ratios for the same model (Cmax)\",\n    x = \"MODEL\",\n    y = \"Ratio (%)\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  theme(\n    axis.text.x = element_text(angle = 20, hjust = 1, size = 16),\n    axis.text = element_text(size = 16),    \n    axis.title = element_text(size = 20), \n    plot.title = element_text(size=20),\n  )\n\nstratified_ratios_CMIN + scale_y_log10()\n\n\n\n\n\n\n\n\n\n\n\n3.6.2 Full dataset performance (model performance)\nIn this section, the focus is no longer solely on observed concentrations (IPRED), but the performance of the models is explored by illustrating how the predicted concentrations (PRED) for all the cohorts (not just for covariates on which the model was developed) compare the the observed concentration. Visualization of PRED/IPRED ratios. In all cases we compare PRED (predicted) values to a reference IPRED (observed), which is the IPRED of the model whose cohort was used to simulate a particular set of covariates. Red lines indicate the bioequivalence range of 80-125 %.\n\n\nShow the code\n# CMIN\n# Divide each PRED by the IPRED reference \nAMOX_CMIN3 &lt;- bind_rows(AMOX_CMIN_TRAIN,AMOX_CMIN_TEST) %&gt;%\n  group_by(ID) %&gt;%\n  mutate(\n    ref_CMIN = first(CMIN_IND[REFERENCE == 1], default = NA),\n    ratio = (CMIN_PRED / ref_CMIN) * 100\n  ) %&gt;%\n  ungroup()\n\n# Boxplot of ratios stratified by model\nperf_CMIN &lt;- ggplot(AMOX_CMIN3, aes(x = MODEL, y = ratio, fill = MODEL)) +\n  geom_boxplot() +\n  scale_y_log10() +\n  geom_hline(yintercept = 80, linetype = \"dashed\", color = \"red\") + \n  geom_hline(yintercept = 125, linetype = \"dashed\", color = \"red\") +\n  labs(\n    title = \"Boxplots of predicted/observed ratios (CMIN)\",\n    x = \"MODEL\",\n    y = \"Ratio (%)\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  theme(\n    axis.text.x = element_text(angle = 20, hjust = 1, size = 16),\n    axis.text = element_text(size = 16),    \n    axis.title = element_text(size = 20), \n    plot.title = element_text(size=20),\n  )\n\nperf_CMIN",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "Precision_dosing_methods.html#carlier-1",
    "href": "Precision_dosing_methods.html#carlier-1",
    "title": "2  Precision dosing approaches",
    "section": "4.1 CARLIER",
    "text": "4.1 CARLIER\n\n\nShow the code\n# In this specific case predictions were already\n# created before, thus \"making predictions\"\n# simply involve loading them and filtering for the correct model\nAMOX_CMIN_PRED_TRAIN_CARLIER &lt;- read_csv(\n  here(\"Amoxicillin/Data/AMOX_CMIN_TRAIN.csv\")\n  ) |&gt; \n  filter(MODEL == \"CARLIER\")\n\nAMOX_CMIN_PRED_TEST_CARLIER &lt;- read_csv(\n  here(\"Amoxicillin/Data/AMOX_CMIN_TEST.csv\")\n  ) |&gt; \n  filter(MODEL == \"CARLIER\")\n\n\n\n\nShow the code\nresults_carlier_train &lt;- explore_predictions(AMOX_CMIN_PRED_TRAIN_CARLIER)\nresults_carlier_train$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_carlier_train &lt;- results_carlier_train$creat_plot\ncreat_plot_carlier_train\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_carlier_train &lt;- results_carlier_train$crcl_plot\ncrcl_plot_carlier_train\n\n\n\n\n\n\n\n\n\nShow the code\nresults_carlier_train$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     0.982    0.558    79.0  14.2     64.1   17.2   512\n2 Incorrect                   0.912    0.606    86.4  19.0     57.4   15.6  1363\n# ℹ 1 more variable: Proportion &lt;dbl&gt;\n\n\n\n\nShow the code\nresults_carlier_test &lt;- explore_predictions(AMOX_CMIN_PRED_TEST_CARLIER)\nresults_carlier_test$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_carlier_test &lt;- results_carlier_test$creat_plot\ncreat_plot_carlier_test\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_carlier_test &lt;- results_carlier_test$crcl_plot\ncrcl_plot_carlier_test\n\n\n\n\n\n\n\n\n\nShow the code\nresults_carlier_test$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     1.02     0.593    79.7  14.8     65.1   17.3   171\n2 Incorrect                   0.921    0.571    86.3  19.7     57.9   15.6   429\n# ℹ 1 more variable: Proportion &lt;dbl&gt;",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "Precision_dosing_methods.html#fournier-1",
    "href": "Precision_dosing_methods.html#fournier-1",
    "title": "2  Precision dosing approaches",
    "section": "4.2 FOURNIER",
    "text": "4.2 FOURNIER\n\n\nShow the code\n# In this specific case predictions were already\n# created before, thus \"making predictions\"\n# simply involve loading them and filtering for the correct model\nAMOX_CMIN_PRED_TRAIN_FOURNIER &lt;- read_csv(\n  here(\"Amoxicillin/Data/AMOX_CMIN_TRAIN.csv\")\n  ) |&gt; \n  filter(MODEL == \"FOURNIER\")\n\nAMOX_CMIN_PRED_TEST_FOURNIER &lt;- read_csv(\n  here(\"Amoxicillin/Data/AMOX_CMIN_TEST.csv\")\n  ) |&gt; \n  filter(MODEL == \"FOURNIER\")\n\n\n\n\nShow the code\nresults_fournier_train &lt;- explore_predictions(AMOX_CMIN_PRED_TRAIN_FOURNIER)\nresults_fournier_train$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_fournier_train &lt;- results_fournier_train$creat_plot\ncreat_plot_fournier_train\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_fournier_train &lt;- results_fournier_train$crcl_plot\ncrcl_plot_fournier_train\n\n\n\n\n\n\n\n\n\nShow the code\nresults_fournier_train$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     0.965    0.608    80.7  16.1     64.1   17.9   605\n2 Incorrect                   0.914    0.586    86.1  18.7     56.9   15.0  1270\n# ℹ 1 more variable: Proportion &lt;dbl&gt;\n\n\n\n\nShow the code\nresults_fournier_test &lt;- explore_predictions(AMOX_CMIN_PRED_TEST_FOURNIER)\nresults_fournier_test$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_fournier_test &lt;- results_fournier_test$creat_plot\ncreat_plot_fournier_test\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_fournier_test &lt;- results_fournier_test$crcl_plot\ncrcl_plot_fournier_test\n\n\n\n\n\n\n\n\n\nShow the code\nresults_fournier_test$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     0.907    0.432    79.0  15.8     62.7   16.9   191\n2 Incorrect                   0.970    0.635    86.9  19.4     58.6   16.0   409\n# ℹ 1 more variable: Proportion &lt;dbl&gt;",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "Precision_dosing_methods.html#mellon-1",
    "href": "Precision_dosing_methods.html#mellon-1",
    "title": "2  Precision dosing approaches",
    "section": "4.3 MELLON",
    "text": "4.3 MELLON\n\n\nShow the code\n# In this specific case predictions were already\n# created before, thus \"making predictions\"\n# simply involve loading them and filtering for the correct model\nAMOX_CMIN_PRED_TRAIN_MELLON &lt;- read_csv(\n  here(\"Amoxicillin/Data/AMOX_CMIN_TRAIN.csv\")\n  ) |&gt; \n  filter(MODEL == \"MELLON\")\n\nAMOX_CMIN_PRED_TEST_MELLON &lt;- read_csv(\n  here(\"Amoxicillin/Data/AMOX_CMIN_TEST.csv\")\n  ) |&gt; \n  filter(MODEL == \"MELLON\")\n\n\n\n\nShow the code\nresults_mellon_train &lt;- explore_predictions(AMOX_CMIN_PRED_TRAIN_MELLON)\nresults_mellon_train$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_mellon_train &lt;- results_mellon_train$creat_plot\ncreat_plot_mellon_train\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_mellon_train &lt;- results_mellon_train$crcl_plot\ncrcl_plot_mellon_train\n\n\n\n\n\n\n\n\n\nShow the code\nresults_mellon_train$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     0.681    0.177    94.9  19.3     52.9   11.9   290\n2 Incorrect                   0.977    0.630    82.4  17.2     60.4   16.8  1585\n# ℹ 1 more variable: Proportion &lt;dbl&gt;\n\n\n\n\nShow the code\nresults_mellon_test &lt;- explore_predictions(AMOX_CMIN_PRED_TEST_MELLON)\nresults_mellon_test$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_mellon_test &lt;- results_mellon_test$creat_plot\ncreat_plot_mellon_test\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_mellon_test &lt;- results_mellon_test$crcl_plot\ncrcl_plot_mellon_test\n\n\n\n\n\n\n\n\n\nShow the code\nresults_mellon_test$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     0.713    0.184    93.0  21.8     49.5   13.1    87\n2 Incorrect                   0.990    0.612    82.9  17.7     61.7   16.2   513\n# ℹ 1 more variable: Proportion &lt;dbl&gt;",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "Precision_dosing_methods.html#rambaud-1",
    "href": "Precision_dosing_methods.html#rambaud-1",
    "title": "2  Precision dosing approaches",
    "section": "4.4 RAMBAUD",
    "text": "4.4 RAMBAUD\n\n\nShow the code\n# In this specific case predictions were already\n# created before, thus \"making predictions\"\n# simply involve loading them and filtering for the correct model\nAMOX_CMIN_PRED_TRAIN_RAMBAUD &lt;- read_csv(\n  here(\"Amoxicillin/Data/AMOX_CMIN_TRAIN.csv\")\n  ) |&gt; \n  filter(MODEL == \"RAMBAUD\")\n\nAMOX_CMIN_PRED_TEST_RAMBAUD &lt;- read_csv(\n  here(\"Amoxicillin/Data/AMOX_CMIN_TEST.csv\")\n  ) |&gt; \n  filter(MODEL == \"RAMBAUD\")\n\n\n\n\nShow the code\nresults_rambaud_train &lt;- explore_predictions(AMOX_CMIN_PRED_TRAIN_RAMBAUD)\nresults_rambaud_train$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_rambaud_train &lt;- results_rambaud_train$creat_plot\ncreat_plot_rambaud_train\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_rambaud_train &lt;- results_rambaud_train$crcl_plot\ncrcl_plot_rambaud_train\n\n\n\n\n\n\n\n\n\nShow the code\nresults_rambaud_train$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     1.07     0.492    77.4  13.6     70.9   14.6   329\n2 Incorrect                   0.901    0.609    85.9  18.6     56.7   15.6  1546\n# ℹ 1 more variable: Proportion &lt;dbl&gt;\n\n\n\n\nShow the code\nresults_rambaud_test &lt;- explore_predictions(AMOX_CMIN_PRED_TEST_RAMBAUD)\nresults_rambaud_test$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_rambaud_test &lt;- results_rambaud_test$creat_plot\ncreat_plot_rambaud_test\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_rambaud_test &lt;- results_rambaud_test$crcl_plot\ncrcl_plot_rambaud_test\n\n\n\n\n\n\n\n\n\nShow the code\nresults_rambaud_test$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     1.09     0.645    76.5  15.2     70.1   14.1   104\n2 Incorrect                   0.921    0.560    86.1  19.0     57.8   16.0   496\n# ℹ 1 more variable: Proportion &lt;dbl&gt;",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "Precision_dosing_methods.html#meta-model",
    "href": "Precision_dosing_methods.html#meta-model",
    "title": "2  Precision dosing approaches",
    "section": "4.5 Meta model",
    "text": "4.5 Meta model\nThis is an ensembling method where a PopPK model is built based on data simulated with the four models (Carlier, Fournier, Mellon, and Rambaud).\nThe model is built on the training set used for the ensembling algorithms and tested on the test set. The data is rich and does not contain below quantification limit concentrations. The 3 three compartment structural model was a better fit than a two compartment one (OFV drop &lt; 0.1 %), however as the estimate of the second peripheral volume was negligeable (&lt; 1 L), the two-compartment model was preferred. The pharmacostatistical model is developed using the automatic statistical model building tool in Monolix 2024R1. The best model has IIV on all parameters with no covariance between them. The error model is combined with log-normal distribution.\nThe covariate model is built using the automatic SCM tool of Monolix with respective forward and backward p values of 5 and 1 % (Likelihood Ratio Test). CREAT and WT were added on the clearance.\n\n\nShow the code\nAMOX_CMIN_PRED_TEST_META &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TEST ,\n  mrgsolve_model_path = here(\n    \"Amoxicillin/MIPD/amox_Meta\"\n  ),\n  model_name = \"META\",\n  cmin_target = 60 #mg/L\n) \n\n\n\n\nShow the code\nresults_meta_test &lt;- explore_predictions(AMOX_CMIN_PRED_TEST_META)\nresults_meta_test$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_meta_test &lt;- results_meta_test$creat_plot\ncreat_plot_meta_test\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_meta_test &lt;- results_meta_test$crcl_plot\ncrcl_plot_meta_test\n\n\n\n\n\n\n\n\n\nShow the code\nresults_meta_test$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     0.839    0.301    86.3  20.4     60.4   15.7   168\n2 Incorrect                   0.993    0.651    83.6  17.9     59.7   16.6   432\n# ℹ 1 more variable: Proportion &lt;dbl&gt;",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  }
]