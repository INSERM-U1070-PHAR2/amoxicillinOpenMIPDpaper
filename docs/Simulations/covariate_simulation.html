<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Covariate simulation – STP-BRIOCHE : A priori MIPD - Amoxicillin</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Simulations/concentrations_simulation.html" rel="next">
<link href="../Model_implementation_validation/quarto/valid_amox_mellon_hammas_2020.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-364982630eef5352dd1537128a8ed5cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Simulations/covariate_simulation.html">Simulations</a></li><li class="breadcrumb-item"><a href="../Simulations/covariate_simulation.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Covariate simulation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">STP-BRIOCHE : A priori MIPD - Amoxicillin</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Validation of implementation from articles</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Model_implementation_validation/quarto/valid_amox_carlier_2013.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Validation PKpop Amox Carlier 2013</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Model_implementation_validation/quarto/valid_amox_fournier_2018.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Validation PKpop Amox Fournier 2018</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Model_implementation_validation/quarto/valid_rambaud_2020.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Model_implementation_validation/quarto/valid_amox_mellon_hammas_2020.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Validation PKpop Amox Mellon 2020</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Simulations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Simulations/covariate_simulation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Covariate simulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Simulations/concentrations_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Simulation of concentrations and secondary PK parameters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Simulations/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">MIPD</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../MIPD/Objectives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Objectives</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../MIPD/Precision_dosing_methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Precision dosing approaches</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../MIPD/Machine_Learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Machine learning dose prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../MIPD/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Sensitivity analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Sensitivity_analysis/Sensitivity_analysis_explication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Sensitivity analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#objective" id="toc-objective" class="nav-link active" data-scroll-target="#objective"><span class="header-section-number">5.1</span> Objective</a></li>
  <li><a href="#carlier2013-bq" id="toc-carlier2013-bq" class="nav-link" data-scroll-target="#carlier2013-bq"><span class="header-section-number">5.2</span> <span class="citation" data-cites="Carlier2013-bq">Carlier et al. (2013)</span></a>
  <ul class="collapse">
  <li><a href="#covariate-distribution" id="toc-covariate-distribution" class="nav-link" data-scroll-target="#covariate-distribution"><span class="header-section-number">5.2.1</span> Covariate distribution</a></li>
  <li><a href="#simulation-of-covariates" id="toc-simulation-of-covariates" class="nav-link" data-scroll-target="#simulation-of-covariates"><span class="header-section-number">5.2.2</span> Simulation of covariates</a></li>
  </ul></li>
  <li><a href="#fournier2018" id="toc-fournier2018" class="nav-link" data-scroll-target="#fournier2018"><span class="header-section-number">5.3</span> <span class="citation" data-cites="fournier2018">Fournier et al. (2018)</span></a></li>
  <li><a href="#general-considerations-about-the-paper" id="toc-general-considerations-about-the-paper" class="nav-link" data-scroll-target="#general-considerations-about-the-paper"><span class="header-section-number">5.4</span> General considerations about the paper</a>
  <ul class="collapse">
  <li><a href="#covariate-distribution-1" id="toc-covariate-distribution-1" class="nav-link" data-scroll-target="#covariate-distribution-1"><span class="header-section-number">5.4.1</span> Covariate distribution</a></li>
  <li><a href="#simulation-of-covariates-1" id="toc-simulation-of-covariates-1" class="nav-link" data-scroll-target="#simulation-of-covariates-1"><span class="header-section-number">5.4.2</span> Simulation of covariates</a></li>
  </ul></li>
  <li><a href="#mellon2020" id="toc-mellon2020" class="nav-link" data-scroll-target="#mellon2020"><span class="header-section-number">5.5</span> <span class="citation" data-cites="mellon2020">Mellon et al. (2020)</span></a>
  <ul class="collapse">
  <li><a href="#covariate-distribution-2" id="toc-covariate-distribution-2" class="nav-link" data-scroll-target="#covariate-distribution-2"><span class="header-section-number">5.5.1</span> Covariate distribution</a></li>
  <li><a href="#simulation-of-covariates-2" id="toc-simulation-of-covariates-2" class="nav-link" data-scroll-target="#simulation-of-covariates-2"><span class="header-section-number">5.5.2</span> Simulation of covariates</a></li>
  </ul></li>
  <li><a href="#rambaud2020" id="toc-rambaud2020" class="nav-link" data-scroll-target="#rambaud2020"><span class="header-section-number">5.6</span> <span class="citation" data-cites="rambaud2020">Rambaud et al. (2020)</span></a>
  <ul class="collapse">
  <li><a href="#covariate-distribution-3" id="toc-covariate-distribution-3" class="nav-link" data-scroll-target="#covariate-distribution-3"><span class="header-section-number">5.6.1</span> Covariate distribution</a></li>
  <li><a href="#simulation-of-covariates-3" id="toc-simulation-of-covariates-3" class="nav-link" data-scroll-target="#simulation-of-covariates-3"><span class="header-section-number">5.6.2</span> Simulation of covariates</a></li>
  </ul></li>
  <li><a href="#final-covariate-table" id="toc-final-covariate-table" class="nav-link" data-scroll-target="#final-covariate-table"><span class="header-section-number">5.7</span> Final covariate table</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Simulations/covariate_simulation.html">Simulations</a></li><li class="breadcrumb-item"><a href="../Simulations/covariate_simulation.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Covariate simulation</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Covariate simulation</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rriskDistributions) <span class="co"># to fit distributions</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(msm) <span class="co"># for truncated normal </span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt) <span class="co"># for complex tables</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># for colinarity</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>conflicted<span class="sc">::</span><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1991</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="objective" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="objective"><span class="header-section-number">5.1</span> Objective</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>n_patient <span class="ot">&lt;-</span> <span class="dv">625</span> <span class="co"># number of patients simulated per cohort</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>here<span class="sc">::</span><span class="fu">i_am</span>(<span class="st">"Simulations/covariate_simulation.qmd"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create folder to store published figures</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="fu">here</span>(<span class="st">"Figures"</span>))) {</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(<span class="fu">here</span>(<span class="st">"Figures"</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>cov_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"Simulations/cov_distrib_from_papers.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>From each identified paper, we want to simulate a cohort of patients. For each cohort we want to simulate 625 patients. We define a patient by a vector of covariate values. The covariates of interest are :</p>
<ul>
<li>WT : Body weight (kg)</li>
<li>CRCL : Creatinine clearance (mL/min)</li>
<li>ICU : Is the patient an ICU patient (=1) or not (=0)</li>
<li>BURN : Is the patient a burn patient (=1) or not (=0)</li>
<li>OBESE : Is the patient a obese - BMI &gt; 30 kg/m^2 (=1) or not (=0)</li>
<li>SEX : Male (=0) or female (=1)</li>
<li>HT : height (cm)</li>
<li>AGE : age (years)</li>
</ul>
<p>To simulate covariate values we use information on the distribution of the covariates taken from the included papers.</p>
<p>We included 4 papers :</p>
<ul>
<li><p><span class="citation" data-cites="Carlier2013-bq">Carlier et al. (<a href="references.html#ref-Carlier2013-bq" role="doc-biblioref">2013</a>)</span></p></li>
<li><p><span class="citation" data-cites="fournier2018">Fournier et al. (<a href="references.html#ref-fournier2018" role="doc-biblioref">2018</a>)</span></p></li>
<li><p><span class="citation" data-cites="mellon2020">Mellon et al. (<a href="references.html#ref-mellon2020" role="doc-biblioref">2020</a>)</span></p></li>
<li><p><span class="citation" data-cites="rambaud2020">Rambaud et al. (<a href="references.html#ref-rambaud2020" role="doc-biblioref">2020</a>)</span></p></li>
</ul>
<p>One issue with the covariate data reported in these papers is that correlations between covariates are not reported and simulating without correlations runs the risk of simulating improbable covariate values. We thus obtained a clinical dataset composed of more than 16000 ICU patients (<span class="citation" data-cites="Johnson2023-zo">Johnson et al. (<a href="references.html#ref-Johnson2023-zo" role="doc-biblioref">2023</a>)</span>) from which we could derive correlations between covariates of interest. Age, serum creatinine, body weight, sex, height and BMI were obtained for these patients and the creatinine clearance was calculated (in mL/min for Cockroft and Gault and CKD-EPI and in mL/min/1.73 m2 for MDRD (to correspond to Mellon)). A correlation matrix was calculated for each of the respective model development cohorts separately for females and males.</p>
<p>This correlation matrix is used to simulate correlations between the simulated WT, CRCL, AGE, and HT/BMI if necessary to convert CRCL to serum creatinine. (CRCL_MDRD_norm means CRCL in mL/min/1.73 m² used for Mellon and CRCL_MDRD in mL/min.). Different correlation matrices are used based on sex. This way two different mutltivariate distributions are simulated based on the two matrices with a number of patients that respects the original article proportions.</p>
<p>We can find correlations for the log-transforms of certain variables. For the covariates where a log-normal distribution fits better the log mean and standard deviation of this distribution will be used to sample log values with a multivariate normal distribution. At the end, the log variables will be retransformed to normal ones.</p>
</section>
<section id="carlier2013-bq" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="carlier2013-bq"><span class="header-section-number">5.2</span> <span class="citation" data-cites="Carlier2013-bq">Carlier et al. (<a href="references.html#ref-Carlier2013-bq" role="doc-biblioref">2013</a>)</span></h2>
<section id="covariate-distribution" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="covariate-distribution"><span class="header-section-number">5.2.1</span> Covariate distribution</h3>
<p>All patients are ICU patients and we will assume that they are not burn and not obese patients. Creatinine clearance was obtained using the measured urinary equation. Thus for all patients ICU = 1, BURN = 0.</p>
<p>As discussed in the article, renal replacement therapy is an exclusion criterion, therefore the minimum value of creatinine clearance is set to 10 mL/min, any simulated value below 10 mL/min will be resampled. CRCL was calculated using the measured urinary equation.</p>
<p>For WT and CRCL here are the data from the paper :</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>cov_data_carlier <span class="ot">&lt;-</span> cov_data <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Paper <span class="sc">==</span> <span class="st">"Carlier_2013"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>cov_data_carlier <span class="sc">|&gt;</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Covariate <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"WT"</span>,<span class="st">"CRCL"</span>,<span class="st">"AGE"</span>,<span class="st">"BMI"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Paper</th>
<th style="text-align: left;">Covariate</th>
<th style="text-align: left;">Unit</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Carlier_2013</td>
<td style="text-align: left;">WT</td>
<td style="text-align: left;">kg</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carlier_2013</td>
<td style="text-align: left;">CRCL</td>
<td style="text-align: left;">mL/min</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Carlier_2013</td>
<td style="text-align: left;">BMI</td>
<td style="text-align: left;">kg/m^{2}</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Carlier_2013</td>
<td style="text-align: left;">AGE</td>
<td style="text-align: left;">year</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>cor_matrix_Carlier_F <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Simulations/cor_matrix_Carlier_F.rds"</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_matrix_Carlier_F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    CREAT   CREAT_log         AGE          WT      WT_log
CREAT          1.00000000  0.93719806  0.17043554  0.07114115  0.07024583
CREAT_log      0.93719806  1.00000000  0.22904749  0.09016458  0.09019928
AGE            0.17043554  0.22904749  1.00000000 -0.11058359 -0.10874794
WT             0.07114115  0.09016458 -0.11058359  1.00000000  0.99663272
WT_log         0.07024583  0.09019928 -0.10874794  0.99663272  1.00000000
HT            -0.02615290 -0.03452481 -0.22145176  0.36158540  0.35423946
HT_log        -0.02656759 -0.03481661 -0.22200991  0.36341580  0.35641748
BMI            0.09120381  0.11653457  0.01416104  0.83213862  0.83590568
BMI_log        0.08905860  0.11477057  0.01748252  0.82644900  0.83409794
CRCL_MDRD     -0.73311938 -0.90200963 -0.35625197  0.05193539  0.05083450
CRCL_MDRD_log -0.91894029 -0.98323371 -0.33894619  0.05521443  0.05501799
                       HT      HT_log         BMI     BMI_log   CRCL_MDRD
CREAT         -0.02615290 -0.02656759  0.09120381  0.08905860 -0.73311938
CREAT_log     -0.03452481 -0.03481661  0.11653457  0.11477057 -0.90200963
AGE           -0.22145176 -0.22200991  0.01416104  0.01748252 -0.35625197
WT             0.36158540  0.36341580  0.83213862  0.82644900  0.05193539
WT_log         0.35423946  0.35641748  0.83590568  0.83409794  0.05083450
HT             1.00000000  0.99908709 -0.21054270 -0.21983890  0.15405745
HT_log         0.99908709  1.00000000 -0.20907388 -0.21810288  0.15428482
BMI           -0.21054270 -0.20907388  1.00000000  0.99655760 -0.03784624
BMI_log       -0.21983890 -0.21810288  0.99655760  1.00000000 -0.03799028
CRCL_MDRD      0.15405745  0.15428482 -0.03784624 -0.03799028  1.00000000
CRCL_MDRD_log  0.14873339  0.14934183 -0.03146339 -0.03070224  0.92275219
              CRCL_MDRD_log
CREAT           -0.91894029
CREAT_log       -0.98323371
AGE             -0.33894619
WT               0.05521443
WT_log           0.05501799
HT               0.14873339
HT_log           0.14934183
BMI             -0.03146339
BMI_log         -0.03070224
CRCL_MDRD        0.92275219
CRCL_MDRD_log    1.00000000</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Carlier_F, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Sex: female"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/carlier-cor-matrix-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="covariate_simulation_files/figure-html/carlier-cor-matrix-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cor_matrix_Carlier_M <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Simulations/cor_matrix_Carlier_M.rds"</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_matrix_Carlier_M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    CREAT   CREAT_log          AGE          WT      WT_log
CREAT          1.00000000  0.93656904  0.129584751  0.03477888  0.03489511
CREAT_log      0.93656904  1.00000000  0.191015858  0.06256888  0.06255796
AGE            0.12958475  0.19101586  1.000000000 -0.05978080 -0.05792048
WT             0.03477888  0.06256888 -0.059780801  1.00000000  0.99691085
WT_log         0.03489511  0.06255796 -0.057920475  0.99691085  1.00000000
HT            -0.01562634 -0.02015099 -0.099371429  0.33471772  0.33277207
HT_log        -0.01514335 -0.01943840 -0.098654543  0.33778296  0.33606644
BMI            0.04448518  0.07478234  0.002442579  0.78722872  0.78753911
BMI_log        0.04503665  0.07581809  0.004260007  0.79489820  0.79912510
CRCL_MDRD     -0.73662552 -0.90639303 -0.327115476  0.04508957  0.04511819
CRCL_MDRD_log -0.92158994 -0.98613183 -0.287263519  0.06492902  0.06504475
                       HT      HT_log          BMI      BMI_log   CRCL_MDRD
CREAT         -0.01562634 -0.01514335  0.044485175  0.045036646 -0.73662552
CREAT_log     -0.02015099 -0.01943840  0.074782343  0.075818092 -0.90639303
AGE           -0.09937143 -0.09865454  0.002442579  0.004260007 -0.32711548
WT             0.33471772  0.33778296  0.787228725  0.794898201  0.04508957
WT_log         0.33277207  0.33606644  0.787539107  0.799125098  0.04511819
HT             1.00000000  0.99918214 -0.312182156 -0.300458114  0.12810278
HT_log         0.99918214  1.00000000 -0.309805459 -0.297640862  0.12729396
BMI           -0.31218216 -0.30980546  1.000000000  0.996020588 -0.03549251
BMI_log       -0.30045811 -0.29764086  0.996020588  1.000000000 -0.03551703
CRCL_MDRD      0.12810278  0.12729396 -0.035492514 -0.035517032  1.00000000
CRCL_MDRD_log  0.11829734  0.11791657 -0.010057809 -0.009333342  0.92462410
              CRCL_MDRD_log
CREAT          -0.921589942
CREAT_log      -0.986131825
AGE            -0.287263519
WT              0.064929019
WT_log          0.065044752
HT              0.118297341
HT_log          0.117916569
BMI            -0.010057809
BMI_log        -0.009333342
CRCL_MDRD       0.924624105
CRCL_MDRD_log   1.000000000</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Carlier_M, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Sex: male"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/carlier-cor-matrix-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="covariate_simulation_files/figure-html/carlier-cor-matrix-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>We are going to fit normal and log-normal distributions to the observed quantiles and select the best fitting one</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>compute_cv_from_sd_lnorm <span class="ot">&lt;-</span> <span class="cf">function</span>(sdlog){</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' Compute the geometric coefficient of variation from the standard deviation of a lognormal distribution</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param sdlog numeric. standard deviation of the log transformed variable</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @return numeric. geometric coefficient of variation</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">exp</span>(sdlog<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>extract_cov_param <span class="ot">&lt;-</span> <span class="cf">function</span>(cov_data, cov_name) {</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' Get covariate quantiles from covariate characteristics table</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param cov_data tibble containing the covariate information</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param cov_name character. name of the covariate to select, comes from the Covariate column of cov_data.</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @return list with :</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'  - p : numeric vector of probabilities</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'  - q : numeric vector of quantiles</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'  - cov_name : character string containing the covariate name</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'  - cov_unit : character string containing the unit of the covariate</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  cov_filtered_df <span class="ot">&lt;-</span> cov_data <span class="sc">|&gt;</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Covariate <span class="sc">==</span> cov_name) <span class="sc">|&gt;</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">c</span>(Median, Q1, Q3, Min, Max), <span class="co"># if the format of the csv columns ever changes, this will need to change</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">"p"</span>,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">"q"</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">case_match</span>(p, <span class="st">"Median"</span> <span class="sc">~</span> <span class="fl">0.5</span>, <span class="st">"Q1"</span> <span class="sc">~</span> <span class="fl">0.25</span>, <span class="st">"Q3"</span> <span class="sc">~</span> <span class="fl">0.75</span>, <span class="st">"Min"</span> <span class="sc">~</span> <span class="fl">0.01</span>, <span class="st">"Max"</span> <span class="sc">~</span> <span class="fl">0.99</span>)) <span class="sc">|&gt;</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if the format of the csv columns ever changes, the code above will need to change</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(q)) <span class="sc">|&gt;</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Paper) <span class="sc">|&gt;</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(p, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> cov_filtered_df<span class="sc">$</span>p,</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">q =</span> cov_filtered_df<span class="sc">$</span>q,</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">cov_name =</span> <span class="fu">unique</span>(cov_filtered_df<span class="sc">$</span>Covariate),</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">cov_unit =</span> <span class="fu">unique</span>(cov_filtered_df<span class="sc">$</span>Unit)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>evaluate_distrib <span class="ot">&lt;-</span> <span class="cf">function</span>(p, q, cov_name, cov_unit, min_plot, max_plot,<span class="at">tol =</span> <span class="fl">0.001</span>) {</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' Fit normal and lognormal distribution to observed quantiles</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param p numeric vector of probabilities</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param q numeric vector of quantiles</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param cov_name character string containing the covariate name</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param cov_unit character string containing the unit of the covariate</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param min_plot minimal value of the covariate for which the distribution should be plotted</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param max_plot maximal value of the covariate for which the distribution should be plotted</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param tol numeric. tolerance value for the fitting algorithm, default is 0.001</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @return list with :</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'  - plot : ggplot2 showing the fitted distributions and the observed covariate</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'  - lnorm_par : named numeric vector with the lognormal distribution parameters</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'  - norm_par : named numeric vector with the normal distribution parameters</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>  lnorm_par <span class="ot">&lt;-</span> <span class="fu">get.lnorm.par</span>(<span class="at">p =</span> p, <span class="at">q =</span> q, <span class="at">plot =</span> <span class="cn">FALSE</span>, <span class="at">show.output =</span> <span class="cn">FALSE</span>,<span class="at">tol =</span> tol)</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>  norm_par <span class="ot">&lt;-</span> <span class="fu">get.norm.par</span>(<span class="at">p =</span> p, <span class="at">q =</span> q, <span class="at">plot =</span> <span class="cn">FALSE</span>, <span class="at">show.output =</span> <span class="cn">FALSE</span>,<span class="at">tol=</span>tol)</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>  <span class="co">#create a dataset with the true percentiles to be able to show them on the plot</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>  true_percentiles <span class="ot">&lt;-</span> <span class="fu">tibble</span>(p, q) <span class="sc">|&gt;</span> </span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">case_match</span>(p, </span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">0</span> <span class="sc">~</span> <span class="st">"True min"</span>,</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.25</span> <span class="sc">~</span> <span class="st">"True Q1"</span>,</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"True median"</span>,</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.75</span> <span class="sc">~</span> <span class="st">"True Q3"</span>,</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">1</span> <span class="sc">~</span> <span class="st">"True max"</span>)) </span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>  <span class="co">#create a dataset with the percentiles of the fitted distributiosn to be able to show them on the plot</span></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>  distrib_percentiles <span class="ot">&lt;-</span>  <span class="fu">tibble</span>(</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">probability =</span> p,</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">lnorm =</span> <span class="fu">qlnorm</span>(probability, <span class="at">meanlog =</span> lnorm_par[<span class="st">"meanlog"</span>], <span class="at">sdlog =</span></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>                     lnorm_par[<span class="st">"sdlog"</span>]),</span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">norm =</span> <span class="fu">qnorm</span>(probability, <span class="at">mean =</span> norm_par[<span class="st">"mean"</span>], <span class="at">sd =</span> norm_par[<span class="st">"sd"</span>])</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(lnorm, norm), <span class="at">names_to =</span> <span class="st">"distrib"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">case_match</span>(</span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>      distrib,</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>      <span class="st">"norm"</span> <span class="sc">~</span> <span class="fu">dnorm</span>(value, <span class="at">mean =</span> norm_par[<span class="st">"mean"</span>], <span class="at">sd =</span></span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>                       norm_par[<span class="st">"sd"</span>]),</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>      <span class="st">"lnorm"</span> <span class="sc">~</span> <span class="fu">dlnorm</span>(value, <span class="at">meanlog =</span> lnorm_par[<span class="st">"meanlog"</span>], <span class="at">sdlog =</span></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>                         lnorm_par[<span class="st">"sdlog"</span>])</span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">|&gt;</span> </span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">case_match</span>(probability, </span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Min"</span>,</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.25</span> <span class="sc">~</span> <span class="st">"Q1"</span>,</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Median"</span>,</span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.75</span> <span class="sc">~</span> <span class="st">"Q3"</span>,</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Max"</span>)) </span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>  <span class="co">#simulate 1000 datapoints from the fitted distributions to show on the plot</span></span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>  param_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> <span class="fu">seq</span>(min_plot, max_plot, <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">lnorm =</span> <span class="fu">dlnorm</span>(variable, <span class="at">meanlog =</span> lnorm_par[<span class="st">"meanlog"</span>], <span class="at">sdlog =</span> lnorm_par[<span class="st">"sdlog"</span>]),</span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">norm =</span> <span class="fu">dnorm</span>(variable, <span class="at">mean =</span> norm_par[<span class="st">"mean"</span>], <span class="at">sd =</span> norm_par[<span class="st">"sd"</span>])</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(lnorm, norm), <span class="at">names_to =</span> <span class="st">"distrib"</span>)</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(param_data, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">color =</span> distrib)) <span class="sc">+</span></span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">data =</span> true_percentiles, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> q),<span class="at">lty =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="at">data =</span> distrib_percentiles, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span></span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>                                                   density)) <span class="sc">+</span></span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_brewer</span>(<span class="st">"Distribution"</span>, <span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">paste0</span>(cov_name, <span class="st">" ("</span>, cov_unit, <span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">geom =</span> <span class="st">"text"</span>,</span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="fu">paste0</span>(</span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a>        <span class="st">"N ~ ("</span>,</span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>        <span class="fu">signif</span>(norm_par[<span class="st">"mean"</span>], <span class="dv">3</span>),</span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a>        <span class="st">", "</span>,</span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a>        <span class="fu">signif</span>(norm_par[<span class="st">"sd"</span>], <span class="dv">3</span>),</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a>        <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a>        <span class="st">"LN ~ ("</span>,</span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a>        <span class="fu">signif</span>(<span class="fu">exp</span>(lnorm_par[<span class="st">"meanlog"</span>]), <span class="dv">3</span>),</span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a>        <span class="st">", "</span>,</span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a>        <span class="fu">signif</span>(<span class="fu">compute_cv_from_sd_lnorm</span>(lnorm_par[<span class="st">"sdlog"</span>]), <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a>        <span class="st">" %)"</span></span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">min</span>(param_data<span class="sc">$</span>variable) <span class="sc">+</span> <span class="fl">0.99</span> <span class="sc">*</span> <span class="fu">diff</span>(<span class="fu">range</span>(param_data<span class="sc">$</span>variable)),</span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">min</span>(param_data<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.99</span> <span class="sc">*</span> <span class="fu">diff</span>(<span class="fu">range</span>(param_data<span class="sc">$</span>value)),</span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a>      <span class="at">vjust =</span> <span class="dv">1</span></span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(</span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> true_percentiles,</span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> q,<span class="at">label =</span> label,<span class="at">color=</span><span class="cn">NULL</span>),</span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a>      <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">min</span>(param_data<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.95</span> <span class="sc">*</span> <span class="fu">diff</span>(<span class="fu">range</span>(param_data<span class="sc">$</span>value)),</span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a>      <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a>      <span class="at">angle =</span> <span class="dv">90</span></span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(</span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> distrib_percentiles,</span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y=</span>density,<span class="at">label =</span> label),</span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>      <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a>      <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a>      <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a>      <span class="at">angle =</span> <span class="dv">90</span></span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">plot =</span> plot,</span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a>       <span class="at">lnorm_par =</span> lnorm_par,</span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a>       <span class="at">norm_par =</span> norm_par)</span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a>fit_cov_wrapper <span class="ot">&lt;-</span> <span class="cf">function</span>(cov_data, cov_name, min_plot, max_plot, <span class="at">tol =</span> <span class="fl">0.001</span>) {</span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' Wrapper to get covariate quantiles from covariate characteristics table and fit normal and lognormal distribution</span></span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' to observed quantiles </span></span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'</span></span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param cov_data tibble containing the covariate information</span></span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param cov_name character. name of the covariate to select, comes from the Covariate column of cov_data.</span></span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param min_plot minimal value of the covariate for which the distribution should be plotted</span></span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param max_plot maximal value of the covariate for which the distribution should be plotted</span></span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param tol numeric. tolerance value for the fitting algorithm, default is 0.001</span></span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @return list with :</span></span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'  - plot : ggplot2 showing the fitted distributions and the observed covariate</span></span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'  - lnorm_par : named numeric vector with the lognormal distribution parameters</span></span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'  - norm_par : named numeric vector with the normal distribution parameters</span></span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a>  cov_df <span class="ot">&lt;-</span> <span class="fu">extract_cov_param</span>(cov_data, cov_name)</span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">evaluate_distrib</span>(</span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> cov_df<span class="sc">$</span>p,</span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">q =</span> cov_df<span class="sc">$</span>q,</span>
<span id="cb12-179"><a href="#cb12-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_plot =</span> min_plot,</span>
<span id="cb12-180"><a href="#cb12-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_plot =</span> max_plot,</span>
<span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">cov_name =</span> cov_df<span class="sc">$</span>cov_name,</span>
<span id="cb12-182"><a href="#cb12-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">cov_unit =</span> cov_df<span class="sc">$</span>cov_unit,</span>
<span id="cb12-183"><a href="#cb12-183" aria-hidden="true" tabindex="-1"></a>    <span class="at">tol =</span> tol</span>
<span id="cb12-184"><a href="#cb12-184" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-185"><a href="#cb12-185" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-186"><a href="#cb12-186" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>carlier_crcl <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_carlier,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"CRCL"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">0</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">250</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>carlier_crcl<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-carlier-crcl-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="covariate_simulation_files/figure-html/fit-carlier-crcl-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Normal distribution seems better than log-normal.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>carlier_wt <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_carlier,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"WT"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">40</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">120</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>carlier_wt<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-carlier-wt-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="covariate_simulation_files/figure-html/fit-carlier-wt-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>No discernable difference in fit. We have to use the log-normal distribution to be able to calculate height.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>carlier_age <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_carlier,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"AGE"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">0</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">120</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>carlier_age<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-carlier-age-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="covariate_simulation_files/figure-html/fit-carlier-age-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>No discernible difference in fit. We will use the normal distribution as generally, age is normally distributed.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>carlier_bmi <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_carlier,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"BMI"</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">0</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">40</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tol=</span><span class="fl">0.002</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>carlier_bmi<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-carlier-bmi-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="covariate_simulation_files/figure-html/fit-carlier-bmi-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Tolerance was increased to 0.002. No discernible difference in fit. We have to use the log-normal distribution to be able to obtain height.</p>
</section>
<section id="simulation-of-covariates" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="simulation-of-covariates"><span class="header-section-number">5.2.2</span> Simulation of covariates</h3>
<p>Covariates will be sampled from the following distributions :</p>
<ul>
<li>CRCL : Normal distribution with a minimum of 10 mL/min, with mean 105 mL/min and standard deviation 68.5 mL/min</li>
<li>WT : Lognormal distribution with mean 74.6 kg, and coefficient of variation 9.04 %</li>
<li>AGE : Normal distribution with mean 63.7 mL/min and standard deviation 11 years and with a minimum of 18 years</li>
<li>BMI : Log-normal distribution with mean 3.15 mL/min and standard deviation 0.141 kg/m^{2}</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>sim_norm_without_negatives <span class="ot">&lt;-</span> <span class="cf">function</span>(n,mean,sd){</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' Simulate values from normal distribution but resample negative values</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param n numeric. number of samples to simulate</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param mean numeric. mean of the normal distribution</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param sd numeric. standard deviation of the normal distribtuion</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @return numeric vector of n values</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  sim_values <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,mean,sd)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  neg_values <span class="ot">&lt;-</span> sim_values[sim_values<span class="sc">&lt;=</span><span class="dv">0</span>]</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  pos_values <span class="ot">&lt;-</span> sim_values[sim_values<span class="sc">&gt;</span><span class="dv">0</span>]</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">length</span>(neg_values)<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    new_values <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(neg_values),mean,sd)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    sim_values <span class="ot">&lt;-</span> <span class="fu">c</span>(pos_values,new_values)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    neg_values <span class="ot">&lt;-</span> sim_values[sim_values<span class="sc">&lt;=</span><span class="dv">0</span>]</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    pos_values <span class="ot">&lt;-</span> sim_values[sim_values<span class="sc">&gt;</span><span class="dv">0</span>]</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  sim_values</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Only for normal distribution when the minimum is 10 ml/min, resample below 10</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>sim_norm_without_dialysis <span class="ot">&lt;-</span> <span class="cf">function</span>(n,mean,sd){</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' Simulate values from normal distribution but resample negative values</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param n numeric. number of samples to simulate</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param mean numeric. mean of the normal distribution</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param sd numeric. standard deviation of the normal distribtuion</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @return numeric vector of n values</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  sim_values <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,mean,sd)</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  neg_values <span class="ot">&lt;-</span> sim_values[sim_values<span class="sc">&lt;=</span><span class="dv">10</span>]</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  pos_values <span class="ot">&lt;-</span> sim_values[sim_values<span class="sc">&gt;</span><span class="dv">10</span>]</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">length</span>(neg_values)<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    new_values <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(neg_values),mean,sd)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    sim_values <span class="ot">&lt;-</span> <span class="fu">c</span>(pos_values,new_values)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    neg_values <span class="ot">&lt;-</span> sim_values[sim_values<span class="sc">&lt;=</span><span class="dv">10</span>]</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    pos_values <span class="ot">&lt;-</span> sim_values[sim_values<span class="sc">&gt;</span><span class="dv">10</span>]</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  sim_values</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Resimulate subjects younger than 18 years for normally distributed age</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>sim_norm_without_minors <span class="ot">&lt;-</span> <span class="cf">function</span>(n,mean,sd){</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' Simulate values from normal distribution but resample negative values</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>  <span class="co">#'</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param n numeric. number of samples to simulate</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param mean numeric. mean of the normal distribution</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param sd numeric. standard deviation of the normal distribtuion</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @return numeric vector of n values</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>  sim_values <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,mean,sd)</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  neg_values <span class="ot">&lt;-</span> sim_values[sim_values<span class="sc">&lt;</span><span class="dv">18</span>]</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>  pos_values <span class="ot">&lt;-</span> sim_values[sim_values<span class="sc">&gt;=</span><span class="dv">18</span>]</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">length</span>(neg_values)<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>    new_values <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(neg_values),mean,sd)</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>    sim_values <span class="ot">&lt;-</span> <span class="fu">c</span>(pos_values,new_values)</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>    neg_values <span class="ot">&lt;-</span> sim_values[sim_values<span class="sc">&lt;</span><span class="dv">18</span>]</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>    pos_values <span class="ot">&lt;-</span> sim_values[sim_values<span class="sc">&gt;=</span><span class="dv">18</span>]</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>  sim_values</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The relevant part of the correlation matrix is converted to a covariance matrix by multiplying the already calculated standard deviations of the variables with the diagonal of the correlation matrix. More information can be found at <a href="https://blogs.sas.com/content/iml/2010/12/10/converting-between-correlation-and-covariance-matrices.html">SAS</a> and at <a href="https://stats.stackexchange.com/questions/62850/obtaining-covariance-matrix-from-correlation-matrix">stats</a>. A multivariate normal distribution is fitted with resimulation of CRCL below 10 ml/min, AGE below 18 years, and other variables below 0.</p>
<p>The proportion of males is 0.85 in the original article, so the number of males is 531 and the number of females is 94 to add up to 625.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mean_WT_log <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(carlier_wt<span class="sc">$</span>lnorm_par[<span class="st">"meanlog"</span>])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>sd_WT_log <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(carlier_wt<span class="sc">$</span>lnorm_par[<span class="st">"sdlog"</span>])</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>mean_BMI_log <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(carlier_bmi<span class="sc">$</span>lnorm_par[<span class="st">"meanlog"</span>])</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>sd_BMI_log <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(carlier_bmi<span class="sc">$</span>lnorm_par[<span class="st">"sdlog"</span>])</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>r_M <span class="ot">&lt;-</span> <span class="fl">0.34</span> <span class="co"># Pearson correlation between HT_log and WT_log for males</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>r_F <span class="ot">&lt;-</span> <span class="fl">0.36</span> <span class="co"># Pearson correlation for females</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># sd is different based on sex</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>mean_HT_log <span class="ot">=</span> (mean_WT_log <span class="sc">-</span> mean_BMI_log) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>sd_HT_M_log <span class="ot">=</span> (<span class="sc">-</span>r_M <span class="sc">*</span> sd_WT_log <span class="sc">+</span> <span class="fu">sqrt</span>(r_M<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> sd_WT_log<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> sd_WT_log<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sd_BMI_log<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span><span class="dv">2</span> <span class="co"># quadratic equation with positive result</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>sd_HT_F_log <span class="ot">=</span> (<span class="sc">-</span>r_F <span class="sc">*</span> sd_WT_log <span class="sc">+</span> <span class="fu">sqrt</span>(r_F<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> sd_WT_log<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> sd_WT_log<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sd_BMI_log<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span><span class="dv">2</span> <span class="co"># quadratic equation with positive</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>correlated_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(n, means, cov_matrix) {</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1991</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  collected <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">0</span>, <span class="fu">length</span>(means))</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(collected) <span class="ot">&lt;-</span> <span class="fu">names</span>(means)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">nrow</span>(collected) <span class="sc">&lt;</span> n) {</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    batch <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> n, <span class="at">mu =</span> means, <span class="at">Sigma =</span> cov_matrix)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(batch) <span class="ot">&lt;-</span> <span class="fu">names</span>(means)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    valid <span class="ot">&lt;-</span> batch[, <span class="st">"AGE"</span>] <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>             batch[, <span class="st">"CRCL_MDRD"</span>] <span class="sc">&gt;=</span> <span class="dv">10</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    batch_valid <span class="ot">&lt;-</span> batch[valid, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    collected <span class="ot">&lt;-</span> <span class="fu">rbind</span>(collected, batch_valid)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  collected[<span class="dv">1</span><span class="sc">:</span>n, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">CRCL_MDRD =</span> carlier_crcl<span class="sc">$</span>norm_par[<span class="st">"mean"</span>],</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">WT_log      =</span> carlier_wt<span class="sc">$</span>lnorm_par[<span class="st">"meanlog"</span>],</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE     =</span> carlier_age<span class="sc">$</span>norm_par[<span class="st">"mean"</span>],</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">HT_log     =</span> mean_HT_log</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>sds_M <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">CRCL_MDRD =</span> carlier_crcl<span class="sc">$</span>norm_par[<span class="st">"sd"</span>],</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">WT_log      =</span> carlier_wt<span class="sc">$</span>lnorm_par[<span class="st">"sdlog"</span>], </span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE     =</span> carlier_age<span class="sc">$</span>norm_par[<span class="st">"sd"</span>],</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">HT_log     =</span> sd_HT_M_log</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>sds_F <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">CRCL_MDRD =</span> carlier_crcl<span class="sc">$</span>norm_par[<span class="st">"sd"</span>],</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">WT_log      =</span> carlier_wt<span class="sc">$</span>lnorm_par[<span class="st">"sdlog"</span>], </span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE     =</span> carlier_age<span class="sc">$</span>norm_par[<span class="st">"sd"</span>],</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">HT_log     =</span> sd_HT_F_log</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>covariates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CRCL_MDRD"</span>, <span class="st">"WT_log"</span>, <span class="st">"AGE"</span>, <span class="st">"HT_log"</span>)</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(means) <span class="ot">&lt;-</span> covariates</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation and Covariance Matrix</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>cor_carlier_M <span class="ot">&lt;-</span> cor_matrix_Carlier_M[covariates, covariates]</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>cov_matrix_M <span class="ot">&lt;-</span> <span class="fu">diag</span>(sds_M) <span class="sc">%*%</span> cor_carlier_M <span class="sc">%*%</span> <span class="fu">diag</span>(sds_M)</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(cov_matrix_M)<span class="sc">$</span>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.705706e+03 1.077951e+02 8.326780e-03 1.446538e-03</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cor_carlier_F <span class="ot">&lt;-</span> cor_matrix_Carlier_F[covariates, covariates]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>cov_matrix_F <span class="ot">&lt;-</span> <span class="fu">diag</span>(sds_F) <span class="sc">%*%</span> cor_carlier_F <span class="sc">%*%</span> <span class="fu">diag</span>(sds_F)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(cov_matrix_F)<span class="sc">$</span>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.708164e+03 1.053367e+02 8.259148e-03 1.338558e-03</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>sim_data_M <span class="ot">&lt;-</span> <span class="fu">correlated_simulation</span>(<span class="at">n =</span> <span class="dv">531</span>, <span class="at">means =</span> means, <span class="at">cov_matrix =</span> cov_matrix_M)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>sim_data_M <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(sim_data_M) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SEX =</span> <span class="dv">0</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>sim_data_F <span class="ot">&lt;-</span> <span class="fu">correlated_simulation</span>(<span class="at">n =</span> <span class="dv">94</span>, <span class="at">means =</span> means, <span class="at">cov_matrix =</span> cov_matrix_F)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>sim_data_F <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(sim_data_F) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SEX =</span> <span class="dv">1</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sim_data_M, sim_data_F)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the covariates together</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>sim_cov_carlier <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Paper =</span> <span class="st">"Carlier_2013"</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID_within_paper =</span> <span class="dv">1</span><span class="sc">:</span>n_patient,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ICU =</span> <span class="dv">1</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">BURN =</span> <span class="dv">0</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">OBESE =</span> <span class="dv">0</span>,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">CRCL =</span> sim_data<span class="sc">$</span>CRCL_MDRD,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">WT_log   =</span> sim_data<span class="sc">$</span>WT_log,</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE  =</span> sim_data<span class="sc">$</span>AGE,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">HT_log  =</span> sim_data<span class="sc">$</span>HT_log,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">SEX =</span> sim_data<span class="sc">$</span>SEX</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Add OBESE variable and reconvert logWT to WT</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>sim_cov_carlier <span class="ot">&lt;-</span> sim_cov_carlier <span class="sc">%&gt;%</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WT =</span> <span class="fu">exp</span>(WT_log),</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">HT =</span> (<span class="fu">exp</span>(HT_log))<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">BMI =</span> WT <span class="sc">/</span> (HT<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">OBESE =</span> <span class="fu">ifelse</span>(BMI <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>summary_sim_cov_carlier <span class="ot">&lt;-</span> sim_cov_carlier <span class="sc">|&gt;</span> </span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(ICU,BURN,OBESE,CRCL,WT,AGE,BMI),</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Covariate"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">.by =</span> <span class="fu">c</span>(Covariate,Paper),</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">Min =</span> <span class="fu">min</span>(value),</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">Q1 =</span> <span class="fu">quantile</span>(value, <span class="fl">0.25</span>),</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">Median =</span> <span class="fu">quantile</span>(value, <span class="fl">0.5</span>),</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">Q3 =</span> <span class="fu">quantile</span>(value, <span class="fl">0.75</span>),</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>cov_carlier_compare <span class="ot">&lt;-</span> summary_sim_cov_carlier <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">paste0</span>(.x, <span class="st">"_sim"</span>), <span class="sc">-</span><span class="fu">one_of</span>(<span class="st">"Covariate"</span>, <span class="st">"Paper"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">rename_with</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    cov_data_carlier,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">paste0</span>(.x, <span class="st">"_true"</span>),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">one_of</span>(<span class="st">"Covariate"</span>, <span class="st">"Paper"</span>, <span class="st">"Unit"</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Covariate, <span class="at">.after =</span> Paper) <span class="sc">|&gt;</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Unit, <span class="at">.after =</span> Covariate)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>cov_carlier_compare <span class="sc">|&gt;</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_scientific</span>() <span class="sc">|&gt;</span> </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Min"</span>),</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Min"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Q1"</span>),</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Q1"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Median"</span>),</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Median"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Q3"</span>),</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Q3"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Max"</span>),</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Max"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="pocfpdfhxd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pocfpdfhxd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pocfpdfhxd thead, #pocfpdfhxd tbody, #pocfpdfhxd tfoot, #pocfpdfhxd tr, #pocfpdfhxd td, #pocfpdfhxd th {
  border-style: none;
}

#pocfpdfhxd p {
  margin: 0;
  padding: 0;
}

#pocfpdfhxd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pocfpdfhxd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pocfpdfhxd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pocfpdfhxd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pocfpdfhxd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pocfpdfhxd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pocfpdfhxd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pocfpdfhxd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pocfpdfhxd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pocfpdfhxd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pocfpdfhxd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pocfpdfhxd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pocfpdfhxd .gt_spanner_row {
  border-bottom-style: hidden;
}

#pocfpdfhxd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pocfpdfhxd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pocfpdfhxd .gt_from_md > :first-child {
  margin-top: 0;
}

#pocfpdfhxd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pocfpdfhxd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pocfpdfhxd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pocfpdfhxd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pocfpdfhxd .gt_row_group_first td {
  border-top-width: 2px;
}

#pocfpdfhxd .gt_row_group_first th {
  border-top-width: 2px;
}

#pocfpdfhxd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pocfpdfhxd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pocfpdfhxd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pocfpdfhxd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pocfpdfhxd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pocfpdfhxd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pocfpdfhxd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pocfpdfhxd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pocfpdfhxd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pocfpdfhxd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pocfpdfhxd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pocfpdfhxd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pocfpdfhxd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pocfpdfhxd .gt_left {
  text-align: left;
}

#pocfpdfhxd .gt_center {
  text-align: center;
}

#pocfpdfhxd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pocfpdfhxd .gt_font_normal {
  font-weight: normal;
}

#pocfpdfhxd .gt_font_bold {
  font-weight: bold;
}

#pocfpdfhxd .gt_font_italic {
  font-style: italic;
}

#pocfpdfhxd .gt_super {
  font-size: 65%;
}

#pocfpdfhxd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pocfpdfhxd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pocfpdfhxd .gt_indent_1 {
  text-indent: 5px;
}

#pocfpdfhxd .gt_indent_2 {
  text-indent: 10px;
}

#pocfpdfhxd .gt_indent_3 {
  text-indent: 15px;
}

#pocfpdfhxd .gt_indent_4 {
  text-indent: 20px;
}

#pocfpdfhxd .gt_indent_5 {
  text-indent: 25px;
}

#pocfpdfhxd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pocfpdfhxd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="Paper" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Paper</th>
<th rowspan="2" id="Covariate" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Covariate</th>
<th rowspan="2" id="Unit" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Unit</th>
<th colspan="2" id="Min" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Min
</div></th>
<th colspan="2" id="Q1" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Q1
</div></th>
<th colspan="2" id="Median" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Median
</div></th>
<th colspan="2" id="Q3" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Q3
</div></th>
<th colspan="2" id="Max" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Max
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="Min_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Min_sim</th>
<th id="Min_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Min_true</th>
<th id="Q1_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q1_sim</th>
<th id="Q1_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q1_true</th>
<th id="Median_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median_sim</th>
<th id="Median_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median_true</th>
<th id="Q3_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q3_sim</th>
<th id="Q3_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q3_true</th>
<th id="Max_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Max_sim</th>
<th id="Max_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Max_true</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Carlier_2013</td>
<td class="gt_row gt_left" headers="Covariate">ICU</td>
<td class="gt_row gt_left" headers="Unit">Unitless</td>
<td class="gt_row gt_right" headers="Min_sim">1.00</td>
<td class="gt_row gt_right" headers="Min_true">1.00</td>
<td class="gt_row gt_right" headers="Q1_sim">1.00</td>
<td class="gt_row gt_right" headers="Q1_true">1.00</td>
<td class="gt_row gt_right" headers="Median_sim">1.00</td>
<td class="gt_row gt_right" headers="Median_true">1.00</td>
<td class="gt_row gt_right" headers="Q3_sim">1.00</td>
<td class="gt_row gt_right" headers="Q3_true">1.00</td>
<td class="gt_row gt_right" headers="Max_sim">1.00</td>
<td class="gt_row gt_right" headers="Max_true">1.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Paper">Carlier_2013</td>
<td class="gt_row gt_left" headers="Covariate">BURN</td>
<td class="gt_row gt_left" headers="Unit">Unitless</td>
<td class="gt_row gt_right" headers="Min_sim">0.00</td>
<td class="gt_row gt_right" headers="Min_true">0.00</td>
<td class="gt_row gt_right" headers="Q1_sim">0.00</td>
<td class="gt_row gt_right" headers="Q1_true">0.00</td>
<td class="gt_row gt_right" headers="Median_sim">0.00</td>
<td class="gt_row gt_right" headers="Median_true">0.00</td>
<td class="gt_row gt_right" headers="Q3_sim">0.00</td>
<td class="gt_row gt_right" headers="Q3_true">0.00</td>
<td class="gt_row gt_right" headers="Max_sim">0.00</td>
<td class="gt_row gt_right" headers="Max_true">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Carlier_2013</td>
<td class="gt_row gt_left" headers="Covariate">OBESE</td>
<td class="gt_row gt_left" headers="Unit">Unitless</td>
<td class="gt_row gt_right" headers="Min_sim">0.00</td>
<td class="gt_row gt_right" headers="Min_true">0.00</td>
<td class="gt_row gt_right" headers="Q1_sim">0.00</td>
<td class="gt_row gt_right" headers="Q1_true">0.00</td>
<td class="gt_row gt_right" headers="Median_sim">0.00</td>
<td class="gt_row gt_right" headers="Median_true">0.00</td>
<td class="gt_row gt_right" headers="Q3_sim">0.00</td>
<td class="gt_row gt_right" headers="Q3_true">0.00</td>
<td class="gt_row gt_right" headers="Max_sim">1.00</td>
<td class="gt_row gt_right" headers="Max_true">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Paper">Carlier_2013</td>
<td class="gt_row gt_left" headers="Covariate">CRCL</td>
<td class="gt_row gt_left" headers="Unit">mL/min</td>
<td class="gt_row gt_right" headers="Min_sim">1.18&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">1.00&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_sim">6.68&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_true">5.00&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_sim">1.15&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Median_true">1.02&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">1.64&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Q3_true">1.57&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_sim">3.64&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_true">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Carlier_2013</td>
<td class="gt_row gt_left" headers="Covariate">WT</td>
<td class="gt_row gt_left" headers="Unit">kg</td>
<td class="gt_row gt_right" headers="Min_sim">5.89&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">NA</td>
<td class="gt_row gt_right" headers="Q1_sim">7.02&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_true">7.00&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_sim">7.47&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_true">7.50&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">7.98&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_true">7.90&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Max_sim">1.01&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_true">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Paper">Carlier_2013</td>
<td class="gt_row gt_left" headers="Covariate">AGE</td>
<td class="gt_row gt_left" headers="Unit">year</td>
<td class="gt_row gt_right" headers="Min_sim">2.84&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">NA</td>
<td class="gt_row gt_right" headers="Q1_sim">5.38&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_true">5.80&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_sim">6.30&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_true">6.20&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">7.00&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_true">7.20&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Max_sim">9.82&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Max_true">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Carlier_2013</td>
<td class="gt_row gt_left" headers="Covariate">BMI</td>
<td class="gt_row gt_left" headers="Unit">kg/m^{2}</td>
<td class="gt_row gt_right" headers="Min_sim">1.66&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">NA</td>
<td class="gt_row gt_right" headers="Q1_sim">2.19&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_true">2.10&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_sim">2.32&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_true">2.40&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">2.50&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_true">2.50&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Max_sim">3.14&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Max_true">NA</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>evaluate_cov_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(p, q, cov_name, cov_unit, cov_sim) {</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' Plot simulated covariate distribution versus observed quantiles from the paper</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param p numeric vector of probabilities</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param q numeric vector of quantiles</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param cov_name character string containing the covariate name</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param cov_unit character string containing the unit of the covariate</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @param cov_sim tibble containing the simulated values for the covariate</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#' @return ggplot2 showing the distributions of the simulated covariate and the observed covariate quantiles</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#create a dataset with the true percentiles to be able to show them on the plot</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  true_percentiles <span class="ot">&lt;-</span> <span class="fu">tibble</span>(p, q) <span class="sc">|&gt;</span> </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">case_match</span>(p, </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">0</span> <span class="sc">~</span> <span class="st">"True min"</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.25</span> <span class="sc">~</span> <span class="st">"True Q1"</span>,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"True median"</span>,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.75</span> <span class="sc">~</span> <span class="st">"True Q3"</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">1</span> <span class="sc">~</span> <span class="st">"True max"</span>)) </span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#create a dataset with the percentiles of the fitted distributions to be able to show them on the plot</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>   sim_percentiles <span class="ot">&lt;-</span>  <span class="fu">tibble</span>(</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">probability =</span> p,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">q =</span> <span class="fu">quantile</span>(<span class="fu">pull</span>(cov_sim,cov_name),p) </span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">case_match</span>(probability, </span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Sim min"</span>,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.25</span> <span class="sc">~</span> <span class="st">"Sim Q1"</span>,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Sim median"</span>,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>                              <span class="fl">0.75</span> <span class="sc">~</span> <span class="st">"Sim Q3"</span>,</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>                              <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Sim max"</span>))</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="co"># create an initial histogram in order to be able to extract statistics of the binned covariate</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>hist_ini <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cov_sim, <span class="fu">aes</span>(<span class="at">x =</span> .data[[cov_name]])) <span class="sc">+</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">15</span>)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>hist_data <span class="ot">&lt;-</span> <span class="fu">layer_data</span>(hist_ini)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(hist_data) <span class="sc">+</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin=</span>xmin,<span class="at">xmax=</span>xmax, <span class="at">ymin=</span><span class="dv">0</span>, <span class="at">ymax=</span>count),</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_vline</span>(<span class="at">data =</span> true_percentiles,</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> q,<span class="at">color =</span> <span class="st">"True"</span>),</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>                <span class="at">lty =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_vline</span>(<span class="at">data =</span> sim_percentiles,</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">xintercept =</span> q,<span class="at">color =</span> <span class="st">"Sim"</span>),</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>                <span class="at">lty =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ylab</span>(<span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlab</span>(<span class="fu">paste0</span>(cov_name, <span class="st">" ("</span>, cov_unit, <span class="st">")"</span>))  <span class="sc">+</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_text</span>(</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> true_percentiles,</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> q, <span class="at">label =</span> label, <span class="at">color =</span> <span class="st">"True"</span>),</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fl">0.95</span><span class="sc">*</span><span class="fu">max</span>(hist_data<span class="sc">$</span>ymax),</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>       <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">angle =</span> <span class="dv">90</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>     ) <span class="sc">+</span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_text</span>(</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> sim_percentiles,</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> q, <span class="at">label =</span> label, <span class="at">color =</span> <span class="st">"Sim"</span>),</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>       <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fl">0.95</span><span class="sc">*</span><span class="fu">max</span>(hist_data<span class="sc">$</span>ymax),</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>       <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>       <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>       <span class="at">angle =</span> <span class="dv">90</span></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>     ) <span class="sc">+</span></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_color_brewer</span>(<span class="at">name =</span> <span class="st">"Quantiles"</span>,</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>                        <span class="at">palette =</span><span class="st">"Dark2"</span>)</span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>   plot</span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>plot_sim_cov_wrapper <span class="ot">&lt;-</span> <span class="cf">function</span>(cov_data,cov_name,cov_sim){</span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>  cov_df <span class="ot">&lt;-</span> <span class="fu">extract_cov_param</span>(cov_data, cov_name)</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a><span class="fu">evaluate_cov_sim</span>(cov_df<span class="sc">$</span>p,cov_df<span class="sc">$</span>q,cov_df<span class="sc">$</span>cov_name,cov_df<span class="sc">$</span>cov_unit,</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>                 cov_sim)</span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_sim_cov_wrapper</span>(cov_data_carlier,<span class="st">"CRCL"</span>,sim_cov_carlier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/plot-cov-carlier-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="covariate_simulation_files/figure-html/plot-cov-carlier-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_sim_cov_wrapper</span>(cov_data_carlier,<span class="st">"WT"</span>,sim_cov_carlier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/plot-cov-carlier-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="covariate_simulation_files/figure-html/plot-cov-carlier-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_sim_cov_wrapper</span>(cov_data_carlier,<span class="st">"AGE"</span>,sim_cov_carlier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/plot-cov-carlier-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="covariate_simulation_files/figure-html/plot-cov-carlier-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_sim_cov_wrapper</span>(cov_data_carlier,<span class="st">"BMI"</span>,sim_cov_carlier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/plot-cov-carlier-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="covariate_simulation_files/figure-html/plot-cov-carlier-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Then, based on BMI and WT, height (HT) is calculated to be able to calculate the body surface area (BSA). CRCL was calculated using the measured urinary equation, and as we have know information about the urinary volume or urinary creatinine concentration, we cannot reconvert CRCL to CREAT based on this equation. The most recommended equation is CKD-EPI, however as different exponents are used based on the value of CREAT, it can’t be used for reconversion of CRCL to CREAT. Thus, the second best equation, MDRD is used.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>reconvert_MDRD <span class="ot">&lt;-</span> <span class="cf">function</span>(AGE, CRCL, SEX) {</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mutliply by 0.742 for females</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    sex_factor <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(SEX <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.742</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate DFG</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>   CREAT <span class="ot">&lt;-</span> (CRCL <span class="sc">/</span> (<span class="dv">175</span> <span class="sc">*</span> (AGE<span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.203</span>)) <span class="sc">*</span> sex_factor))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> <span class="fl">1.154</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(CREAT)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>sim_cov_carlier <span class="ot">&lt;-</span> sim_cov_carlier <span class="sc">%&gt;%</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">BSA =</span> (WT<span class="sc">^</span><span class="fl">0.425</span> <span class="sc">*</span> (HT<span class="sc">^</span><span class="fl">0.725</span>) <span class="sc">*</span> <span class="fl">0.007184</span>), <span class="co"># Calculate body surface area based on Dubois&amp;Dubois formula</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">CRCL =</span> CRCL <span class="sc">*</span> (<span class="fl">1.73</span> <span class="sc">/</span>BSA) <span class="co"># convert mL/min to mL/min/1.73 m2</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>sim_cov_carlier<span class="sc">$</span>CREAT <span class="ot">&lt;-</span> <span class="fu">mapply</span>(reconvert_MDRD, sim_cov_carlier<span class="sc">$</span>AGE, sim_cov_carlier<span class="sc">$</span>CRCL, sim_cov_carlier<span class="sc">$</span>SEX)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>sim_cov_carlier <span class="ot">&lt;-</span> sim_cov_carlier <span class="sc">%&gt;%</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Paper, ID_within_paper, ICU, BURN, OBESE, CREAT, WT, BSA, BMI, AGE, SEX, HT)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the simulated correlation matrices separately for the two sexes to compare with the original</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>sim_cov_carlier_M <span class="ot">&lt;-</span> sim_cov_carlier <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SEX <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>sim_cov_carlier_F <span class="ot">&lt;-</span> sim_cov_carlier <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SEX <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>cor_sim_M <span class="ot">&lt;-</span> <span class="fu">cor</span>(sim_cov_carlier_M <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(WT, CREAT, AGE, HT, BMI), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>cor_sim_F <span class="ot">&lt;-</span> <span class="fu">cor</span>(sim_cov_carlier_F <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(WT, CREAT, AGE, HT, BMI), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Carlier_F, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Carlier original (females)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_carlier-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="covariate_simulation_files/figure-html/reconvert_creat_carlier-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Carlier_F <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(cor_sim_F, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Carlier simulated (females)"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>Carlier_F </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_carlier-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="covariate_simulation_files/figure-html/reconvert_creat_carlier-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Carlier_M, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Carlier original (males)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_carlier-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="covariate_simulation_files/figure-html/reconvert_creat_carlier-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Carlier_M <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(cor_sim_M, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Carlier simulated (males)"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>Carlier_M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_carlier-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="covariate_simulation_files/figure-html/reconvert_creat_carlier-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="fournier2018" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="fournier2018"><span class="header-section-number">5.3</span> <span class="citation" data-cites="fournier2018">Fournier et al. (<a href="references.html#ref-fournier2018" role="doc-biblioref">2018</a>)</span></h2>
</section>
<section id="general-considerations-about-the-paper" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="general-considerations-about-the-paper"><span class="header-section-number">5.4</span> General considerations about the paper</h2>
<p>This study includes only 21 patients, thus deriving distributions from the reported covariates values might be difficult</p>
<section id="covariate-distribution-1" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="covariate-distribution-1"><span class="header-section-number">5.4.1</span> Covariate distribution</h3>
<p>All patients are ICU patients with burns who are assumed to be non obese. Creatinine clearance is calculated based on the Cockcroft &amp; Gault equation, whose output is in mL/min, so there is no need to calculate BSA. Thus for all patients ICU = 1, BURN = 1 and OBESE=0.</p>
<p>It is not mentioned in the article if certain patients are on renal replacement therapy, therefore we assume that they are not, and set the minimum value of creatinine clearance to 10 mL/min. CRCL was estimated using the Cockroft and Gault equation.</p>
<p>For AGE, not the median and IQR is given but the mean (50.1) and standard deviation (24.3). As we cannot compare the simulated distribution to the true one, so we suppose that the distribution follows a normal distribution.</p>
<p>The proportion of males in the original article is 0.762.</p>
<p>Neither BMI nor HT or BSA are provided in the article, thus the height is simulated based on the height obtained from the MIMIC clinical dataset (normal distribution with mean of 169 and sd of 10.3).</p>
<p>For WT, AGE and CRCL here are the data from the paper :</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>cov_data_fournier <span class="ot">&lt;-</span> cov_data <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Paper <span class="sc">==</span> <span class="st">"Fournier_2018"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>cov_data_fournier <span class="sc">|&gt;</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Covariate <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"WT"</span>,<span class="st">"CRCL"</span>,<span class="st">"AGE"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Paper</th>
<th style="text-align: left;">Covariate</th>
<th style="text-align: left;">Unit</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Fournier_2018</td>
<td style="text-align: left;">WT</td>
<td style="text-align: left;">kg</td>
<td style="text-align: right;">72.4</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">83.6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fournier_2018</td>
<td style="text-align: left;">CRCL</td>
<td style="text-align: left;">mL/min</td>
<td style="text-align: right;">128.0</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">150.0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fournier_2018</td>
<td style="text-align: left;">AGE</td>
<td style="text-align: left;">year</td>
<td style="text-align: right;">50.1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cor_matrix_Fournier_F <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Simulations/cor_matrix_Fournier_F.rds"</span>))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_matrix_Fournier_F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              CREAT         AGE         WT     WT_log          HT      HT_log
CREAT    1.00000000  0.11092068  0.1240980  0.1236777 -0.01115272 -0.01163038
AGE      0.11092068  1.00000000 -0.1411092 -0.1377268 -0.21810675 -0.21757157
WT       0.12409798 -0.14110923  1.0000000  0.9910295  0.26291857  0.26261857
WT_log   0.12367767 -0.13772678  0.9910295  1.0000000  0.27210890  0.27214801
HT      -0.01115272 -0.21810675  0.2629186  0.2721089  1.00000000  0.99936169
HT_log  -0.01163038 -0.21757157  0.2626186  0.2721480  0.99936169  1.00000000
BMI      0.13219801 -0.06085883  0.9199729  0.9108563 -0.12595561 -0.12641807
CRCL_CG -0.57789581 -0.60548019  0.3271195  0.3230419  0.20870474  0.20811864
                BMI    CRCL_CG
CREAT    0.13219801 -0.5778958
AGE     -0.06085883 -0.6054802
WT       0.91997291  0.3271195
WT_log   0.91085635  0.3230419
HT      -0.12595561  0.2087047
HT_log  -0.12641807  0.2081186
BMI      1.00000000  0.2518084
CRCL_CG  0.25180837  1.0000000</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Fournier_F, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Sex: female"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/Fournier-cor-matrix-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="covariate_simulation_files/figure-html/Fournier-cor-matrix-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>cor_matrix_Fournier_M <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Simulations/cor_matrix_Fournier_M.rds"</span>))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_matrix_Fournier_M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              CREAT         AGE          WT      WT_log          HT      HT_log
CREAT    1.00000000  0.08421679  0.07887415  0.07757763 -0.01796103 -0.01782471
AGE      0.08421679  1.00000000 -0.11683417 -0.11039865 -0.13268497 -0.13114182
WT       0.07887415 -0.11683417  1.00000000  0.99316445  0.36730646  0.36578272
WT_log   0.07757763 -0.11039865  0.99316445  1.00000000  0.36989373  0.36884368
HT      -0.01796103 -0.13268497  0.36730646  0.36989373  1.00000000  0.99929302
HT_log  -0.01782471 -0.13114182  0.36578272  0.36884368  0.99929302  1.00000000
BMI      0.09421423 -0.05819520  0.87199105  0.86717872 -0.12604976 -0.12807159
CRCL_CG -0.60813562 -0.55803721  0.29302773  0.28921272  0.18756329  0.18568377
                BMI    CRCL_CG
CREAT    0.09421423 -0.6081356
AGE     -0.05819520 -0.5580372
WT       0.87199105  0.2930277
WT_log   0.86717872  0.2892127
HT      -0.12604976  0.1875633
HT_log  -0.12807159  0.1856838
BMI      1.00000000  0.2145950
CRCL_CG  0.21459503  1.0000000</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Fournier_M, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Sex: male"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/Fournier-cor-matrix-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="covariate_simulation_files/figure-html/Fournier-cor-matrix-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fournier_crcl <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_fournier,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"CRCL"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">0</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">250</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tol=</span><span class="fl">0.002</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>fournier_crcl<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-fournier-crcl-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="covariate_simulation_files/figure-html/fit-fournier-crcl-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Tolerance was increased to 0.002 to have a fit for log-normal. Normal distribution is better suited.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>fournier_wt <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_fournier,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"WT"</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">40</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">120</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>fournier_wt<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-fournier-wt-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="covariate_simulation_files/figure-html/fit-fournier-wt-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>In this case the log-normal distribution quantiles are closer to the true quantiles than the normal ones. We will take the log-normal ones.</p>
</section>
<section id="simulation-of-covariates-1" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="simulation-of-covariates-1"><span class="header-section-number">5.4.2</span> Simulation of covariates</h3>
<p>Covariates will be sampled from the following distributions :</p>
<ul>
<li>CRCL : Normal distribution with mean 117.016 mL/min and standard deviation 63.3 mL/min</li>
<li>WT : Lognormal distribution with mean 73.8 kg, and coefficient of variation 17 %</li>
<li>AGE : Supposed normal distribution with mean of 50.1 years and standard deviation of 24.3</li>
</ul>
<p>The proportion of males is 0.762 in the original article, so the number of males is 476 and the number of females is 149 to add up to 625.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>correlated_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(n, means, cov_matrix) {</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1991</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  collected <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">0</span>, <span class="fu">length</span>(means))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(collected) <span class="ot">&lt;-</span> <span class="fu">names</span>(means)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">nrow</span>(collected) <span class="sc">&lt;</span> n) {</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    batch <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> n, <span class="at">mu =</span> means, <span class="at">Sigma =</span> cov_matrix)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(batch) <span class="ot">&lt;-</span> <span class="fu">names</span>(means)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    valid <span class="ot">&lt;-</span> batch[, <span class="st">"AGE"</span>] <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>             batch[, <span class="st">"CRCL_CG"</span>] <span class="sc">&gt;=</span> <span class="dv">10</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    batch_valid <span class="ot">&lt;-</span> batch[valid, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    collected <span class="ot">&lt;-</span> <span class="fu">rbind</span>(collected, batch_valid)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  collected[<span class="dv">1</span><span class="sc">:</span>n, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">CRCL_CG =</span> fournier_crcl<span class="sc">$</span>norm_par[<span class="st">"mean"</span>],</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">WT_log      =</span> fournier_wt<span class="sc">$</span>lnorm_par[<span class="st">"meanlog"</span>],</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE     =</span> <span class="fl">50.1</span>,</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">HT =</span> <span class="dv">169</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>sds <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">CRCL_CG =</span> fournier_crcl<span class="sc">$</span>norm_par[<span class="st">"sd"</span>],</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">WT_log      =</span> fournier_wt<span class="sc">$</span>lnorm_par[<span class="st">"sdlog"</span>],</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE     =</span> <span class="fl">24.3</span>,</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">HT =</span> <span class="fl">10.3</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>covariates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CRCL_CG"</span>, <span class="st">"WT_log"</span>, <span class="st">"AGE"</span>, <span class="st">"HT"</span>)</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(means) <span class="ot">&lt;-</span> covariates</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation and Covariance Matrix</span></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>cor_fournier_M <span class="ot">&lt;-</span> cor_matrix_Fournier_M[covariates, covariates]</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>cov_matrix_M <span class="ot">&lt;-</span> <span class="fu">diag</span>(sds) <span class="sc">%*%</span> cor_fournier_M <span class="sc">%*%</span> <span class="fu">diag</span>(sds)</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(cov_matrix_M)<span class="sc">$</span>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4218.3820076  387.0322287  102.1295861    0.0230053</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>cor_fournier_F <span class="ot">&lt;-</span> cor_matrix_Fournier_F[covariates, covariates]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>cov_matrix_F <span class="ot">&lt;-</span> <span class="fu">diag</span>(sds) <span class="sc">%*%</span> cor_fournier_F <span class="sc">%*%</span> <span class="fu">diag</span>(sds)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(cov_matrix_F)<span class="sc">$</span>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.253434e+03 3.545807e+02 9.952763e+01 2.398513e-02</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>sim_data_M <span class="ot">&lt;-</span> <span class="fu">correlated_simulation</span>(<span class="at">n =</span> <span class="dv">476</span>, <span class="at">means =</span> means, <span class="at">cov_matrix =</span> cov_matrix_M)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>sim_data_M <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(sim_data_M) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SEX =</span> <span class="dv">0</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>sim_data_F <span class="ot">&lt;-</span> <span class="fu">correlated_simulation</span>(<span class="at">n =</span> <span class="dv">149</span>, <span class="at">means =</span> means, <span class="at">cov_matrix =</span> cov_matrix_F)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>sim_data_F <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(sim_data_F) <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SEX =</span> <span class="dv">1</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sim_data_M, sim_data_F)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the covariates together</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>sim_cov_fournier <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Paper =</span> <span class="st">"Fournier_2018"</span>,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID_within_paper =</span> <span class="dv">1</span><span class="sc">:</span>n_patient,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ICU =</span> <span class="dv">1</span>,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">BURN =</span> <span class="dv">1</span>,</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">OBESE =</span> <span class="dv">0</span>,</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">CRCL =</span> sim_data<span class="sc">$</span>CRCL_CG,</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">WT_log   =</span> sim_data<span class="sc">$</span>WT_log,</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE  =</span> sim_data<span class="sc">$</span>AGE,</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">HT  =</span> sim_data<span class="sc">$</span>HT,</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">SEX =</span> sim_data<span class="sc">$</span>SEX)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>sim_cov_fournier <span class="ot">&lt;-</span> sim_cov_fournier <span class="sc">%&gt;%</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WT =</span> <span class="fu">exp</span>(WT_log))</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>summary_sim_cov_fournier <span class="ot">&lt;-</span> sim_cov_fournier <span class="sc">|&gt;</span> </span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(ICU,BURN,OBESE,CRCL,WT,AGE),</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Covariate"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">.by =</span> <span class="fu">c</span>(Covariate,Paper),</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">Min =</span> <span class="fu">min</span>(value),</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">Q1 =</span> <span class="fu">quantile</span>(value, <span class="fl">0.25</span>),</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">Median =</span> <span class="fu">quantile</span>(value, <span class="fl">0.5</span>),</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">Q3 =</span> <span class="fu">quantile</span>(value, <span class="fl">0.75</span>),</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(value))</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"The proportion of males is "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(sim_cov_fournier<span class="sc">$</span>SEX <span class="sc">==</span> <span class="dv">0</span>), <span class="dv">3</span>), <span class="st">" compared to the original 0.762."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The proportion of males is 0.762 compared to the original 0.762."</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>cov_fournier_compare <span class="ot">&lt;-</span> summary_sim_cov_fournier <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">paste0</span>(.x, <span class="st">"_sim"</span>), <span class="sc">-</span><span class="fu">one_of</span>(<span class="st">"Covariate"</span>, <span class="st">"Paper"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">rename_with</span>(</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    cov_data_fournier,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">paste0</span>(.x, <span class="st">"_true"</span>),</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">one_of</span>(<span class="st">"Covariate"</span>, <span class="st">"Paper"</span>, <span class="st">"Unit"</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Covariate, <span class="at">.after =</span> Paper) <span class="sc">|&gt;</span> </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Unit, <span class="at">.after =</span> Covariate)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>cov_fournier_compare <span class="sc">|&gt;</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_scientific</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Min"</span>),</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Min"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Q1"</span>),</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Q1"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Median"</span>),</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Median"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Q3"</span>),</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Q3"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Max"</span>),</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Max"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="jqjkfmtgfm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jqjkfmtgfm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jqjkfmtgfm thead, #jqjkfmtgfm tbody, #jqjkfmtgfm tfoot, #jqjkfmtgfm tr, #jqjkfmtgfm td, #jqjkfmtgfm th {
  border-style: none;
}

#jqjkfmtgfm p {
  margin: 0;
  padding: 0;
}

#jqjkfmtgfm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jqjkfmtgfm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jqjkfmtgfm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jqjkfmtgfm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jqjkfmtgfm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jqjkfmtgfm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqjkfmtgfm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jqjkfmtgfm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jqjkfmtgfm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jqjkfmtgfm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jqjkfmtgfm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jqjkfmtgfm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jqjkfmtgfm .gt_spanner_row {
  border-bottom-style: hidden;
}

#jqjkfmtgfm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jqjkfmtgfm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jqjkfmtgfm .gt_from_md > :first-child {
  margin-top: 0;
}

#jqjkfmtgfm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jqjkfmtgfm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jqjkfmtgfm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jqjkfmtgfm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jqjkfmtgfm .gt_row_group_first td {
  border-top-width: 2px;
}

#jqjkfmtgfm .gt_row_group_first th {
  border-top-width: 2px;
}

#jqjkfmtgfm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqjkfmtgfm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jqjkfmtgfm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jqjkfmtgfm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqjkfmtgfm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqjkfmtgfm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jqjkfmtgfm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jqjkfmtgfm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jqjkfmtgfm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqjkfmtgfm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jqjkfmtgfm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqjkfmtgfm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jqjkfmtgfm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqjkfmtgfm .gt_left {
  text-align: left;
}

#jqjkfmtgfm .gt_center {
  text-align: center;
}

#jqjkfmtgfm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jqjkfmtgfm .gt_font_normal {
  font-weight: normal;
}

#jqjkfmtgfm .gt_font_bold {
  font-weight: bold;
}

#jqjkfmtgfm .gt_font_italic {
  font-style: italic;
}

#jqjkfmtgfm .gt_super {
  font-size: 65%;
}

#jqjkfmtgfm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jqjkfmtgfm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jqjkfmtgfm .gt_indent_1 {
  text-indent: 5px;
}

#jqjkfmtgfm .gt_indent_2 {
  text-indent: 10px;
}

#jqjkfmtgfm .gt_indent_3 {
  text-indent: 15px;
}

#jqjkfmtgfm .gt_indent_4 {
  text-indent: 20px;
}

#jqjkfmtgfm .gt_indent_5 {
  text-indent: 25px;
}

#jqjkfmtgfm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jqjkfmtgfm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="Paper" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Paper</th>
<th rowspan="2" id="Covariate" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Covariate</th>
<th rowspan="2" id="Unit" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Unit</th>
<th colspan="2" id="Min" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Min
</div></th>
<th colspan="2" id="Q1" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Q1
</div></th>
<th colspan="2" id="Median" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Median
</div></th>
<th colspan="2" id="Q3" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Q3
</div></th>
<th colspan="2" id="Max" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Max
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="Min_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Min_sim</th>
<th id="Min_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Min_true</th>
<th id="Q1_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q1_sim</th>
<th id="Q1_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q1_true</th>
<th id="Median_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median_sim</th>
<th id="Median_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median_true</th>
<th id="Q3_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q3_sim</th>
<th id="Q3_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q3_true</th>
<th id="Max_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Max_sim</th>
<th id="Max_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Max_true</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Fournier_2018</td>
<td class="gt_row gt_left" headers="Covariate">ICU</td>
<td class="gt_row gt_left" headers="Unit">Unitless</td>
<td class="gt_row gt_right" headers="Min_sim">1.00</td>
<td class="gt_row gt_right" headers="Min_true">1.00</td>
<td class="gt_row gt_right" headers="Q1_sim">1.00</td>
<td class="gt_row gt_right" headers="Q1_true">1.00</td>
<td class="gt_row gt_right" headers="Median_sim">1.00</td>
<td class="gt_row gt_right" headers="Median_true">1.00</td>
<td class="gt_row gt_right" headers="Q3_sim">1.00</td>
<td class="gt_row gt_right" headers="Q3_true">1.00</td>
<td class="gt_row gt_right" headers="Max_sim">1.00</td>
<td class="gt_row gt_right" headers="Max_true">1.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Paper">Fournier_2018</td>
<td class="gt_row gt_left" headers="Covariate">BURN</td>
<td class="gt_row gt_left" headers="Unit">Unitless</td>
<td class="gt_row gt_right" headers="Min_sim">1.00</td>
<td class="gt_row gt_right" headers="Min_true">1.00</td>
<td class="gt_row gt_right" headers="Q1_sim">1.00</td>
<td class="gt_row gt_right" headers="Q1_true">1.00</td>
<td class="gt_row gt_right" headers="Median_sim">1.00</td>
<td class="gt_row gt_right" headers="Median_true">1.00</td>
<td class="gt_row gt_right" headers="Q3_sim">1.00</td>
<td class="gt_row gt_right" headers="Q3_true">1.00</td>
<td class="gt_row gt_right" headers="Max_sim">1.00</td>
<td class="gt_row gt_right" headers="Max_true">1.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Fournier_2018</td>
<td class="gt_row gt_left" headers="Covariate">OBESE</td>
<td class="gt_row gt_left" headers="Unit">Unitless</td>
<td class="gt_row gt_right" headers="Min_sim">0.00</td>
<td class="gt_row gt_right" headers="Min_true">0.00</td>
<td class="gt_row gt_right" headers="Q1_sim">0.00</td>
<td class="gt_row gt_right" headers="Q1_true">0.00</td>
<td class="gt_row gt_right" headers="Median_sim">0.00</td>
<td class="gt_row gt_right" headers="Median_true">0.00</td>
<td class="gt_row gt_right" headers="Q3_sim">0.00</td>
<td class="gt_row gt_right" headers="Q3_true">0.00</td>
<td class="gt_row gt_right" headers="Max_sim">0.00</td>
<td class="gt_row gt_right" headers="Max_true">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Paper">Fournier_2018</td>
<td class="gt_row gt_left" headers="Covariate">CRCL</td>
<td class="gt_row gt_left" headers="Unit">mL/min</td>
<td class="gt_row gt_right" headers="Min_sim">1.01&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">1.00&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_sim">7.32&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_true">6.50&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_sim">1.16&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Median_true">1.28&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">1.55&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Q3_true">1.50&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_sim">2.88&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_true">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Fournier_2018</td>
<td class="gt_row gt_left" headers="Covariate">WT</td>
<td class="gt_row gt_left" headers="Unit">kg</td>
<td class="gt_row gt_right" headers="Min_sim">4.53&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">NA</td>
<td class="gt_row gt_right" headers="Q1_sim">6.66&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_true">6.70&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_sim">7.45&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_true">7.24&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">8.40&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_true">8.36&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Max_sim">1.18&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_true">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Paper">Fournier_2018</td>
<td class="gt_row gt_left" headers="Covariate">AGE</td>
<td class="gt_row gt_left" headers="Unit">year</td>
<td class="gt_row gt_right" headers="Min_sim">1.80&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">NA</td>
<td class="gt_row gt_right" headers="Q1_sim">3.49&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_true">NA</td>
<td class="gt_row gt_right" headers="Median_sim">5.03&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_true">5.01&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">6.72&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_true">NA</td>
<td class="gt_row gt_right" headers="Max_sim">1.31&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_true">NA</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_sim_cov_wrapper</span>(cov_data_fournier,<span class="st">"CRCL"</span>,sim_cov_fournier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/plot-cov-fournier-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="covariate_simulation_files/figure-html/plot-cov-fournier-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_sim_cov_wrapper</span>(cov_data_fournier,<span class="st">"WT"</span>,sim_cov_fournier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/plot-cov-fournier-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="covariate_simulation_files/figure-html/plot-cov-fournier-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_sim_cov_wrapper</span>(cov_data_fournier,<span class="st">"AGE"</span>,sim_cov_fournier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/plot-cov-fournier-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="covariate_simulation_files/figure-html/plot-cov-fournier-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Then, based on the BMI and WT, the height (HT) is calculated to be able to calculate the body surface area (BSA). CRCL is reconverted to serum creatinine (CREAT) based on the Cockroft and Gault equation.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>reconvert_CG <span class="ot">&lt;-</span> <span class="cf">function</span>(AGE, CRCL, SEX, WT) {</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mutliply by 0.85 for females</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    sex_factor <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(SEX <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.85</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate DFG</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    CREAT <span class="ot">=</span> ((<span class="dv">140</span> <span class="sc">-</span> AGE) <span class="sc">*</span> WT <span class="sc">*</span> sex_factor) <span class="sc">/</span> (CRCL <span class="sc">*</span> <span class="dv">72</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(CREAT)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>sim_cov_fournier<span class="sc">$</span>CREAT <span class="ot">&lt;-</span> <span class="fu">mapply</span>(reconvert_CG, sim_cov_fournier<span class="sc">$</span>AGE, sim_cov_fournier<span class="sc">$</span>CRCL, sim_cov_fournier<span class="sc">$</span>SEX, sim_cov_fournier<span class="sc">$</span>WT)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>sim_cov_fournier <span class="ot">&lt;-</span> sim_cov_fournier <span class="sc">%&gt;%</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">BSA =</span> (WT<span class="sc">^</span><span class="fl">0.425</span> <span class="sc">*</span> (HT<span class="sc">^</span><span class="fl">0.725</span>) <span class="sc">*</span> <span class="fl">0.007184</span>),</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">BMI =</span> WT <span class="sc">/</span> (HT<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">OBESE =</span> <span class="fu">ifelse</span>(BMI <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Paper, ID_within_paper, ICU, BURN, OBESE, CREAT, WT, BSA, BMI, AGE, SEX, HT)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the simulated correlation matrices separately for the two sexes to compare with the original</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>sim_cov_fournier_M <span class="ot">&lt;-</span> sim_cov_fournier <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SEX <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>sim_cov_fournier_F <span class="ot">&lt;-</span> sim_cov_fournier <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SEX <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>cor_sim_M <span class="ot">&lt;-</span> <span class="fu">cor</span>(sim_cov_fournier_M <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(WT, CREAT, AGE, HT, BMI), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>cor_sim_F <span class="ot">&lt;-</span> <span class="fu">cor</span>(sim_cov_fournier_F <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(WT, CREAT, AGE, HT, BMI), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Fournier_F, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Fournier original (females)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_fournier-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="covariate_simulation_files/figure-html/reconvert_creat_fournier-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>Fournier_F <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(cor_sim_F, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Fournier simulated (females)"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>Fournier_F</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_fournier-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="covariate_simulation_files/figure-html/reconvert_creat_fournier-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Fournier_M, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Fournier original (males)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_fournier-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="covariate_simulation_files/figure-html/reconvert_creat_fournier-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>Fournier_M <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(cor_sim_M, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Fournier simulated (males)"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>Fournier_M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_fournier-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="covariate_simulation_files/figure-html/reconvert_creat_fournier-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="mellon2020" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="mellon2020"><span class="header-section-number">5.5</span> <span class="citation" data-cites="mellon2020">Mellon et al. (<a href="references.html#ref-mellon2020" role="doc-biblioref">2020</a>)</span></h2>
<section id="covariate-distribution-2" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="covariate-distribution-2"><span class="header-section-number">5.5.1</span> Covariate distribution</h3>
<p>Patients are obese, but otherwise healthy, meaning that they are not in intensive care and not burn victims. They are all obese (BMI &gt; 30 kg/m^2). Creatinine clearance is calculated based on the MDRD equation. Thus for all patients ICU = 0, BURN = 0, OBESE=1.</p>
<p>For WT, BMI and CRCL here are the data from the paper :</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>cov_data_mellon <span class="ot">&lt;-</span> cov_data <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Paper <span class="sc">==</span> <span class="st">"Mellon_2020"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>cov_data_mellon <span class="sc">|&gt;</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Covariate <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"WT"</span>,<span class="st">"CRCL"</span>, <span class="st">"AGE"</span>, <span class="st">"BMI"</span>, <span class="st">"BMI_log"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 26%">
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Paper</th>
<th style="text-align: left;">Covariate</th>
<th style="text-align: left;">Unit</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mellon_2020</td>
<td style="text-align: left;">WT</td>
<td style="text-align: left;">kg</td>
<td style="text-align: right;">109.3</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">88.00</td>
<td style="text-align: right;">151.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mellon_2020</td>
<td style="text-align: left;">CRCL</td>
<td style="text-align: left;">mL/min/1.73m^{2}</td>
<td style="text-align: right;">94.0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">62.00</td>
<td style="text-align: right;">133.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mellon_2020</td>
<td style="text-align: left;">BMI</td>
<td style="text-align: left;">kg/m^{2}</td>
<td style="text-align: right;">40.6</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">35.20</td>
<td style="text-align: right;">67.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mellon_2020</td>
<td style="text-align: left;">BMI_log</td>
<td style="text-align: left;">kg/m^{2}</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">3.56</td>
<td style="text-align: right;">4.21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mellon_2020</td>
<td style="text-align: left;">CRCL</td>
<td style="text-align: left;">ml/min</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mellon_2020</td>
<td style="text-align: left;">AGE</td>
<td style="text-align: left;">year</td>
<td style="text-align: right;">51.7</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">22.90</td>
<td style="text-align: right;">62.90</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>cor_matrix_Mellon_F <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Simulations/cor_matrix_Mellon_F.rds"</span>))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_matrix_Mellon_F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      CREAT          AGE          WT       WT_log          HT
CREAT           1.000000000  0.022643469  0.03125540  0.031968067  0.05795702
AGE             0.022643469  1.000000000 -0.07488881 -0.077065515 -0.11168121
WT              0.031255400 -0.074888809  1.00000000  0.997431167  0.43988528
WT_log          0.031968067 -0.077065515  0.99743117  1.000000000  0.45364368
HT              0.057957020 -0.111681207  0.43988528  0.453643683  1.00000000
HT_log          0.057716460 -0.110775924  0.43501172  0.448949779  0.99935506
BMI            -0.006435320 -0.004011043  0.76869713  0.758978914 -0.23142245
BMI_log        -0.006781559 -0.004085614  0.77244329  0.765197692 -0.22615779
CRCL_MDRD_norm -0.936664533 -0.319596180 -0.00640208 -0.006556334 -0.02317188
                    HT_log          BMI      BMI_log CRCL_MDRD_norm
CREAT           0.05771646 -0.006435320 -0.006781559   -0.936664533
AGE            -0.11077592 -0.004011043 -0.004085614   -0.319596180
WT              0.43501172  0.768697132  0.772443287   -0.006402080
WT_log          0.44894978  0.758978914  0.765197692   -0.006556334
HT              0.99935506 -0.231422452 -0.226157792   -0.023171879
HT_log          1.00000000 -0.237225021 -0.231732528   -0.023241184
BMI            -0.23722502  1.000000000  0.997187131    0.009471973
BMI_log        -0.23173253  0.997187131  1.000000000    0.009607333
CRCL_MDRD_norm -0.02324118  0.009471973  0.009607333    1.000000000</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Mellon_F, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Sex: female"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/Mellon-cor-matrix-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="covariate_simulation_files/figure-html/Mellon-cor-matrix-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>cor_matrix_Mellon_M <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Simulations/cor_matrix_Mellon_M.rds"</span>))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_matrix_Mellon_M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      CREAT          AGE           WT       WT_log           HT
CREAT           1.000000000 -0.079420098 -0.005155970 -0.002021643  0.062039693
AGE            -0.079420098  1.000000000 -0.020403922 -0.018224696 -0.002835067
WT             -0.005155970 -0.020403922  1.000000000  0.997694029  0.617330996
WT_log         -0.002021643 -0.018224696  0.997694029  1.000000000  0.634363996
HT              0.062039693 -0.002835067  0.617330996  0.634363996  1.000000000
HT_log          0.061429587 -0.001756480  0.613093576  0.631018266  0.999227265
BMI            -0.070072797 -0.019345942  0.535836189  0.518641232 -0.328796339
BMI_log        -0.069673338 -0.020297428  0.545596150  0.528796578 -0.319827206
CRCL_MDRD_norm -0.940158336 -0.215895006  0.007018922  0.003387753 -0.059982333
                    HT_log         BMI     BMI_log CRCL_MDRD_norm
CREAT           0.06142959 -0.07007280 -0.06967334   -0.940158336
AGE            -0.00175648 -0.01934594 -0.02029743   -0.215895006
WT              0.61309358  0.53583619  0.54559615    0.007018922
WT_log          0.63101827  0.51864123  0.52879658    0.003387753
HT              0.99922726 -0.32879634 -0.31982721   -0.059982333
HT_log          1.00000000 -0.33401211 -0.32475168   -0.059647213
BMI            -0.33401211  1.00000000  0.99775044    0.069173500
BMI_log        -0.32475168  0.99775044  1.00000000    0.069388818
CRCL_MDRD_norm -0.05964721  0.06917350  0.06938882    1.000000000</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Mellon_M, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Sex: male"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/Mellon-cor-matrix-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="covariate_simulation_files/figure-html/Mellon-cor-matrix-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Mellon is different from the other papers as CRCL is given as ml/min/1.73m^{2} based on the MDRD equation, and instead of Q1 and Q3, the minimum and maxiumum of the covariates is given (apart from BMI). Another particularity is that due to the particularity of the subjects (obesity), the distribution of body weight is positively (right) skewed. Positively skewed distribution is relatively rare, so it is not easy to find a distribution function to describe it. Beta distribution needs scaling the data between 0 and 1. and 4 parameter stable distribution et gamma distribution have several parameters that need to be defined, and in the absence of the original data, it is not possible to estimate these parameters.</p>
<p>The proportion of males is 0.148.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>mellon_crcl <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_mellon,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"CRCL"</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">0</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">250</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>mellon_crcl<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-mellon-crcl-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="covariate_simulation_files/figure-html/fit-mellon-crcl-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Similar fits; normal distribution is selected.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>mellon_wt <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_mellon,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"WT"</span>,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">40</span>,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">170</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>mellon_wt<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-mellon-wt-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="covariate_simulation_files/figure-html/fit-mellon-wt-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Log-normal distribution fits slightly better than normal.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>mellon_age <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_mellon,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"AGE"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">0</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">120</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>mellon_age<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-mellon-age-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="covariate_simulation_files/figure-html/fit-mellon-age-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Normal distribution fits a bit better.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>mellon_bmi <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_mellon,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"BMI"</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">0</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">100</span>, </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tol =</span> <span class="fl">0.001</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>mellon_bmi<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-mellon-bmi-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="covariate_simulation_files/figure-html/fit-mellon-bmi-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>mellon_bmi_log <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_mellon,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"BMI_log"</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="fl">2.5</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">5</span>, </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tol =</span> <span class="fl">0.001</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>mellon_bmi_log<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-mellon-bmi-log-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="covariate_simulation_files/figure-html/fit-mellon-bmi-log-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Log-normal distribution fits a bit better.</p>
</section>
<section id="simulation-of-covariates-2" class="level3" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="simulation-of-covariates-2"><span class="header-section-number">5.5.2</span> Simulation of covariates</h3>
<p>Covariates will be sampled from the following distributions :</p>
<ul>
<li>CRCL : Normal distribution from which negative values have been resampled, with mean 94 mL/min and standard deviation 14.3 mL/min</li>
<li>WT : Log-normal distribution with mean 109 kg, and coefficient of variation 9.41 %</li>
<li>AGE : Normal distribution with mean 2.84^{22} years, and standard deviation 4.81 %</li>
<li>BMI : Log-normal distribution with mean 40.6 <span class="math inline">\(kg/m^{2}\)</span>, and coefficient of variation 6.14 %</li>
</ul>
<p>The proportion of males is 0.148 in the original article, so the number of males is 93 and the number of females is 532 to add up to 625.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>correlated_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(n, means, cov_matrix) {</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1991</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  collected <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">0</span>, <span class="fu">length</span>(means))</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(collected) <span class="ot">&lt;-</span> <span class="fu">names</span>(means)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">nrow</span>(collected) <span class="sc">&lt;</span> n) {</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    batch <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> n, <span class="at">mu =</span> means, <span class="at">Sigma =</span> cov_matrix)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(batch) <span class="ot">&lt;-</span> <span class="fu">names</span>(means)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    valid <span class="ot">&lt;-</span> batch[, <span class="st">"AGE"</span>] <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>             batch[, <span class="st">"CRCL_MDRD_norm"</span>] <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>             batch[, <span class="st">"BMI_log"</span>] <span class="sc">&gt;</span> <span class="fl">3.401197</span> <span class="co"># log(30)</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    batch_valid <span class="ot">&lt;-</span> batch[valid, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    collected <span class="ot">&lt;-</span> <span class="fu">rbind</span>(collected, batch_valid)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  collected[<span class="dv">1</span><span class="sc">:</span>n, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">CRCL_MDRD_norm =</span> mellon_crcl<span class="sc">$</span>norm_par[<span class="st">"mean"</span>],</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">WT_log      =</span> mellon_wt<span class="sc">$</span>lnorm_par[<span class="st">"meanlog"</span>],</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE     =</span> mellon_age<span class="sc">$</span>norm_par[<span class="st">"mean"</span>],</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">BMI_log     =</span> mellon_bmi<span class="sc">$</span>lnorm_par[<span class="st">"meanlog"</span>]</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>sds <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">CRCL_MDRD_norm =</span> mellon_crcl<span class="sc">$</span>norm_par[<span class="st">"sd"</span>],</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">WT_log      =</span> mellon_wt<span class="sc">$</span>lnorm_par[<span class="st">"sdlog"</span>], </span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE =</span> mellon_age<span class="sc">$</span>norm_par[<span class="st">"sd"</span>],</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">BMI_log     =</span> mellon_bmi<span class="sc">$</span>lnorm_par[<span class="st">"sdlog"</span>]</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>covariates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CRCL_MDRD_norm"</span>, <span class="st">"WT_log"</span>, <span class="st">"AGE"</span>, <span class="st">"BMI_log"</span>)</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(means) <span class="ot">&lt;-</span> covariates</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation and Covariance Matrix</span></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>cor_mellon_M <span class="ot">&lt;-</span> cor_matrix_Mellon_M[covariates, covariates]</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>cov_matrix_M <span class="ot">&lt;-</span> <span class="fu">diag</span>(sds) <span class="sc">%*%</span> cor_mellon_M <span class="sc">%*%</span> <span class="fu">diag</span>(sds)</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(cov_matrix_M)<span class="sc">$</span>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.050769e+02 2.197051e+01 1.024041e-02 2.320348e-03</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>cor_mellon_F <span class="ot">&lt;-</span> cor_matrix_Mellon_F[covariates, covariates]</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>cov_matrix_F <span class="ot">&lt;-</span> <span class="fu">diag</span>(sds) <span class="sc">%*%</span> cor_mellon_F <span class="sc">%*%</span> <span class="fu">diag</span>(sds)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(cov_matrix_F)<span class="sc">$</span>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.064991e+02 2.054837e+01 1.132511e-02 1.194553e-03</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>sim_data_M <span class="ot">&lt;-</span> <span class="fu">correlated_simulation</span>(<span class="at">n =</span> <span class="dv">93</span>, <span class="at">means =</span> means, <span class="at">cov_matrix =</span> cov_matrix_M)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>sim_data_M <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(sim_data_M) <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SEX =</span> <span class="dv">0</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>sim_data_F <span class="ot">&lt;-</span> <span class="fu">correlated_simulation</span>(<span class="at">n =</span> <span class="dv">532</span>, <span class="at">means =</span> means, <span class="at">cov_matrix =</span> cov_matrix_F)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>sim_data_F <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(sim_data_F) <span class="sc">%&gt;%</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SEX =</span> <span class="dv">1</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sim_data_M, sim_data_F)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the covariates together</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>sim_cov_mellon <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Paper =</span> <span class="st">"Mellon_2020"</span>,</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID_within_paper =</span> <span class="dv">1</span><span class="sc">:</span>n_patient,</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ICU =</span> <span class="dv">0</span>,</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">BURN =</span> <span class="dv">0</span>,</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">OBESE =</span> <span class="dv">1</span>,</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">CRCL =</span> sim_data<span class="sc">$</span>CRCL_MDRD_norm,</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">WT_log   =</span> sim_data<span class="sc">$</span>WT_log,</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE  =</span> sim_data<span class="sc">$</span>AGE,</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">BMI_log  =</span> sim_data<span class="sc">$</span>BMI_log,</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">SEX =</span> sim_data<span class="sc">$</span>SEX)</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>sim_cov_mellon <span class="ot">&lt;-</span> sim_cov_mellon <span class="sc">%&gt;%</span></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WT =</span> <span class="fu">exp</span>(WT_log),</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">BMI =</span> <span class="fu">exp</span>(BMI_log))</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>summary_sim_cov_mellon <span class="ot">&lt;-</span> sim_cov_mellon <span class="sc">|&gt;</span> </span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(ICU,BURN,OBESE,CRCL,WT,AGE),</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Covariate"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">.by =</span> <span class="fu">c</span>(Covariate,Paper),</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">Min =</span> <span class="fu">min</span>(value),</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">Q1 =</span> <span class="fu">quantile</span>(value, <span class="fl">0.25</span>),</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">Median =</span> <span class="fu">quantile</span>(value, <span class="fl">0.5</span>),</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">Q3 =</span> <span class="fu">quantile</span>(value, <span class="fl">0.75</span>),</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>sim_cov_mellon <span class="ot">&lt;-</span> sim_cov_mellon <span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Paper, ID_within_paper, ICU, BURN, OBESE, CRCL, WT, AGE, BMI, SEX)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>cov_mellon_compare <span class="ot">&lt;-</span> summary_sim_cov_mellon <span class="sc">|&gt;</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">paste0</span>(.x, <span class="st">"_sim"</span>), <span class="sc">-</span><span class="fu">one_of</span>(<span class="st">"Covariate"</span>, <span class="st">"Paper"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">rename_with</span>(</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    cov_data_mellon,</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">paste0</span>(.x, <span class="st">"_true"</span>),</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">one_of</span>(<span class="st">"Covariate"</span>, <span class="st">"Paper"</span>, <span class="st">"Unit"</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Covariate, <span class="at">.after =</span> Paper) <span class="sc">|&gt;</span> </span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Unit, <span class="at">.after =</span> Covariate)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>cov_mellon_compare <span class="sc">|&gt;</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_scientific</span>() <span class="sc">|&gt;</span> </span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Min"</span>),</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Min"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Q1"</span>),</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Q1"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Median"</span>),</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Median"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Q3"</span>),</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Q3"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Max"</span>),</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Max"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="cmvclepqnh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cmvclepqnh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cmvclepqnh thead, #cmvclepqnh tbody, #cmvclepqnh tfoot, #cmvclepqnh tr, #cmvclepqnh td, #cmvclepqnh th {
  border-style: none;
}

#cmvclepqnh p {
  margin: 0;
  padding: 0;
}

#cmvclepqnh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cmvclepqnh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cmvclepqnh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cmvclepqnh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cmvclepqnh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cmvclepqnh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cmvclepqnh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cmvclepqnh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cmvclepqnh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cmvclepqnh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cmvclepqnh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cmvclepqnh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cmvclepqnh .gt_spanner_row {
  border-bottom-style: hidden;
}

#cmvclepqnh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cmvclepqnh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cmvclepqnh .gt_from_md > :first-child {
  margin-top: 0;
}

#cmvclepqnh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cmvclepqnh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cmvclepqnh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cmvclepqnh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cmvclepqnh .gt_row_group_first td {
  border-top-width: 2px;
}

#cmvclepqnh .gt_row_group_first th {
  border-top-width: 2px;
}

#cmvclepqnh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cmvclepqnh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cmvclepqnh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cmvclepqnh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cmvclepqnh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cmvclepqnh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cmvclepqnh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cmvclepqnh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cmvclepqnh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cmvclepqnh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cmvclepqnh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cmvclepqnh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cmvclepqnh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cmvclepqnh .gt_left {
  text-align: left;
}

#cmvclepqnh .gt_center {
  text-align: center;
}

#cmvclepqnh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cmvclepqnh .gt_font_normal {
  font-weight: normal;
}

#cmvclepqnh .gt_font_bold {
  font-weight: bold;
}

#cmvclepqnh .gt_font_italic {
  font-style: italic;
}

#cmvclepqnh .gt_super {
  font-size: 65%;
}

#cmvclepqnh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cmvclepqnh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cmvclepqnh .gt_indent_1 {
  text-indent: 5px;
}

#cmvclepqnh .gt_indent_2 {
  text-indent: 10px;
}

#cmvclepqnh .gt_indent_3 {
  text-indent: 15px;
}

#cmvclepqnh .gt_indent_4 {
  text-indent: 20px;
}

#cmvclepqnh .gt_indent_5 {
  text-indent: 25px;
}

#cmvclepqnh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cmvclepqnh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="Paper" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Paper</th>
<th rowspan="2" id="Covariate" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Covariate</th>
<th rowspan="2" id="Unit" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Unit</th>
<th colspan="2" id="Min" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Min
</div></th>
<th colspan="2" id="Q1" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Q1
</div></th>
<th colspan="2" id="Median" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Median
</div></th>
<th colspan="2" id="Q3" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Q3
</div></th>
<th colspan="2" id="Max" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Max
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="Min_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Min_sim</th>
<th id="Min_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Min_true</th>
<th id="Q1_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q1_sim</th>
<th id="Q1_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q1_true</th>
<th id="Median_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median_sim</th>
<th id="Median_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median_true</th>
<th id="Q3_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q3_sim</th>
<th id="Q3_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q3_true</th>
<th id="Max_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Max_sim</th>
<th id="Max_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Max_true</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Mellon_2020</td>
<td class="gt_row gt_left" headers="Covariate">ICU</td>
<td class="gt_row gt_left" headers="Unit">Unitless</td>
<td class="gt_row gt_right" headers="Min_sim">0.00</td>
<td class="gt_row gt_right" headers="Min_true">0.00</td>
<td class="gt_row gt_right" headers="Q1_sim">0.00</td>
<td class="gt_row gt_right" headers="Q1_true">0.00</td>
<td class="gt_row gt_right" headers="Median_sim">0.00</td>
<td class="gt_row gt_right" headers="Median_true">0.00</td>
<td class="gt_row gt_right" headers="Q3_sim">0.00</td>
<td class="gt_row gt_right" headers="Q3_true">0.00</td>
<td class="gt_row gt_right" headers="Max_sim">0.00</td>
<td class="gt_row gt_right" headers="Max_true">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Paper">Mellon_2020</td>
<td class="gt_row gt_left" headers="Covariate">BURN</td>
<td class="gt_row gt_left" headers="Unit">Unitless</td>
<td class="gt_row gt_right" headers="Min_sim">0.00</td>
<td class="gt_row gt_right" headers="Min_true">0.00</td>
<td class="gt_row gt_right" headers="Q1_sim">0.00</td>
<td class="gt_row gt_right" headers="Q1_true">0.00</td>
<td class="gt_row gt_right" headers="Median_sim">0.00</td>
<td class="gt_row gt_right" headers="Median_true">0.00</td>
<td class="gt_row gt_right" headers="Q3_sim">0.00</td>
<td class="gt_row gt_right" headers="Q3_true">0.00</td>
<td class="gt_row gt_right" headers="Max_sim">0.00</td>
<td class="gt_row gt_right" headers="Max_true">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Mellon_2020</td>
<td class="gt_row gt_left" headers="Covariate">OBESE</td>
<td class="gt_row gt_left" headers="Unit">Unitless</td>
<td class="gt_row gt_right" headers="Min_sim">1.00</td>
<td class="gt_row gt_right" headers="Min_true">1.00</td>
<td class="gt_row gt_right" headers="Q1_sim">1.00</td>
<td class="gt_row gt_right" headers="Q1_true">1.00</td>
<td class="gt_row gt_right" headers="Median_sim">1.00</td>
<td class="gt_row gt_right" headers="Median_true">1.00</td>
<td class="gt_row gt_right" headers="Q3_sim">1.00</td>
<td class="gt_row gt_right" headers="Q3_true">1.00</td>
<td class="gt_row gt_right" headers="Max_sim">1.00</td>
<td class="gt_row gt_right" headers="Max_true">1.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Paper">Mellon_2020</td>
<td class="gt_row gt_left" headers="Covariate">CRCL</td>
<td class="gt_row gt_left" headers="Unit">mL/min/1.73m^{2}</td>
<td class="gt_row gt_right" headers="Min_sim">5.18&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">6.20&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_sim">8.24&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_true">NA</td>
<td class="gt_row gt_right" headers="Median_sim">9.39&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_true">9.40&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">1.05&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Q3_true">NA</td>
<td class="gt_row gt_right" headers="Max_sim">1.48&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_true">1.33&nbsp;×&nbsp;10<sup>2</sup></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Mellon_2020</td>
<td class="gt_row gt_left" headers="Covariate">CRCL</td>
<td class="gt_row gt_left" headers="Unit">ml/min</td>
<td class="gt_row gt_right" headers="Min_sim">5.18&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">NA</td>
<td class="gt_row gt_right" headers="Q1_sim">8.24&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_true">NA</td>
<td class="gt_row gt_right" headers="Median_sim">9.39&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_true">NA</td>
<td class="gt_row gt_right" headers="Q3_sim">1.05&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Q3_true">NA</td>
<td class="gt_row gt_right" headers="Max_sim">1.48&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_true">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Paper">Mellon_2020</td>
<td class="gt_row gt_left" headers="Covariate">WT</td>
<td class="gt_row gt_left" headers="Unit">kg</td>
<td class="gt_row gt_right" headers="Min_sim">8.10&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">8.80&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_sim">1.02&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Q1_true">NA</td>
<td class="gt_row gt_right" headers="Median_sim">1.09&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Median_true">1.09&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">1.16&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Q3_true">NA</td>
<td class="gt_row gt_right" headers="Max_sim">1.41&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_true">1.51&nbsp;×&nbsp;10<sup>2</sup></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Mellon_2020</td>
<td class="gt_row gt_left" headers="Covariate">AGE</td>
<td class="gt_row gt_left" headers="Unit">year</td>
<td class="gt_row gt_right" headers="Min_sim">3.51&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">2.29&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_sim">4.87&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_true">NA</td>
<td class="gt_row gt_right" headers="Median_sim">5.22&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_true">5.17&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">5.57&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_true">NA</td>
<td class="gt_row gt_right" headers="Max_sim">7.07&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Max_true">6.29&nbsp;×&nbsp;10<sup>1</sup></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Then, based on the BMI and WT, the height (HT) is calculated to be able to calculate the body surface area (BSA). CRCL is reconverted to serum creatinine (CREAT) based on the MDRD equation.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>reconvert_MDRD <span class="ot">&lt;-</span> <span class="cf">function</span>(AGE, CRCL, SEX) {</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mutliply by 0.85 for females</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    sex_factor <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(SEX <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.742</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate DFG</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>   CREAT <span class="ot">&lt;-</span> (CRCL <span class="sc">/</span> (<span class="dv">175</span> <span class="sc">*</span> (AGE<span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.203</span>)) <span class="sc">*</span> sex_factor))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> <span class="fl">1.154</span>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(CREAT)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>sim_cov_mellon<span class="sc">$</span>CREAT <span class="ot">&lt;-</span> <span class="fu">mapply</span>(reconvert_MDRD, sim_cov_mellon<span class="sc">$</span>AGE, sim_cov_mellon<span class="sc">$</span>CRCL, sim_cov_mellon<span class="sc">$</span>SEX)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>sim_cov_mellon <span class="ot">&lt;-</span> sim_cov_mellon <span class="sc">%&gt;%</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>   <span class="at">HT =</span> <span class="fu">sqrt</span>(WT<span class="sc">/</span>BMI) <span class="sc">*</span> <span class="dv">100</span>, <span class="co"># mutliplied by 100 to convert m to cm</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">BSA =</span> (WT<span class="sc">^</span><span class="fl">0.425</span> <span class="sc">*</span> (HT<span class="sc">^</span><span class="fl">0.725</span>) <span class="sc">*</span> <span class="fl">0.007184</span>),</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">OBESE =</span> <span class="fu">ifelse</span>(BMI <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Paper, ID_within_paper, ICU, BURN, OBESE, CREAT, WT, BSA, BMI, AGE, SEX, HT)</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the simulated correlation matrices separately for the two sexes to compare with the original</span></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>sim_cov_mellon_M <span class="ot">&lt;-</span> sim_cov_mellon <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SEX <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>sim_cov_mellon_F <span class="ot">&lt;-</span> sim_cov_mellon <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SEX <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>cor_sim_M <span class="ot">&lt;-</span> <span class="fu">cor</span>(sim_cov_mellon_M <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(WT, CREAT, AGE, HT, BMI), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>cor_sim_F <span class="ot">&lt;-</span> <span class="fu">cor</span>(sim_cov_mellon_F <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(WT, CREAT, AGE, HT, BMI), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Mellon_F, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Mellon original (females)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_mellon-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="covariate_simulation_files/figure-html/reconvert_creat_mellon-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>Mellon_F <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(cor_sim_F, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Mellon simulated (females)"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>Mellon_F</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_mellon-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="covariate_simulation_files/figure-html/reconvert_creat_mellon-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Mellon_M, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Mellon original (males)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_mellon-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="covariate_simulation_files/figure-html/reconvert_creat_mellon-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>Mellon_M <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(cor_sim_M, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Mellon simulated (males)"</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>Mellon_M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_mellon-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36"><img src="covariate_simulation_files/figure-html/reconvert_creat_mellon-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="rambaud2020" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="rambaud2020"><span class="header-section-number">5.6</span> <span class="citation" data-cites="rambaud2020">Rambaud et al. (<a href="references.html#ref-rambaud2020" role="doc-biblioref">2020</a>)</span></h2>
<section id="covariate-distribution-3" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="covariate-distribution-3"><span class="header-section-number">5.6.1</span> Covariate distribution</h3>
<p>All patients are ICU patients with endocarditis. They are not considered to be burn victims or obese. Creatinine clearance was calculated using the CKD-EPI equation. Thus for all patients ICU = 1, BURN = 0 and OBESE=0. In this paper, the distribution of serum creatinine is given (in micromol/L), so it can be directly simulated instead of reconverting CRCL. The proportion of males is 0.794.</p>
<p>For WT and CRCL here are the data from the paper :</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>cov_data_rambaud <span class="ot">&lt;-</span> cov_data <span class="sc">|&gt;</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Paper <span class="sc">==</span> <span class="st">"Rambaud_2020"</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>cov_data_rambaud <span class="sc">|&gt;</span> </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Covariate <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"WT"</span>,<span class="st">"CREAT"</span>,<span class="st">"AGE"</span>,<span class="st">"HT"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Paper</th>
<th style="text-align: left;">Covariate</th>
<th style="text-align: left;">Unit</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Rambaud_2020</td>
<td style="text-align: left;">WT</td>
<td style="text-align: left;">kg</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">87.0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rambaud_2020</td>
<td style="text-align: left;">HT</td>
<td style="text-align: left;">cm</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">175.0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rambaud_2020</td>
<td style="text-align: left;">AGE</td>
<td style="text-align: left;">year</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">80.5</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rambaud_2020</td>
<td style="text-align: left;">CREAT</td>
<td style="text-align: left;">micromol/L</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">115.5</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>cor_matrix_Rambaud_F <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Simulations/cor_matrix_Rambaud_F.rds"</span>))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_matrix_Rambaud_F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     CREAT   CREAT_log        AGE         WT     WT_log
CREAT           1.00000000  0.96241769  0.2320510  0.1329905  0.1360852
CREAT_log       0.96241769  1.00000000  0.2429180  0.1521950  0.1565402
AGE             0.23205099  0.24291801  1.0000000 -0.1726236 -0.1683232
WT              0.13299046  0.15219495 -0.1726236  1.0000000  0.9894565
WT_log          0.13608520  0.15654017 -0.1683232  0.9894565  1.0000000
HT             -0.04892509 -0.04044581 -0.1889338  0.2517176  0.2592944
HT_log         -0.04916482 -0.04082750 -0.1894298  0.2520660  0.2599500
BMI             0.15464517  0.17128168 -0.1162404  0.9435277  0.9336719
CRCL_MDRD_norm -0.78792478 -0.91391033 -0.2872002 -0.1410118 -0.1466372
                        HT      HT_log        BMI CRCL_MDRD_norm
CREAT          -0.04892509 -0.04916482  0.1546452    -0.78792478
CREAT_log      -0.04044581 -0.04082750  0.1712817    -0.91391033
AGE            -0.18893375 -0.18942976 -0.1162404    -0.28720016
WT              0.25171756  0.25206601  0.9435277    -0.14101184
WT_log          0.25929441  0.25994996  0.9336719    -0.14663719
HT              1.00000000  0.99970438 -0.0747791     0.04109155
HT_log          0.99970438  1.00000000 -0.0742787     0.04153856
BMI            -0.07477910 -0.07427870  1.0000000    -0.15925725
CRCL_MDRD_norm  0.04109155  0.04153856 -0.1592572     1.00000000</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Rambaud_F, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Sex: female"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/Rambaud-cor-matrix-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37"><img src="covariate_simulation_files/figure-html/Rambaud-cor-matrix-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>cor_matrix_Rambaud_M <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Simulations/cor_matrix_Rambaud_M.rds"</span>))</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_matrix_Rambaud_M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      CREAT     CREAT_log        AGE          WT      WT_log
CREAT           1.000000000  0.9686820232  0.1909639  0.09370644  0.09181062
CREAT_log       0.968682023  1.0000000000  0.1982311  0.12356685  0.12378068
AGE             0.190963871  0.1982311079  1.0000000 -0.18051719 -0.17233815
WT              0.093706437  0.1235668470 -0.1805172  1.00000000  0.99225399
WT_log          0.091810623  0.1237806818 -0.1723382  0.99225399  1.00000000
HT             -0.005710820  0.0007327162 -0.1229902  0.37551772  0.37978066
HT_log         -0.005537361  0.0010029509 -0.1228308  0.37500256  0.37967684
BMI             0.103837382  0.1331126943 -0.1347419  0.89436959  0.88815355
CRCL_MDRD_norm -0.769174641 -0.8857730397 -0.2449519 -0.12508733 -0.12881176
                          HT       HT_log         BMI CRCL_MDRD_norm
CREAT          -0.0057108200 -0.005537361  0.10383738   -0.769174641
CREAT_log       0.0007327162  0.001002951  0.13311269   -0.885773040
AGE            -0.1229902101 -0.122830828 -0.13474194   -0.244951935
WT              0.3755177211  0.375002564  0.89436959   -0.125087326
WT_log          0.3797806561  0.379676845  0.88815355   -0.128811758
HT              1.0000000000  0.999598212 -0.07118055   -0.003915605
HT_log          0.9995982117  1.000000000 -0.07162513   -0.004244813
BMI            -0.0711805452 -0.071625134  1.00000000   -0.133475436
CRCL_MDRD_norm -0.0039156049 -0.004244813 -0.13347544    1.000000000</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Rambaud_M, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Sex: male"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/Rambaud-cor-matrix-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38"><img src="covariate_simulation_files/figure-html/Rambaud-cor-matrix-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>rambaud_creat <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_rambaud,</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"CREAT"</span>,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">0</span>,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">250</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>rambaud_creat<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-rambaud-creat-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39"><img src="covariate_simulation_files/figure-html/fit-rambaud-creat-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Log-normal distribution fits the best the data, so it is selected.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>rambaud_wt <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_rambaud,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"WT"</span>,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">40</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">120</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>rambaud_wt<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-rambaud-wt-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40"><img src="covariate_simulation_files/figure-html/fit-rambaud-wt-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>No discernable difference between the two fits. The log-normal distribution is selected.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>rambaud_age <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_rambaud,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"AGE"</span>,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">0</span>,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">120</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>rambaud_age<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-rambaud-age-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-41"><img src="covariate_simulation_files/figure-html/fit-rambaud-age-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>No discernable difference, so normal distribution is selected, as age usually follows a normal distribution.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>rambaud_ht <span class="ot">&lt;-</span> <span class="fu">fit_cov_wrapper</span>(</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_data =</span> cov_data_rambaud,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov_name =</span> <span class="st">"HT"</span>,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_plot =</span> <span class="dv">140</span>,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_plot =</span> <span class="dv">200</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>rambaud_ht<span class="sc">$</span>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/fit-rambaud-ht-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42"><img src="covariate_simulation_files/figure-html/fit-rambaud-ht-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>No discernable difference. Log-normal distribution is selected.</p>
</section>
<section id="simulation-of-covariates-3" class="level3" data-number="5.6.2">
<h3 data-number="5.6.2" class="anchored" data-anchor-id="simulation-of-covariates-3"><span class="header-section-number">5.6.2</span> Simulation of covariates</h3>
<p>Covariates will be sampled from the following distributions :</p>
<ul>
<li>CREAT : Log-normal distribution with a minimum 10 micromol/L with mean 89.7 micromol/L and standard deviation 0.346 micromol/L</li>
<li>WT : Normal distribution with resampling of negative values with mean 76.8 kg, and standard deviation 17.3 %</li>
<li>AGE : Normal distribution with resampling of negative values with mean 1.22^{31} years, and coefficient of variation 1370 %</li>
<li>HT : Normal distribution with resampling of negative values with mean 170 cm, and standard deviation 3.93 %</li>
</ul>
<p>The proportion of males is 0.794 in the original article, so the number of males is 496 and the number of females is 129 to add up to 625.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>correlated_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(n, means, cov_matrix) {</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1991</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  collected <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">0</span>, <span class="fu">length</span>(means))</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(collected) <span class="ot">&lt;-</span> <span class="fu">names</span>(means)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">nrow</span>(collected) <span class="sc">&lt;</span> n) {</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    batch <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> n, <span class="at">mu =</span> means, <span class="at">Sigma =</span> cov_matrix)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(batch) <span class="ot">&lt;-</span> <span class="fu">names</span>(means)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    valid <span class="ot">&lt;-</span> batch[, <span class="st">"AGE"</span>] <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>             batch[, <span class="st">"CREAT_log"</span>] <span class="sc">&lt;</span> <span class="fl">5.991465</span> <span class="co"># log(400) corresponding to CRCL of 10 mL/min for a patient of 24 kg and 116 years</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>    batch_valid <span class="ot">&lt;-</span> batch[valid, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>    collected <span class="ot">&lt;-</span> <span class="fu">rbind</span>(collected, batch_valid)</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>  collected[<span class="dv">1</span><span class="sc">:</span>n, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">CREAT_log =</span> rambaud_creat<span class="sc">$</span>lnorm_par[<span class="st">"meanlog"</span>],</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">WT_log      =</span> rambaud_wt<span class="sc">$</span>lnorm_par[<span class="st">"meanlog"</span>], </span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE     =</span> rambaud_age<span class="sc">$</span>norm_par[<span class="st">"mean"</span>],</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">HT_log      =</span> rambaud_ht<span class="sc">$</span>lnorm_par[<span class="st">"meanlog"</span>]</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>sds <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">CREAT_log =</span> rambaud_creat<span class="sc">$</span>lnorm_par[<span class="st">"sdlog"</span>],</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">WT_log     =</span> rambaud_wt<span class="sc">$</span>lnorm_par[<span class="st">"sdlog"</span>],</span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE =</span> rambaud_age<span class="sc">$</span>norm_par[<span class="st">"sd"</span>],</span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">HT_log     =</span> rambaud_ht<span class="sc">$</span>lnorm_par[<span class="st">"sdlog"</span>]</span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>covariates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CREAT_log"</span>, <span class="st">"WT_log"</span>, <span class="st">"AGE"</span>, <span class="st">"HT_log"</span>)</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(means) <span class="ot">&lt;-</span> covariates</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation and Covariance Matrix</span></span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a>cor_rambaud_M <span class="ot">&lt;-</span> cor_matrix_Rambaud_M[covariates, covariates]</span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a>cov_matrix_M <span class="ot">&lt;-</span> <span class="fu">diag</span>(sds) <span class="sc">%*%</span> cor_rambaud_M <span class="sc">%*%</span> <span class="fu">diag</span>(sds)</span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(cov_matrix_M)<span class="sc">$</span>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.888441e+02 1.160604e-01 2.831560e-02 1.302147e-03</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>cor_rambaud_F <span class="ot">&lt;-</span> cor_matrix_Rambaud_F[covariates, covariates]</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>cov_matrix_F <span class="ot">&lt;-</span> <span class="fu">diag</span>(sds) <span class="sc">%*%</span> cor_rambaud_F <span class="sc">%*%</span> <span class="fu">diag</span>(sds)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(cov_matrix_F)<span class="sc">$</span>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.888465e+02 1.143105e-01 2.761902e-02 1.396003e-03</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>sim_data_M <span class="ot">&lt;-</span> <span class="fu">correlated_simulation</span>(<span class="at">n =</span> <span class="dv">496</span>, <span class="at">means =</span> means, <span class="at">cov_matrix =</span> cov_matrix_M)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>sim_data_M <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(sim_data_M) <span class="sc">%&gt;%</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SEX =</span> <span class="dv">0</span>)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>sim_data_F <span class="ot">&lt;-</span> <span class="fu">correlated_simulation</span>(<span class="at">n =</span> <span class="dv">129</span>, <span class="at">means =</span> means, <span class="at">cov_matrix =</span> cov_matrix_F)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>sim_data_F <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(sim_data_F) <span class="sc">%&gt;%</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SEX =</span> <span class="dv">1</span>)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sim_data_M, sim_data_F)</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the covariates together</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>sim_cov_rambaud <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Paper =</span> <span class="st">"Rambaud_2020"</span>,</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID_within_paper =</span> <span class="dv">1</span><span class="sc">:</span>n_patient,</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ICU =</span> <span class="dv">1</span>,</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">BURN =</span> <span class="dv">0</span>,</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">OBESE =</span> <span class="dv">0</span>,</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">CREAT_log =</span> sim_data<span class="sc">$</span>CREAT_log,</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">WT_log   =</span> sim_data<span class="sc">$</span>WT_log,</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">AGE  =</span> sim_data<span class="sc">$</span>AGE,</span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">HT_log  =</span> sim_data<span class="sc">$</span>HT_log,</span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">SEX =</span> sim_data<span class="sc">$</span>SEX)</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>sim_cov_rambaud <span class="ot">&lt;-</span> sim_cov_rambaud <span class="sc">%&gt;%</span></span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CREAT =</span> <span class="fu">exp</span>(CREAT_log),</span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">HT =</span> <span class="fu">exp</span>(HT_log),</span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">WT =</span> <span class="fu">exp</span>(WT_log))</span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>summary_sim_cov_rambaud <span class="ot">&lt;-</span> sim_cov_rambaud <span class="sc">|&gt;</span> </span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(ICU,BURN,OBESE,CREAT,WT,AGE,HT),</span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Covariate"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">.by =</span> <span class="fu">c</span>(Covariate,Paper),</span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">Min =</span> <span class="fu">min</span>(value),</span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">Q1 =</span> <span class="fu">quantile</span>(value, <span class="fl">0.25</span>),</span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">Median =</span> <span class="fu">quantile</span>(value, <span class="fl">0.5</span>),</span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">Q3 =</span> <span class="fu">quantile</span>(value, <span class="fl">0.75</span>),</span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">Max =</span> <span class="fu">max</span>(value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>cov_rambaud_compare <span class="ot">&lt;-</span> summary_sim_cov_rambaud <span class="sc">|&gt;</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">paste0</span>(.x, <span class="st">"_sim"</span>), <span class="sc">-</span><span class="fu">one_of</span>(<span class="st">"Covariate"</span>, <span class="st">"Paper"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">rename_with</span>(</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    cov_data_rambaud,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">paste0</span>(.x, <span class="st">"_true"</span>),</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">one_of</span>(<span class="st">"Covariate"</span>, <span class="st">"Paper"</span>, <span class="st">"Unit"</span>)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span> </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Covariate, <span class="at">.after =</span> Paper) <span class="sc">|&gt;</span> </span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Unit, <span class="at">.after =</span> Covariate)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>cov_rambaud_compare <span class="sc">|&gt;</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_scientific</span>() <span class="sc">|&gt;</span> </span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Min"</span>),</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Min"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Q1"</span>),</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Q1"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Median"</span>),</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Median"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Q3"</span>),</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Q3"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"Max"</span>),</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="st">"Max"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ksfrttirxe" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ksfrttirxe table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ksfrttirxe thead, #ksfrttirxe tbody, #ksfrttirxe tfoot, #ksfrttirxe tr, #ksfrttirxe td, #ksfrttirxe th {
  border-style: none;
}

#ksfrttirxe p {
  margin: 0;
  padding: 0;
}

#ksfrttirxe .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ksfrttirxe .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ksfrttirxe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ksfrttirxe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ksfrttirxe .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ksfrttirxe .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ksfrttirxe .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ksfrttirxe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ksfrttirxe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ksfrttirxe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ksfrttirxe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ksfrttirxe .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ksfrttirxe .gt_spanner_row {
  border-bottom-style: hidden;
}

#ksfrttirxe .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ksfrttirxe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ksfrttirxe .gt_from_md > :first-child {
  margin-top: 0;
}

#ksfrttirxe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ksfrttirxe .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ksfrttirxe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ksfrttirxe .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ksfrttirxe .gt_row_group_first td {
  border-top-width: 2px;
}

#ksfrttirxe .gt_row_group_first th {
  border-top-width: 2px;
}

#ksfrttirxe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ksfrttirxe .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ksfrttirxe .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ksfrttirxe .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ksfrttirxe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ksfrttirxe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ksfrttirxe .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ksfrttirxe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ksfrttirxe .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ksfrttirxe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ksfrttirxe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ksfrttirxe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ksfrttirxe .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ksfrttirxe .gt_left {
  text-align: left;
}

#ksfrttirxe .gt_center {
  text-align: center;
}

#ksfrttirxe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ksfrttirxe .gt_font_normal {
  font-weight: normal;
}

#ksfrttirxe .gt_font_bold {
  font-weight: bold;
}

#ksfrttirxe .gt_font_italic {
  font-style: italic;
}

#ksfrttirxe .gt_super {
  font-size: 65%;
}

#ksfrttirxe .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ksfrttirxe .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ksfrttirxe .gt_indent_1 {
  text-indent: 5px;
}

#ksfrttirxe .gt_indent_2 {
  text-indent: 10px;
}

#ksfrttirxe .gt_indent_3 {
  text-indent: 15px;
}

#ksfrttirxe .gt_indent_4 {
  text-indent: 20px;
}

#ksfrttirxe .gt_indent_5 {
  text-indent: 25px;
}

#ksfrttirxe .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ksfrttirxe div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="Paper" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Paper</th>
<th rowspan="2" id="Covariate" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Covariate</th>
<th rowspan="2" id="Unit" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Unit</th>
<th colspan="2" id="Min" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Min
</div></th>
<th colspan="2" id="Q1" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Q1
</div></th>
<th colspan="2" id="Median" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Median
</div></th>
<th colspan="2" id="Q3" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Q3
</div></th>
<th colspan="2" id="Max" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Max
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="Min_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Min_sim</th>
<th id="Min_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Min_true</th>
<th id="Q1_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q1_sim</th>
<th id="Q1_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q1_true</th>
<th id="Median_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median_sim</th>
<th id="Median_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median_true</th>
<th id="Q3_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q3_sim</th>
<th id="Q3_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Q3_true</th>
<th id="Max_sim" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Max_sim</th>
<th id="Max_true" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Max_true</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Rambaud_2020</td>
<td class="gt_row gt_left" headers="Covariate">ICU</td>
<td class="gt_row gt_left" headers="Unit">Unitless</td>
<td class="gt_row gt_right" headers="Min_sim">1.00</td>
<td class="gt_row gt_right" headers="Min_true">1.00</td>
<td class="gt_row gt_right" headers="Q1_sim">1.00</td>
<td class="gt_row gt_right" headers="Q1_true">1.00</td>
<td class="gt_row gt_right" headers="Median_sim">1.00</td>
<td class="gt_row gt_right" headers="Median_true">1.00</td>
<td class="gt_row gt_right" headers="Q3_sim">1.00</td>
<td class="gt_row gt_right" headers="Q3_true">1.00</td>
<td class="gt_row gt_right" headers="Max_sim">1.00</td>
<td class="gt_row gt_right" headers="Max_true">1.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Paper">Rambaud_2020</td>
<td class="gt_row gt_left" headers="Covariate">BURN</td>
<td class="gt_row gt_left" headers="Unit">Unitless</td>
<td class="gt_row gt_right" headers="Min_sim">0.00</td>
<td class="gt_row gt_right" headers="Min_true">0.00</td>
<td class="gt_row gt_right" headers="Q1_sim">0.00</td>
<td class="gt_row gt_right" headers="Q1_true">0.00</td>
<td class="gt_row gt_right" headers="Median_sim">0.00</td>
<td class="gt_row gt_right" headers="Median_true">0.00</td>
<td class="gt_row gt_right" headers="Q3_sim">0.00</td>
<td class="gt_row gt_right" headers="Q3_true">0.00</td>
<td class="gt_row gt_right" headers="Max_sim">0.00</td>
<td class="gt_row gt_right" headers="Max_true">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Rambaud_2020</td>
<td class="gt_row gt_left" headers="Covariate">OBESE</td>
<td class="gt_row gt_left" headers="Unit">Unitless</td>
<td class="gt_row gt_right" headers="Min_sim">0.00</td>
<td class="gt_row gt_right" headers="Min_true">0.00</td>
<td class="gt_row gt_right" headers="Q1_sim">0.00</td>
<td class="gt_row gt_right" headers="Q1_true">0.00</td>
<td class="gt_row gt_right" headers="Median_sim">0.00</td>
<td class="gt_row gt_right" headers="Median_true">0.00</td>
<td class="gt_row gt_right" headers="Q3_sim">0.00</td>
<td class="gt_row gt_right" headers="Q3_true">0.00</td>
<td class="gt_row gt_right" headers="Max_sim">0.00</td>
<td class="gt_row gt_right" headers="Max_true">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Paper">Rambaud_2020</td>
<td class="gt_row gt_left" headers="Covariate">CREAT</td>
<td class="gt_row gt_left" headers="Unit">micromol/L</td>
<td class="gt_row gt_right" headers="Min_sim">2.08&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">NA</td>
<td class="gt_row gt_right" headers="Q1_sim">6.79&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_true">7.30&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_sim">8.67&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_true">8.70&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">1.12&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Q3_true">1.15&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_sim">3.08&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_true">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Rambaud_2020</td>
<td class="gt_row gt_left" headers="Covariate">WT</td>
<td class="gt_row gt_left" headers="Unit">kg</td>
<td class="gt_row gt_right" headers="Min_sim">4.13&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">NA</td>
<td class="gt_row gt_right" headers="Q1_sim">6.75&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_true">6.90&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_sim">7.65&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_true">7.60&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">8.64&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_true">8.70&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Max_sim">1.21&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_true">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Paper">Rambaud_2020</td>
<td class="gt_row gt_left" headers="Covariate">AGE</td>
<td class="gt_row gt_left" headers="Unit">year</td>
<td class="gt_row gt_right" headers="Min_sim">1.97&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Min_true">NA</td>
<td class="gt_row gt_right" headers="Q1_sim">6.04&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q1_true">6.20&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_sim">7.08&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Median_true">7.20&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">8.20&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Q3_true">8.05&nbsp;×&nbsp;10<sup>1</sup></td>
<td class="gt_row gt_right" headers="Max_sim">1.12&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_true">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Paper">Rambaud_2020</td>
<td class="gt_row gt_left" headers="Covariate">HT</td>
<td class="gt_row gt_left" headers="Unit">cm</td>
<td class="gt_row gt_right" headers="Min_sim">1.50&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Min_true">NA</td>
<td class="gt_row gt_right" headers="Q1_sim">1.64&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Q1_true">1.66&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Median_sim">1.69&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Median_true">1.70&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Q3_sim">1.75&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Q3_true">1.75&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_sim">1.96&nbsp;×&nbsp;10<sup>2</sup></td>
<td class="gt_row gt_right" headers="Max_true">NA</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_sim_cov_wrapper</span>(cov_data_rambaud,<span class="st">"CREAT"</span>,sim_cov_rambaud)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/plot-cov-rambaud-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43"><img src="covariate_simulation_files/figure-html/plot-cov-rambaud-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_sim_cov_wrapper</span>(cov_data_rambaud,<span class="st">"WT"</span>,sim_cov_rambaud)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/plot-cov-rambaud-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44"><img src="covariate_simulation_files/figure-html/plot-cov-rambaud-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_sim_cov_wrapper</span>(cov_data_rambaud,<span class="st">"AGE"</span>,sim_cov_rambaud)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/plot-cov-rambaud-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-45"><img src="covariate_simulation_files/figure-html/plot-cov-rambaud-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_sim_cov_wrapper</span>(cov_data_rambaud,<span class="st">"HT"</span>,sim_cov_rambaud)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/plot-cov-rambaud-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-46"><img src="covariate_simulation_files/figure-html/plot-cov-rambaud-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>CREAT is converted from micromol/L to mg/dL.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>sim_cov_rambaud <span class="ot">&lt;-</span> sim_cov_rambaud <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">BSA =</span> (WT<span class="sc">^</span><span class="fl">0.425</span> <span class="sc">*</span> (HT<span class="sc">^</span><span class="fl">0.725</span>) <span class="sc">*</span> <span class="fl">0.007184</span>),</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">CREAT =</span> CREAT<span class="sc">/</span><span class="fl">88.4</span>,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">BMI =</span> WT <span class="sc">/</span> (HT<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">OBESE =</span> <span class="fu">ifelse</span>(BMI <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Paper, ID_within_paper, ICU, BURN, OBESE, CREAT, WT, BSA, BMI, AGE, SEX, HT)</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the simulated correlation matrices separately for the two sexes to compare with the original</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>sim_cov_rambaud_M <span class="ot">&lt;-</span> sim_cov_rambaud <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SEX <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>sim_cov_rambaud_F <span class="ot">&lt;-</span> sim_cov_rambaud <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SEX <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>cor_sim_M <span class="ot">&lt;-</span> <span class="fu">cor</span>(sim_cov_rambaud_M <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(WT, CREAT, AGE, HT, BMI), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>cor_sim_F <span class="ot">&lt;-</span> <span class="fu">cor</span>(sim_cov_rambaud_F <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(WT, CREAT, AGE, HT, BMI), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Rambaud_F, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Rambaud original (females)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_rambaud-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-47"><img src="covariate_simulation_files/figure-html/reconvert_creat_rambaud-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>Rambaud_F <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(cor_sim_F, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Rambaud simulated (females)"</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>Rambaud_F</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_rambaud-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-48"><img src="covariate_simulation_files/figure-html/reconvert_creat_rambaud-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_matrix_Rambaud_M, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Rambaud original (males)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_rambaud-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-49"><img src="covariate_simulation_files/figure-html/reconvert_creat_rambaud-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>Rambaud_M <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(cor_sim_M, <span class="at">lab =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Rambaud simulated (males)"</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>Rambaud_M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/reconvert_creat_rambaud-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-50"><img src="covariate_simulation_files/figure-html/reconvert_creat_rambaud-4.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="final-covariate-table" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="final-covariate-table"><span class="header-section-number">5.7</span> Final covariate table</h2>
<p>Make the final covariate dataset with 2500 sets of covariates in a way that in each 100 sets, we have 25-25 from each covariate’s cohort, as later, each dosing regimen will be simulated for 100 sets of covariates, and it is important that the 4 cohorts are equally represented.</p>
<p>Also, for the concentration simulation part, we have to know before applying the models, if a patient needs a different regiment due to his renal failure or not. That is why an additional IR column is added where 1 indicates a renal failure patient who needs a dose adjustement. For Carlier, the MDRD equation is used, and for Fournier, the Cockroft and Gault. For Mellon and Rambaud, all patients have 0 in the IR column, as it is not explicited in the articles that a dose adjustement was applied to renal failure patients.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Patchwork simulated correlation plots</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>corr_simulated <span class="ot">&lt;-</span> (Carlier_F <span class="sc">+</span> Fournier_F <span class="sc">+</span> Mellon_F <span class="sc">+</span> Rambaud_F <span class="sc">+</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  Carlier_M <span class="sc">+</span> Fournier_M <span class="sc">+</span> Mellon_M <span class="sc">+</span> Rambaud_M) <span class="sc">+</span> </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">here</span>(<span class="st">"Figures/S5.jpg"</span>),</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> corr_simulated,</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Row-bind the datasets to have 25 subjects from each in a sample of 100</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>datasets <span class="ot">&lt;-</span> <span class="fu">list</span>(sim_cov_carlier, sim_cov_fournier, sim_cov_mellon, sim_cov_rambaud)</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>interleave_rows <span class="ot">&lt;-</span> <span class="cf">function</span>(datasets, chunk_size) {</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>  n_chunks <span class="ot">&lt;-</span> <span class="fu">nrow</span>(datasets[[<span class="dv">1</span>]]) <span class="sc">/</span> chunk_size</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>  interleaved <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n_chunks, <span class="cf">function</span>(i) {</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(datasets, <span class="cf">function</span>(dataset) {</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>      dataset[((i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">*</span> chunk_size), ]</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>    }))</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(interleaved)</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>COV <span class="ot">&lt;-</span> <span class="fu">interleave_rows</span>(datasets, <span class="at">chunk_size =</span> <span class="dv">25</span>)</span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Paper column to MODEL_COHORT column which indicates the model that is used to simulated the covariates</span></span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a>COV <span class="ot">&lt;-</span> COV <span class="sc">%&gt;%</span></span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MODEL_COHORT =</span> <span class="fu">case_when</span>(</span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a>    Paper <span class="sc">==</span> <span class="st">"Carlier_2013"</span> <span class="sc">~</span> <span class="st">"CARLIER"</span>,</span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a>    Paper <span class="sc">==</span> <span class="st">"Fournier_2018"</span> <span class="sc">~</span> <span class="st">"FOURNIER"</span>,</span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a>    Paper <span class="sc">==</span> <span class="st">"Mellon_2020"</span> <span class="sc">~</span> <span class="st">"MELLON"</span>,</span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a>    Paper <span class="sc">==</span> <span class="st">"Rambaud_2020"</span> <span class="sc">~</span> <span class="st">"RAMBAUD"</span>)</span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding ID</span></span>
<span id="cb103-34"><a href="#cb103-34" aria-hidden="true" tabindex="-1"></a>COV<span class="sc">$</span>ID <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2500</span>)</span>
<span id="cb103-35"><a href="#cb103-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-36"><a href="#cb103-36" aria-hidden="true" tabindex="-1"></a><span class="co"># CRCL calculation functions</span></span>
<span id="cb103-37"><a href="#cb103-37" aria-hidden="true" tabindex="-1"></a>calculate_MDRD <span class="ot">&lt;-</span> <span class="cf">function</span>(AGE, CREAT, SEX) {</span>
<span id="cb103-38"><a href="#cb103-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mutliply by 0.742 for females</span></span>
<span id="cb103-39"><a href="#cb103-39" aria-hidden="true" tabindex="-1"></a>    sex_factor <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(SEX <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.742</span>)</span>
<span id="cb103-40"><a href="#cb103-40" aria-hidden="true" tabindex="-1"></a>    eGFR <span class="ot">&lt;-</span> <span class="dv">175</span> <span class="sc">*</span> (CREAT<span class="sc">^</span>(<span class="sc">-</span><span class="fl">1.154</span>)) <span class="sc">*</span> AGE<span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.203</span>) <span class="sc">*</span> sex_factor</span>
<span id="cb103-41"><a href="#cb103-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(eGFR)</span>
<span id="cb103-42"><a href="#cb103-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-43"><a href="#cb103-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-44"><a href="#cb103-44" aria-hidden="true" tabindex="-1"></a>calculate_CG <span class="ot">&lt;-</span> <span class="cf">function</span>(AGE, CREAT, SEX, WT) {</span>
<span id="cb103-45"><a href="#cb103-45" aria-hidden="true" tabindex="-1"></a>  sex_factor <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(SEX <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.85</span>)</span>
<span id="cb103-46"><a href="#cb103-46" aria-hidden="true" tabindex="-1"></a>  eGFR <span class="ot">&lt;-</span> ((<span class="dv">140</span> <span class="sc">-</span> AGE) <span class="sc">*</span> WT <span class="sc">*</span> sex_factor) <span class="sc">/</span> (CREAT <span class="sc">*</span> <span class="dv">72</span>)</span>
<span id="cb103-47"><a href="#cb103-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(eGFR)</span>
<span id="cb103-48"><a href="#cb103-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-49"><a href="#cb103-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-50"><a href="#cb103-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Add 1 for dose adjustement for CRCL &lt; 30 mL/min for Carlier and Fournier</span></span>
<span id="cb103-51"><a href="#cb103-51" aria-hidden="true" tabindex="-1"></a>COV <span class="ot">&lt;-</span> COV <span class="sc">%&gt;%</span></span>
<span id="cb103-52"><a href="#cb103-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-53"><a href="#cb103-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb103-54"><a href="#cb103-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">CRCL =</span> <span class="fu">case_when</span>(</span>
<span id="cb103-55"><a href="#cb103-55" aria-hidden="true" tabindex="-1"></a>      MODEL_COHORT <span class="sc">==</span> <span class="st">"CARLIER"</span> <span class="sc">~</span> <span class="fu">calculate_MDRD</span>(AGE, CREAT, SEX) <span class="sc">*</span> (BSA <span class="sc">/</span> <span class="fl">1.73</span>),</span>
<span id="cb103-56"><a href="#cb103-56" aria-hidden="true" tabindex="-1"></a>      MODEL_COHORT <span class="sc">==</span> <span class="st">"FOURNIER"</span> <span class="sc">~</span> <span class="fu">calculate_CG</span>(AGE, CREAT, SEX, WT),</span>
<span id="cb103-57"><a href="#cb103-57" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb103-58"><a href="#cb103-58" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb103-59"><a href="#cb103-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">IR =</span> <span class="fu">case_when</span>(</span>
<span id="cb103-60"><a href="#cb103-60" aria-hidden="true" tabindex="-1"></a>      MODEL_COHORT <span class="sc">==</span> <span class="st">"CARLIER"</span> <span class="sc">&amp;</span> CRCL <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb103-61"><a href="#cb103-61" aria-hidden="true" tabindex="-1"></a>      MODEL_COHORT <span class="sc">==</span> <span class="st">"FOURNIER"</span> <span class="sc">&amp;</span> CRCL <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb103-62"><a href="#cb103-62" aria-hidden="true" tabindex="-1"></a>      MODEL_COHORT <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"MELLON"</span>, <span class="st">"RAMBAUD"</span>) <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb103-63"><a href="#cb103-63" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb103-64"><a href="#cb103-64" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb103-65"><a href="#cb103-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb103-66"><a href="#cb103-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb103-67"><a href="#cb103-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-68"><a href="#cb103-68" aria-hidden="true" tabindex="-1"></a>COV <span class="ot">&lt;-</span> COV <span class="sc">%&gt;%</span></span>
<span id="cb103-69"><a href="#cb103-69" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID, MODEL_COHORT, WT, CREAT, BURN, ICU, OBESE, BSA, AGE, SEX, HT, IR)</span>
<span id="cb103-70"><a href="#cb103-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-71"><a href="#cb103-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Export to csv</span></span>
<span id="cb103-72"><a href="#cb103-72" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(COV, <span class="fu">here</span>(<span class="st">"Data/COV.csv"</span>), <span class="at">quote =</span> F, <span class="at">row.names =</span> F)</span>
<span id="cb103-73"><a href="#cb103-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-74"><a href="#cb103-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Check correlation (Pearson)</span></span>
<span id="cb103-75"><a href="#cb103-75" aria-hidden="true" tabindex="-1"></a>cor_sim <span class="ot">&lt;-</span> <span class="fu">cor</span>(COV <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(WT, CREAT, BURN, ICU, OBESE, AGE, SEX, HT), <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb103-76"><a href="#cb103-76" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(cor_sim, <span class="at">lab =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="covariate_simulation_files/figure-html/final_table-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-51"><img src="covariate_simulation_files/figure-html/final_table-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Carlier2013-bq" class="csl-entry" role="listitem">
Carlier, Mieke, Michaël Noë, Jan J De Waele, Veronique Stove, Alain G Verstraete, Jeffrey Lipman, and Jason A Roberts. 2013. <span>“Population Pharmacokinetics and Dosing Simulations of Amoxicillin/Clavulanic Acid in Critically Ill Patients.”</span> <em>J. Antimicrob. Chemother.</em> 68 (11): 2600–2608.
</div>
<div id="ref-fournier2018" class="csl-entry" role="listitem">
Fournier, Anne, Sylvain Goutelle, Yok-Ai Que, Philippe Eggimann, Olivier Pantet, Farshid Sadeghipour, Pierre Voirol, and Chantal Csajka. 2018. <span>“Population Pharmacokinetic Study of Amoxicillin-Treated Burn Patients Hospitalized at a Swiss Tertiary-Care Center.”</span> <em>Antimicrobial Agents and Chemotherapy</em> 62 (9): e00505–18. <a href="https://doi.org/10.1128/AAC.00505-18">https://doi.org/10.1128/AAC.00505-18</a>.
</div>
<div id="ref-Johnson2023-zo" class="csl-entry" role="listitem">
Johnson, Alistair E W, Lucas Bulgarelli, Lu Shen, Alvin Gayles, Ayad Shammout, Steven Horng, Tom J Pollard, et al. 2023. <span>“<span>MIMIC-IV</span>, a Freely Accessible Electronic Health Record Dataset.”</span> <em>Sci. Data</em> 10 (1): 1.
</div>
<div id="ref-mellon2020" class="csl-entry" role="listitem">
Mellon, G, K Hammas, C Burdet, X Duval, C Carette, N El-Helali, L Massias, F Mentré, S Czernichow, and A -C Crémieux. 2020. <span>“Population Pharmacokinetics and Dosing Simulations of Amoxicillin in Obese Adults Receiving Co-Amoxiclav.”</span> <em>Journal of Antimicrobial Chemotherapy</em> 75 (12): 3611–18. <a href="https://doi.org/10.1093/jac/dkaa368">https://doi.org/10.1093/jac/dkaa368</a>.
</div>
<div id="ref-rambaud2020" class="csl-entry" role="listitem">
Rambaud, Antoine, Benjamin Jean Gaborit, Colin Deschanvres, Paul Le Turnier, Raphaël Lecomte, Nathalie Asseray-Madani, Anne-Gaëlle Leroy, et al. 2020. <span>“Development and Validation of a Dosing Nomogram for Amoxicillin in Infective Endocarditis.”</span> <em>The Journal of Antimicrobial Chemotherapy</em> 75 (10): 2941–50. <a href="https://doi.org/10.1093/jac/dkaa232">https://doi.org/10.1093/jac/dkaa232</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../Model_implementation_validation/quarto/valid_amox_mellon_hammas_2020.html" class="pagination-link" aria-label="Validation PKpop Amox Mellon 2020">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Validation PKpop Amox Mellon 2020</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Simulations/concentrations_simulation.html" class="pagination-link" aria-label="Simulation of concentrations and secondary PK parameters">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Simulation of concentrations and secondary PK parameters</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>