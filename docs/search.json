[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "STP-BRIOCHE : A priori MIPD - Amoxicillin",
    "section": "",
    "text": "Preface\nThis book contains all that is related to the a priori MIPD developped in STP-BRIOCHE",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html",
    "href": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html",
    "title": "1  Validation PKpop Amox Carlier 2013",
    "section": "",
    "text": "2 Paper\n(Carlier et al. 2013)",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Validation PKpop Amox Carlier 2013</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html#model-parameters",
    "href": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html#model-parameters",
    "title": "1  Validation PKpop Amox Carlier 2013",
    "section": "3.1 Model parameters",
    "text": "3.1 Model parameters\n\n\n\n\nTable 3.2: Model parameters for amoxicillin\n\n\n\n\n\n\n\n\n\n\n\n\nparameter_name\nparameter_description\nunit\nmean\n\n\n\n\nCLpop\nTypical clearance (for a patient with creatinin clearance of 102 mL/min)\nL/h\n10.0\n\n\nQ\nIntercompartmental clearance\nL/h\n15.6\n\n\nVcpop\nTypical central volume of distribution (for a patient with creatinin clearance of 102 mL/min)\nL\n13.7\n\n\nVp\nPeripheral volume of distribution\nL\n13.7\n\n\ncv_iiv_CL\nCoefficient of variation of the inter individual variability on clearance (%)\nunitless\n39.9\n\n\ncv_iiv_Vc\nCoefficient of variation of the inter individual variability on central volume of distribution (%)\nunitless\n38.7\n\n\nruv\nCoefficient of variation of the residual variability\nunitless\n22.0",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Validation PKpop Amox Carlier 2013</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html#inter-individual-variability-and-covariate-effects",
    "href": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html#inter-individual-variability-and-covariate-effects",
    "title": "1  Validation PKpop Amox Carlier 2013",
    "section": "3.2 Inter-individual variability and covariate effects",
    "text": "3.2 Inter-individual variability and covariate effects\nCovariate effect : \\[\nTVCL_{i} = CLpop*\\frac{CLCR_{i}}{102}*e^{\\eta_{i}}\n\\] With :\n\\(TVCL_{i}\\) : Amoxicillin clearance for individual i\n\\(CLpop\\) : Typical amoxicillin clearance (L/h)\n\\(CLCR_{i}\\) : 24h urinary creatinin clearance (mL/min) for individual i\n\\(\\eta_{i}\\) : Normal variable with mean 0 and variance \\(\\omega^2_{CL}\\)\n\\(102\\) : population’s median urinary creatinine clearance in mL/min",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Validation PKpop Amox Carlier 2013</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html#preliminary-testing",
    "href": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html#preliminary-testing",
    "title": "1  Validation PKpop Amox Carlier 2013",
    "section": "4.1 Preliminary testing",
    "text": "4.1 Preliminary testing\nFirst we check that simulations for a single dosing regimen and creatinine clearance value make sense.\n\n\n\n\n\n\n\n\n\n\n\n\nMIC\nmean_ft_over_mic\nsd_ft_over_mic\nmedian_ft_over_mic\nPTA_0.5\n\n\n\n\n4\n1\nNA\n1\n1\n\n\n\n\n\nLooks ok",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Validation PKpop Amox Carlier 2013</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html#table-5",
    "href": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html#table-5",
    "title": "1  Validation PKpop Amox Carlier 2013",
    "section": "4.2 Table 5",
    "text": "4.2 Table 5\nThis table indicate wether the target is attained for a typical patient receiving amoxicillin, for various dosing regimen and various creatinin clearances.\n\n\n\n\nTable 4.1: Simulated dosing regimen\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nInfusion type\nLoading dose ?\nDose regimen\ntime\nInfusion duration (h)\nDose (mg)\nInterdose interval (h)\nss\nevid\ncmt\n\n\n\n\nintermittent\nno\nii 0.5g q4h\n0.0\n0.5\n500\n4\n0\n1\n1\n\n\nintermittent\nno\nii 0.5g q6h\n0.0\n0.5\n500\n6\n0\n1\n1\n\n\nintermittent\nno\nii 0.5g q8h\n0.0\n0.5\n500\n8\n0\n1\n1\n\n\nintermittent\nno\nii 1g q4h\n0.0\n0.5\n1000\n4\n0\n1\n1\n\n\nintermittent\nno\nii 1g q6h\n0.0\n0.5\n1000\n6\n0\n1\n1\n\n\nintermittent\nno\nii 1g q8h\n0.0\n0.5\n1000\n8\n0\n1\n1\n\n\nintermittent\nno\nii 2g q6h\n0.0\n0.5\n2000\n6\n0\n1\n1\n\n\nintermittent\nno\nii 2g q8h\n0.0\n0.5\n2000\n8\n0\n1\n1\n\n\nextended\nno\nei 0.5g q4h\n0.0\n2.0\n500\n4\n0\n1\n1\n\n\nextended\nno\nei 0.5g q6h\n0.0\n3.0\n500\n6\n0\n1\n1\n\n\nextended\nno\nei 0.5g q8h\n0.0\n4.0\n500\n8\n0\n1\n1\n\n\nextended\nno\nei 1g q4h\n0.0\n2.0\n1000\n4\n0\n1\n1\n\n\nextended\nno\nei 1g q6h\n0.0\n3.0\n1000\n6\n0\n1\n1\n\n\nextended\nno\nei 1g q8h\n0.0\n4.0\n1000\n8\n0\n1\n1\n\n\nextended\nno\nei 2g q6h\n0.0\n3.0\n2000\n6\n0\n1\n1\n\n\nextended\nno\nei 2g q8h\n0.0\n4.0\n2000\n8\n0\n1\n1\n\n\nextended\nno\nei 3g q6h\n0.0\n3.0\n3000\n6\n0\n1\n1\n\n\ncontinuous\nyes 1g over 0.5h\nci 6g q24h\n0.0\n0.5\n1000\n0\n0\n1\n1\n\n\ncontinuous\nyes 1g over 0.5h\nci 6g q24h\n0.5\n24.0\n6000\n24\n0\n1\n1\n\n\ncontinuous\nyes 1g over 0.5h\nci 4g q24h\n0.0\n0.5\n1000\n0\n0\n1\n1\n\n\ncontinuous\nyes 1g over 0.5h\nci 4g q24h\n0.5\n24.0\n4000\n24\n0\n1\n1\n\n\ncontinuous\nyes 1g over 0.5h\nci 3g q24h\n0.0\n0.5\n1000\n0\n0\n1\n1\n\n\ncontinuous\nyes 1g over 0.5h\nci 3g q24h\n0.5\n24.0\n3000\n24\n0\n1\n1\n\n\ncontinuous\nyes 1g over 0.5h\nci 8g q24h\n0.0\n0.5\n1000\n0\n0\n1\n1\n\n\ncontinuous\nyes 1g over 0.5h\nci 8g q24h\n0.5\n24.0\n8000\n24\n0\n1\n1\n\n\ncontinuous\nyes 1g over 0.5h\nci 12g q24h\n0.0\n0.5\n1000\n0\n0\n1\n1\n\n\ncontinuous\nyes 1g over 0.5h\nci 12g q24h\n0.5\n24.0\n12000\n24\n0\n1\n1\n\n\n\n\n\n\n\n\nSimulations were performed for 4 creatinine clearance values (30 mL/min, 50 mL/min, 130 mL/min, 190 mL/min).\nTwo different fT&gt;MIC were studied (50%, 100%) They were computed for a range of MICs (4, 8, 16 mg/L).\nFirst, \\(fT&gt;MIC\\) was calculated at steady state. Amoxicillin concentrations were considered at steady state after nine days.\n\n\n\n\n\n\n\n\nFigure 4.1: Original paper table 5\n\n\n\n\n\n\n\n\n\nTable 4.2: Reproduction of table 5 at steady state\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMIC = 4 mg/L\n\n\nMIC = 8 mg/L\n\n\nMIC = 16 mg/L\n\n\n\n\n\nfT&gt;MIC &gt; 0.5\n\n\nfT&gt;MIC &gt; 1\n\n\nsim\n\n\nfT&gt;MIC &gt; 0.5\n\n\nfT&gt;MIC &gt; 1\n\n\nsim\n\n\nfT&gt;MIC &gt; 0.5\n\n\nfT&gt;MIC &gt; 1\n\n\nsim\n\n\n\nagreement\npaper\nsim\nagreement\npaper\nsim\nftovermic\nagreement\npaper\nsim\nagreement\npaper\nsim\nftovermic\nagreement\npaper\nsim\nagreement\npaper\nsim\nftovermic\n\n\n\n\nCreatinine clearance 30 mL/min\n\n\nii 0.5g q8h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n-\n-\n77.8%\n\n\nii 1g q8h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n\n\nii 1g q6h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n\n\nCreatinine clearance 50 mL/min\n\n\nii 0.5g q6h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n✘\n+\n-\n✔\n-\n-\n46.0%\n\n\nii 1g q8h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n-\n-\n76.0%\n\n\nei 1g q8h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✘\n+\n-\n99.6%\n\n\nii 1g q6h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n\n\nci 4g q24h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n\n\nCreatinine clearance 130 mL/min\n\n\nii 1g q8h\n✔\n+\n+\n✔\n-\n-\n62.7%\n✔\n-\n-\n✔\n-\n-\n39.2%\n✔\n-\n-\n✔\n-\n-\n18.1%\n\n\nii 1g q6h\n✔\n+\n+\n✘\n+\n-\n86.5%\n✔\n+\n+\n✔\n-\n-\n55.2%\n✔\n-\n-\n✔\n-\n-\n26.0%\n\n\nei 1g q6h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n-\n-\n76.4%\n✘\n+\n-\n✔\n-\n-\n36.1%\n\n\nci 4g q24h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n-\n-\n✔\n-\n-\n0.0%\n\n\nii 1g q4h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✘\n+\n-\n93.0%\n✘\n+\n-\n✔\n-\n-\n47.0%\n\n\nci 6g q24h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n\n\nCreatinine clearance 190 mL/min\n\n\nii 1g q6h\n✔\n+\n+\n✔\n-\n-\n56.3%\n✔\n-\n-\n✔\n-\n-\n33.2%\n✔\n-\n-\n✔\n-\n-\n16.9%\n\n\nei 1g q6h\n✔\n+\n+\n✘\n+\n-\n79.1%\n✔\n+\n+\n✔\n-\n-\n54.1%\n✔\n-\n-\n✔\n-\n-\n0.0%\n\n\nci 4g q24h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✘\n-\n+\n100.0%\n✔\n-\n-\n✔\n-\n-\n0.0%\n\n\nii 1g q4h\n✔\n+\n+\n✘\n+\n-\n89.7%\n✔\n+\n+\n✔\n-\n-\n54.5%\n✔\n-\n-\n✔\n-\n-\n27.6%\n\n\nci 6g q24h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n✘\n+\n-\n✔\n-\n-\n0.0%\n\n\nei 2g q6h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n-\n-\n79.1%\n✔\n+\n+\n✔\n-\n-\n54.1%\n\n\nci 8g q24h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✔\n+\n+\n100.0%\n\n\nei 3g q6h\n✔\n+\n+\n✔\n+\n+\n100.0%\n✔\n+\n+\n✘\n+\n-\n93.8%\n✔\n+\n+\n✔\n-\n-\n68.6%\n\n\n\n\n\n\n\n\n\n\nTable 4.3 below shows creatinine clearances and dosing regimens for which there is at least one disagreement with the paper.\n\n\n\n\nTable 4.3: Table of disagreements\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMIC = 4 mg/L\n\n\nMIC = 8 mg/L\n\n\nMIC = 16 mg/L\n\n\n\n\n\nfT&gt;MIC &gt; 0.5\n\n\nfT&gt;MIC &gt; 1\n\n\nsim\n\n\nfT&gt;MIC &gt; 0.5\n\n\nfT&gt;MIC &gt; 1\n\n\nsim\n\n\nfT&gt;MIC &gt; 0.5\n\n\nfT&gt;MIC &gt; 1\n\n\nsim\n\n\n\nagreement\npaper\nsim\nagreement\npaper\nsim\nftovermic\nagreement\npaper\nsim\nagreement\npaper\nsim\nftovermic\nagreement\npaper\nsim\nagreement\npaper\nsim\nftovermic\n\n\n\n\nCreatinine clearance 130 mL/min\n\n\nii 1g q6h\n✔\n+\n+\n✘\n+\n-\n86.5%\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nii 1g q4h\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n✔\n+\n+\n✘\n+\n-\n93.0%\n✘\n+\n-\n✔\n-\n-\n47.0%\n\n\nei 1g q6h\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n✘\n+\n-\n✔\n-\n-\n36.1%\n\n\nCreatinine clearance 190 mL/min\n\n\nei 1g q6h\n✔\n+\n+\n✘\n+\n-\n79.1%\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nii 1g q4h\n✔\n+\n+\n✘\n+\n-\n89.7%\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nci 4g q24h\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n✔\n+\n+\n✘\n-\n+\n100.0%\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nei 3g q6h\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n✔\n+\n+\n✘\n+\n-\n93.8%\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nci 6g q24h\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n✘\n+\n-\n✔\n-\n-\n0.0%\n\n\nCreatinine clearance 50 mL/min\n\n\nii 0.5g q6h\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n✘\n+\n-\n✔\n-\n-\n46.0%\n\n\nei 1g q8h\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n✔\n+\n+\n✘\n+\n-\n99.6%\n\n\n\n\n\n\n\n\n\n\nAside from one dosing regimen (ci 4g q24h for a CLCR of 190 mL/minutes), disagreements between table 5 and our simulations are underestimations of the fT&gt;MIC.\nA lot of these disagreements imply differences between the fT&gt;MIC that we simulated and table 5 close to 10%.\n\nThe dosing regimens for wich there is more difference are :\n\nfor a creatinin clearance of 130 mL/min and a MIC of 4 mg/L, “ii 1g q6h” ;\nfor a creatinin clearance of 130 mL/min and a MIC of 16 mg/L, “ei1g q6h” ;\nfor a creatinin clearance of 190 mL/min and a MIC of 4 mg/L, “ei 1g q6h” ;\nfor a creatinin clearance of 190 mL/min and a MIC of 8 mg/L, “ci 4g q24h” and “ei 3g q6h” ;\nfor a creatinin clearance of 190 mL/min and a MIC of 16 mg/L, “ci 6g q24h”.\n\n\nWe seemed to underestimate fT&gt;MIC for higher creatinin clearances more than lower ones.\nNo kind of dosing regimen (continuous, extended or intermittent infusion) looked more susceptible to disagreements between our simulations and table 5.\nFor continuous infusions, we obtained fT&gt;MIC equal to 0% or close or equal to 100%. However, in table 5, for a CLCR of 190 mg/L and a MIC of 16 mg/L, we notice that for he dosing regimen “Ci 6g q24h”, the target of fT &gt; MIC &gt;= 50% is atteined but not a fT &gt; MIC of 100%. This may indicate that the article’s author didn’t perform calculate fT &gt; MIC at steady state only. Instead, they may have included the loading dose in the time interval used to calculate fT &gt; MIC.\nWe noticed that the authors simulated 7 days of treatment to create figure 2. We hypothesized that they also simulated 7 days of treatment and calculated fT &gt; MIC on all the simulation duration in order to create table 5. We then calculated fT &gt; MIC on seven days of treatment (results not shown here). This yielded results similar to the one obtained on 24 hours at steady state : we observed disagreements for the same dosing regimens, MIC and CLCR and fT &gt; MIC equals or slightly inferiors. In particular, for a CLCR of 190 mg/L and a MIC of 16 mg/L, we still obtained a fT &gt; MIC equal to 0%. We didn’t confirm our hypothesis.\nWe also calculated fT &gt; MIC on the first 24 hours of treatment. However, the fT&gt;MIC were underestimated compared to the results of the article and there were a lot more disagreements between our simulations and table 5. For a CLCR of 190 mg/L and a MIC of 16 mg/L, fT &gt; MIC was only equal to 9%.",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Validation PKpop Amox Carlier 2013</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html#figure-2",
    "href": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html#figure-2",
    "title": "1  Validation PKpop Amox Carlier 2013",
    "section": "4.3 Figure 2",
    "text": "4.3 Figure 2\nWhile it would seem that Figure 2 could also be used for validation of our model implementation, careful consideration of the plot makes us suspect that technical errors happened while preparing the figure. Therefore, no attempt at reproducing the figure will be made.\n\n\n\n\n\n\n\n\nFigure 4.2: Article figure 2a\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 4.3: Zoom on a strange section of figure 2a",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Validation PKpop Amox Carlier 2013</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html#conclusion",
    "href": "Model_implementation_validation/quarto/valid_amox_carlier_2013.html#conclusion",
    "title": "1  Validation PKpop Amox Carlier 2013",
    "section": "4.4 Conclusion",
    "text": "4.4 Conclusion\nWe think our mrgsolve model is an adequate representation of the published model since :\n\nThe equations and parameters values of our mrgsolve model are identical to the reported ones\nMost fT&gt;MIC were accurately reproduced\n\nThe slight discrepencies could be due to different simulation settings (e.g. different time points) and/or missing correlations between variability parameters which were not reported.\n\n\n\n\nCarlier, Mieke, Michaël Noë, Jan J De Waele, Veronique Stove, Alain G Verstraete, Jeffrey Lipman, and Jason A Roberts. 2013. “Population Pharmacokinetics and Dosing Simulations of Amoxicillin/Clavulanic Acid in Critically Ill Patients.” J. Antimicrob. Chemother. 68 (11): 2600–2608.",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Validation PKpop Amox Carlier 2013</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_fournier_2018.html",
    "href": "Model_implementation_validation/quarto/valid_amox_fournier_2018.html",
    "title": "2  Validation PKpop Amox Fournier 2018",
    "section": "",
    "text": "3 Paper\nFournier et al. (2018)",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Validation PKpop Amox Fournier 2018</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_fournier_2018.html#model-parameters",
    "href": "Model_implementation_validation/quarto/valid_amox_fournier_2018.html#model-parameters",
    "title": "2  Validation PKpop Amox Fournier 2018",
    "section": "4.1 Model parameters",
    "text": "4.1 Model parameters\n\n\n\n\nTable 4.2: Model parameters\n\n\n\n\n\n\n\n\n\n\n\n\n\nparameter_name\nparameter_description\nunit\nmean\nrse\n\n\n\n\nCLpop\nTypical clearance\nL/h\n13.6000\n0.08\n\n\ntheta_CRCL_CL\nCovariate effect of creatinine clearance on amoxicillin clearance\nunitless\n0.0057\n0.25\n\n\nVcpop\nTypical central volume of distribution\nL\n9.7300\n0.20\n\n\nQ\nIntercompartimental clearance\nL/h\n20.1000\n0.24\n\n\nVp\nPeripheral volume of distribution\nL\n17.6000\n0.14\n\n\nfup\nPlasma unbound fraction\nunitless\n0.8200\nNA\n\n\ncv_iiv_CL\nCoefficient of variation of the inter individual variability on cleara\nunitless\n0.3730\n0.19\n\n\nruv_prop\nProportional residual variability\nunitless\n0.3700\n0.19\n\n\nruv_add\nAdditive residual variability\nmg/L\n0.0800\n0.10\n\n\n\nNote: atheta_CLCR_CL was wrongly reported as 0.57 in the publication, email exchanges with the authors confirmed that the actual value was 0.0057",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Validation PKpop Amox Fournier 2018</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_fournier_2018.html#inter-individual-variability-and-covariate-effects",
    "href": "Model_implementation_validation/quarto/valid_amox_fournier_2018.html#inter-individual-variability-and-covariate-effects",
    "title": "2  Validation PKpop Amox Fournier 2018",
    "section": "4.2 Inter-individual variability and covariate effects",
    "text": "4.2 Inter-individual variability and covariate effects\n\\[\nCL_{i} = CL_{pop} \\times [1 + (\\theta_{CLCR-CL} \\times (CLCR_{i} - 110))] \\times e^{\\eta_{i}}\n\\]\nWith :\n\n\\(CL_{i}\\) : Amoxicillin clearance for individual i\n\\(CLCR_i\\) : Creatinine clearance for individual i\n\\(\\eta_{i}\\) : Normal variable with mean 0 and variance \\(\\omega^2_{CL}\\)\nOther parameters defined in Table 5.2\n\nCentral volume of distribution is allometrically scaled to body weight : \\[\nV1_{i} = V1_{pop} \\times \\frac{BW}{70}\n\\] With :\n\n\\(V1_{i}\\) : Central volume of distribution for individual i\n\\(BW\\) : Body weight of the individual i in kilograms",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Validation PKpop Amox Fournier 2018</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_fournier_2018.html#preliminary-testing",
    "href": "Model_implementation_validation/quarto/valid_amox_fournier_2018.html#preliminary-testing",
    "title": "2  Validation PKpop Amox Fournier 2018",
    "section": "5.1 Preliminary testing",
    "text": "5.1 Preliminary testing\nFirst we check that simulations for a single dosing regimen and creatinine clearance value make sense.\n\n\n\n\n\n\n\n\n\n\n\n\nMIC\nmean_ft_over_mic\nsd_ft_over_mic\nmedian_ft_over_mic\nPTA_0.5\n\n\n\n\n1\n0.9862974\n0.0561477\n1\n1\n\n\n\n\n\nProfiles seem to make sense, the implementation looks ok so far.",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Validation PKpop Amox Fournier 2018</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_fournier_2018.html#reproduction-of-figure-4",
    "href": "Model_implementation_validation/quarto/valid_amox_fournier_2018.html#reproduction-of-figure-4",
    "title": "2  Validation PKpop Amox Fournier 2018",
    "section": "5.2 Reproduction of Figure 4",
    "text": "5.2 Reproduction of Figure 4\nThe figure represents the probability of target attainment for a population of 500 virtual patients of various weight and creatinine clearance, receiving various dosing regimens of amoxicillin. These dosing regimens are represented in the following table :\n\n\n\n\nTable 5.1: Simulated dosing regimen\n\n\n\n\n\n\n\n\n\n\n\n\nDose (mg)\nInfusion duration (h)\nInterdose interval (h)\nDosing regimen\n\n\n\n\n2000\n0.5\n4\n2g q4h\n\n\n2000\n2.0\n6\n2g q6h IT = 2h\n\n\n2000\n2.0\n4\n2g q4h IT = 2h\n\n\n2000\n0.5\n8\n2g q8h\n\n\n1000\n0.5\n4\n1g q4h\n\n\n1000\n2.0\n4\n1g q4h IT = 2h\n\n\n1000\n0.5\n6\n1g q6h\n\n\n1000\n0.5\n8\n1g q8h\n\n\n1000\n0.5\n12\n1g q12h\n\n\n500\n0.5\n4\n0.5g q4h\n\n\n500\n0.5\n6\n0.5g q6h\n\n\n500\n0.5\n8\n0.5g q8h\n\n\n500\n0.5\n12\n0.5g q12h\n\n\n2000\n2.0\n8\n2g q8h IT = 2h\n\n\n1000\n2.0\n6\n1g q6h IT = 2h\n\n\n\n\n\n\n\n\nPatients weights were sampled from a lognormal distribution with mean 89 kg and standard deviation of 0.184 ln(kg).\nSimualtions were performed for 6 creatinine clearance values(15 mL/min, 30 mL/min, 60 mL/min, 100 mL/min, 150 mL/min, 200 mL/min)\nTwo different fT&gt;MIC (with unbound fraction = 0.82) were studied (50%, 100%). They were computed for a range of MICs (0.25, 0.5, 1, 2, 4, 8, 16 mg/L).\nThe PTA when the target is 100% of the time above MIC calculated between 10 and 11 simulated days of treatment are inferior to those calculated between 9 and 10 days or 11 and 12 days. In order to reproduce figure 4, PTA were calculated between the 11 an 12th days of therapy.\n\n\n\n\n\n\n\n\nFigure 5.1: Attempt at reproducing the first row of figure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.2: Original paper first row of figure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.3: Attempt at reproducing the second row of figure 4, twelve days of simulation\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.4: Original paper second row of figure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.5: Attempt at reproducing the third row of figure 4, twelve days of simulation\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.6: Original paper third row of figure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.7: Attempt at reproducing the fourth row of figure 4, twelve days of simulation\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.8: Original paper fourth row of figure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.9: Attempt at reproducing the fifth row of figure 4, twelve days of simulation\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.10: Original paper fifth row of figure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.11: Attempt at reproducing the sixth row of figure 4, twelve days of simulation\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.12: Original paper sixth row of figure 4\n\n\n\n\n\nRegarding over or under estimation of PTA in relation to MIC, compared with PTAs of the original article, no trend can be distinguished. Differences are of the order of 5%. Our simulations line up well with the published figures.\nTo facilitate comparison between our simulations and the article figure 4, results of our simulations were plotted with article data. Data from the original figure 4 of the article were digitalized. They are the dashed lines in the following figures.\n\n\n\n\n\n\n\n\nFigure 5.13: Reproduction of the first row of figure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.14: Reproduction of the 2nd row of figure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.15: Reproduction of the 3rd row of figure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.16: Reproduction of the 4th row of figure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.17: Reproduction of the 5th row of figure 4\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5.18: Reproduction of the 6th row of figure 4\n\n\n\n\n\nRegarding over or under estimation of PTA in relation to MIC, compared with PTAs of the original article, no trend can be distinguished. Differences are of the order of 5%. Our simulations line up well with the published figures.",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Validation PKpop Amox Fournier 2018</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_fournier_2018.html#reproduction-of-table-4",
    "href": "Model_implementation_validation/quarto/valid_amox_fournier_2018.html#reproduction-of-table-4",
    "title": "2  Validation PKpop Amox Fournier 2018",
    "section": "5.3 Reproduction of table 4",
    "text": "5.3 Reproduction of table 4\nTable 4 represents the influence of bodyweight and creatinin clearance on fT&gt;MIC means and PTAs for two targets. Four bodyweight (50, 70, 100, 150 kg) and 3 creatinin clearance were studied. Dosing regimen was 1g infused over 30 minutes every eight hours and MIC was 8 mg/L. For each condition, 500 patients were simulated.\nSimulated results are rounded to three significant digits. fT&gt;MIC and PTA were computed between the 11th and 12th day of simulation.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCRCL\nBW\n\nfT&gt;MIC, mean\n\n\nfT&gt;MIC, sd\n\n\nPTA fT&gt;MIC ≥ 50%\n\n\nPTA fT&gt;MIC ≥ 100%\n\n\n\nfT&gt;MIC, mean\nArticle fT&gt;MIC, mean\nfT&gt;MIC, SD\nArticle fT&gt;MIC, SD\nPTA fT&gt;MIC ≥ 50%\nArticle PTA fT&gt;MIC ≥ 50%\nPTA fT&gt;MIC ≥ 100%\nArticle PTA fT&gt;MIC ≥ 100%\n\n\n\n\nCRCL 30 mL/min\n\n\n30\n50\n0.630\n0.65\n0.235\n0.24\n0.662\n0.690\n0.132\n0.170\n\n\n30\n70\n0.667\n0.68\n0.236\n0.24\n0.718\n0.730\n0.178\n0.210\n\n\n30\n100\n0.701\n0.72\n0.243\n0.24\n0.750\n0.770\n0.244\n0.260\n\n\n30\n150\n0.765\n0.76\n0.237\n0.23\n0.812\n0.820\n0.338\n0.320\n\n\nCRCL 100 mL/min\n\n\n100\n50\n0.331\n0.34\n0.162\n0.18\n0.140\n0.160\n0.004\n0.008\n\n\n100\n70\n0.332\n0.36\n0.171\n0.19\n0.144\n0.190\n0.002\n0.010\n\n\n100\n100\n0.371\n0.38\n0.185\n0.20\n0.198\n0.220\n0.016\n0.020\n\n\n100\n150\n0.407\n0.42\n0.195\n0.21\n0.250\n0.270\n0.016\n0.040\n\n\nCRCL 200 mL/min\n\n\n200\n50\n0.176\n0.18\n0.095\n0.10\n0.012\n0.012\n0.000\n0.000\n\n\n200\n70\n0.190\n0.19\n0.100\n0.10\n0.024\n0.018\n0.000\n0.000\n\n\n200\n100\n0.195\n0.21\n0.087\n0.11\n0.010\n0.030\n0.000\n0.000\n\n\n200\n150\n0.213\n0.23\n0.103\n0.12\n0.018\n0.040\n0.002\n0.000\n\n\n\n\n\n\n\nWe reproduced the results very well !\n\n\n\n\nFournier, Anne, Sylvain Goutelle, Yok-Ai Que, Philippe Eggimann, Olivier Pantet, Farshid Sadeghipour, Pierre Voirol, and Chantal Csajka. 2018. “Population Pharmacokinetic Study of Amoxicillin-Treated Burn Patients Hospitalized at a Swiss Tertiary-Care Center.” Antimicrobial Agents and Chemotherapy 62 (9): e00505–18. https://doi.org/10.1128/AAC.00505-18.",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Validation PKpop Amox Fournier 2018</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_rambaud_2020.html",
    "href": "Model_implementation_validation/quarto/valid_rambaud_2020.html",
    "title": "3  Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients",
    "section": "",
    "text": "3.1 Article\nRambaud A, Gaborit BJ, Deschanvres C, Le Turnier P, Lecomte R, Asseray-Madani N, Leroy AG, Deslandes G, Dailly É, Jolliet P, Boutoille D, Bellouard R, Gregoire M; Nantes Anti-Microbial Agents PK/PD (NAMAP) study group. Development and validation of a dosing nomogram for amoxicillin in infective endocarditis. J Antimicrob Chemother. 2020 Oct 1;75(10):2941-2950. doi: 10.1093/jac/dkaa232. PMID: 32601687.",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_rambaud_2020.html#model-description",
    "href": "Model_implementation_validation/quarto/valid_rambaud_2020.html#model-description",
    "title": "3  Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients",
    "section": "3.2 Model description",
    "text": "3.2 Model description\nRoute of administration: Continuous infusion.\nPopulation size: 107 patients for model development and 53 for validation. There are no significant differences between the characteristics of the two populations.\nFree or total concentrations: Total concentrations.\nStructural model: 2 compartment model with linear elimination, inter-individual variability (IIV) on all of the parameters\nError model The original residual error model where the standard deviation of each observation modelled by a polynomial equation is weighted by process noise is approximated with a combined proportional and additive error model.\nCovariate model: Creatinine clearance (CRCL) estimated using the CKD-EPI formula on the elimination constant (\\(K_e\\))\n\\[\nK\\_{e_i} = TVKe \\cdot \\left( \\frac{CLCR_{i}}{64.92} \\right)^{\\beta} \\cdot e^{\\eta*{i}} \\\n\\]with\n\\(Ke{i}\\) : Amoxicillin elimination constant for subject i (\\(h^{-1}\\))\n\\(TVKe\\) : Typical amoxicillin elimination constant (\\(h^{-1}\\))\n\\(\\beta\\) : Typical effect of CRCL on \\(Ke_{i}\\)\n\\(\\eta_{i}\\) : individual deviation from typical value with normal distribution centered on 0\n\\(64.92\\) : population’s median creatinine clearance (\\(mL.min^{-1}\\))",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_rambaud_2020.html#conversion-from-non-parametric-to-parametric",
    "href": "Model_implementation_validation/quarto/valid_rambaud_2020.html#conversion-from-non-parametric-to-parametric",
    "title": "3  Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients",
    "section": "3.3 Conversion from non-parametric to parametric",
    "text": "3.3 Conversion from non-parametric to parametric\nThe original model is non-parametric. Inter-individual variability given in the form of mean absolute weighted deviation (MAWD) of parameters was converted to log normal inter-individual variability by \\[\n\\sigma \\approx MAWD \\cdot 1.4826\n\\] \\[\nCV = \\frac{\\sigma}{\\theta}\n\\] \\[\n\\omega^2 = ln(CV^2 + 1)\n\\]with\n\\(\\sigma\\): standard deviation\nCV : coefficient of variation\n\\(\\theta\\): typical parameter value\n\\(\\omega^2\\): variance of \\(\\eta_{i}\\)",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_rambaud_2020.html#parameters-and-mrgsolve-implementation",
    "href": "Model_implementation_validation/quarto/valid_rambaud_2020.html#parameters-and-mrgsolve-implementation",
    "title": "3  Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients",
    "section": "3.4 Parameters and mrgsolve implementation",
    "text": "3.4 Parameters and mrgsolve implementation\n\nTable 1. Model parameter values where \\(K_{12}\\) is the diffusion rate constant from the central to the peripheral compartment, \\(K_{21}\\) is the diffusion rate constant from the peripheral to the central compartment, \\(K_e\\) is the elimination constant, \\(V_1\\) is the volume of distribution of the central compartment, \\(\\beta\\) is the effect of CRCL on the elimination constant.\n\n\n\n\nParameter\n\\(\\theta\\)\n\\(\\omega^2\\)\n\n\n\n\n\\(V_1\\) (L)\n5.70\n0.0615\n\n\n\\(K_{12}\\) (\\(h^{-1}\\))\n0.247\n1.11\n\n\n\\(K_{21}\\) (\\(h^{-1}\\))\n11.43\n0.194\n\n\n\\(K_e\\) (\\(h^{-1}\\))\n1.69\n0.0367\n\n\n\\(\\beta\\)\n0.946\n0.0964\n\n\n\nA standard value of 0.05 is used for proportional residual error and 1 \\(mg.L^{-1}\\) for additive residual unexplained variability (RUV).",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_rambaud_2020.html#subject-and-observation-simulation",
    "href": "Model_implementation_validation/quarto/valid_rambaud_2020.html#subject-and-observation-simulation",
    "title": "3  Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients",
    "section": "3.5 Subject and observation simulation",
    "text": "3.5 Subject and observation simulation\n107 subjects with the characteristics of the model development dataset are simulated. 4 steady-state concentrations are simulated for each subject with the time grid of 72, 96, 120, and 144 h.",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_rambaud_2020.html#covariate-simulation",
    "href": "Model_implementation_validation/quarto/valid_rambaud_2020.html#covariate-simulation",
    "title": "3  Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients",
    "section": "3.6 Covariate simulation",
    "text": "3.6 Covariate simulation\nCreatinine clearance was simulated with a log-normal distribution using the median (80 \\(mL.min^{-1}\\)) and interquantile range (52.6 - 106). As the obtained distribution is too narrow compared to the minimum and maximum values read from the figures (\\(\\approx\\) 10 and 160) a small proportion of extra values are simulated in the ranges 10-30 and 140-160. The simulations are iterated until the desired interquantile range is obtained with a maximum difference of 2.",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_rambaud_2020.html#dose-simulation",
    "href": "Model_implementation_validation/quarto/valid_rambaud_2020.html#dose-simulation",
    "title": "3  Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients",
    "section": "3.7 Dose simulation",
    "text": "3.7 Dose simulation\nDoses are simulated with a normal distribution between 2000 mg and 20000 mg with a median of 12000 mg. The doses are rounded to the nearest 500 mg.\n\n\n\n\n\n\n\n\n\nThe events table is generated with adding the times, CMT and EVID",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_rambaud_2020.html#model-validation-by-figure-reproduction",
    "href": "Model_implementation_validation/quarto/valid_rambaud_2020.html#model-validation-by-figure-reproduction",
    "title": "3  Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients",
    "section": "3.8 Model validation by figure reproduction",
    "text": "3.8 Model validation by figure reproduction\nIn the article there are three figures representing the results of the PopPK analysis. The goodness of fit plots of observed concentrations as a function of PRED or IPRED are less relevant to be reproduced without the observed values. There is not enough information concerning RUV to reproduce the plots with weighted residual errors. Figure 4 is selected to reproduce which represents VPCs of amoxicillin concentrations against aGFR (CRCL). To reproduce the figure, the previsously described 4 concentrations per subject are simulated and plotted agains the respective CRCL values. The data is binned (using 4 bins) as on the original figure. The 5th, 50th and 95th percentiles are calculated.\n\n\n\n\n\nFigure 4 - reproduced. Open circles are observed amoxicillin concentrations at steady-state. Solid lines represent the 5th, 50th and 95th percentiles for simulated concentrations.\n\n\n\n\n\n\n\n\n\nFigure 4 - original. Open circles are observed amoxicillin concentrations at steady-state. Solid lines represent the 5th, 50th and 95th percentiles for observed concentrations. Dashed lines represent the 5th, 50th and 95th percentiles for simulated concentrations.",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_rambaud_2020.html#checking-parameter-distributions",
    "href": "Model_implementation_validation/quarto/valid_rambaud_2020.html#checking-parameter-distributions",
    "title": "3  Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients",
    "section": "3.9 Checking parameter distributions",
    "text": "3.9 Checking parameter distributions\nSince we relied on approximations to convert the MAWD to log-normal standard deviations, we will check whether the MAWD computed from simulated parameter distributions are close to the ones reported in the paper\n\n\n\n\n\nname\nSimulated MAWD\nPublised MAWD\nRelative difference\n\n\n\n\nK12\n0.1524385\n0.237\n35.7 %\n\n\nK21\n3.1753618\n3.570\n11.1 %\n\n\nCCRCL\n0.1947902\n0.203\n4 %\n\n\nKE1\n0.2197522\n0.220\n0.1 %\n\n\nVc\n0.9723197\n0.968\n-0.4 %\n\n\n\n\n\nThe relative difference is below 10% for all parameters but K12 (KCP in the paper). This is not of concern because K12 and K21 are not of importance in this specific case.\nIndeed when we compute the peripheral volume of this bi-compartmental model we realize that it is negligible when compared with the central compartment volume. \\[\nVp = K12/K21 \\times Vc = 0.247 / 11.427 \\times 5.698 = 0.123 L \\]\nThus having a bad representation of transfer to (and from) the peripheral compartment will not cause any problems.\nIt is worthwhile to note that the data used in the paper only includes concentrations measured after continuous infusions of amoxicillin. In this case, the PK parameters describing peripheral distribution are not identifiable which explains the very low \\(Vp\\) value.",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Validation of mrgsolve implementation of Rambaud amoxicillin PopPK model developed on a population of endocarditis patients</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_mellon_hammas_2020.html",
    "href": "Model_implementation_validation/quarto/valid_amox_mellon_hammas_2020.html",
    "title": "4  Validation PKpop Amox Mellon 2020",
    "section": "",
    "text": "5 Paper\nMellon et al. (2020)\nTable 5.1: Model description\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDOI\nstructural_model\nvariability_model\ncovariate_effects\npatients_number\nfree_or_total_concentrations\nunbound fraction\n\n\n\n\ndoi:10.1093/jac/dkaa368\n2-comp\ninterindividual variability for all parameters, log-distribution for all parameters except F\nweight on absorption rate\n27\ntotal\n0.8",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Validation PKpop Amox Mellon 2020</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_mellon_hammas_2020.html#model-parameters",
    "href": "Model_implementation_validation/quarto/valid_amox_mellon_hammas_2020.html#model-parameters",
    "title": "4  Validation PKpop Amox Mellon 2020",
    "section": "5.1 Model parameters",
    "text": "5.1 Model parameters\n\n\n\n\nTable 5.2: Model parameters\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDOI\nparameter_name\nparameter_description\nunit\nmean\nrse\n\n\n\n\n10.1093/jac/dkaa368\nFpop\nTypical oral bioavailability\nunitless\n0.797\n5\n\n\n10.1093/jac/dkaa369\nMtt_pop\nTypical mean transit time\nh\n1.000\n6\n\n\n10.1093/jac/dkaa370\nKtr_pop\nTypical transit rate\nh-1\n1.600\n11\n\n\n10.1093/jac/dkaa371\nKa_pop\nTypical absorption rate constant\nh-1\n1.700\n10\n\n\n10.1093/jac/dkaa372\nbeta_weight\nRelation between weight and absorption rate constant\nlog h-1\n-3.100\n19\n\n\n10.1093/jac/dkaa373\nCLpop\nTypical clearance\nL/h\n14.600\n5\n\n\n10.1093/jac/dkaa374\nVcpop\nTypical central volume of distribution\nL\n9.000\n11\n\n\n10.1093/jac/dkaa375\nQpop\nTypical intercompartimental clearance\nL/h\n4.200\n12\n\n\n10.1093/jac/dkaa376\nVppop\nTypical peripheral volume of distribution\nL\n6.400\n8\n\n\n10.1093/jac/dkaa377\nomega_F\nStandard deviation of F random effect\nunitless\n1.000\n20\n\n\n10.1093/jac/dkaa378\nomega_Mtt\nStandard deviation of Mtt random effect\nunitless\n0.250\n19\n\n\n10.1093/jac/dkaa379\nomega_Ktr\nStandard deviation of Ktr random effect\nunitless\n0.490\n17\n\n\n10.1093/jac/dkaa380\nomega_Ka\nStandard deviation of Ka random effect\nunitless\n0.250\n40\n\n\n10.1093/jac/dkaa381\nomega_V1\nStandard deviation of V1 random effect\nunitless\n0.500\n17\n\n\n10.1093/jac/dkaa382\nomega_CL\nStandard deviation of CL random effect\nunitless\n0.270\n16\n\n\n10.1093/jac/dkaa383\nomega_V2\nStandard deviation of V2 random effect\nunitless\n0.300\n23\n\n\n10.1093/jac/dkaa384\nomega_Q\nStandard deviation of Q random effect\nunitless\n0.590\n15\n\n\n10.1093/jac/dkaa385\ncorrelation\nCorrelation between random effects of CL and Q\nunitless\n0.900\n7\n\n\n10.1093/jac/dkaa386\nSD_a\nStandard deviation of the additive component for the residual error model\nmg/L\n0.383\n15\n\n\n10.1093/jac/dkaa387\nSD_b\nStandard deviation of the proportional component for the residual error model\nmg/L\n0.131\n7\n\n\n\n\n\n\n\n\nGiven both the concentration’s values and the values of standard deviations of the additive and proportional components of the residual error model for the basic model, we choose to divide by 100 the component’s values announced for the final model with covariates.",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Validation PKpop Amox Mellon 2020</span>"
    ]
  },
  {
    "objectID": "Model_implementation_validation/quarto/valid_amox_mellon_hammas_2020.html#interindividual-variability-and-covariate-effects",
    "href": "Model_implementation_validation/quarto/valid_amox_mellon_hammas_2020.html#interindividual-variability-and-covariate-effects",
    "title": "4  Validation PKpop Amox Mellon 2020",
    "section": "5.2 Interindividual variability and covariate effects",
    "text": "5.2 Interindividual variability and covariate effects\nThe only covariate retained by the article’s authors is weight.\n\\[\nKa_{i} = Ka_{pop} \\times (BW/109.3)^{beta_{weight}} \\times exp(\\eta^{Ka})\n\\]\nWith :\n\n\\(Ka_{i}\\) : absorption rate for individual i (\\(h^{-1}\\))\n\\(BW\\) : bodyweight of the individual i (kg)\n\\(\\eta_{Ka}\\) : normal variable with mean 0 and variance \\({\\omega_{Ka}}^2\\)\n\nOther parameters defined in Table 5.2.\nAccording to the article, all model parameters are log-normally distributed, except F wich is logit transformed :\n\\[\nF = log(F_{pop}/(1-F_{pop})) + \\eta^F\n\\] With :\n\n\\(EF\\) : normal variable with mean 0 and variance \\({\\omega_{F}}^2\\)",
    "crumbs": [
      "Validation of implementation from articles",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Validation PKpop Amox Mellon 2020</span>"
    ]
  },
  {
    "objectID": "Simulations/covariate_simulation.html",
    "href": "Simulations/covariate_simulation.html",
    "title": "5  Covariate simulation",
    "section": "",
    "text": "5.1 Objective\nShow the code\nn_patient &lt;- 625 # number of patients simulated per cohort\nShow the code\nhere::i_am(\"Simulations/covariate_simulation.qmd\")\n\n# Create folder to store published figures\nif (!dir.exists(here(\"Figures\"))) {\n  dir.create(here(\"Figures\"))\n}\n\ncov_data &lt;- read_csv(here(\"Simulations/cov_distrib_from_papers.csv\"))\nFrom each identified paper, we want to simulate a cohort of patients. For each cohort we want to simulate 625 patients. We define a patient by a vector of covariate values. The covariates of interest are :\nTo simulate covariate values we use information on the distribution of the covariates taken from the included papers.\nWe included 4 papers :\nOne issue with the covariate data reported in these papers is that correlations between covariates are not reported and simulating without correlations runs the risk of simulating improbable covariate values. We thus obtained a clinical dataset composed of more than 16000 ICU patients (Johnson et al. (2023)) from which we could derive correlations between covariates of interest. Age, serum creatinine, body weight, sex, height and BMI were obtained for these patients and the creatinine clearance was calculated (in mL/min for Cockroft and Gault and CKD-EPI and in mL/min/1.73 m2 for MDRD (to correspond to Mellon)). A correlation matrix was calculated for each of the respective model development cohorts separately for females and males.\nThis correlation matrix is used to simulate correlations between the simulated WT, CRCL, AGE, and HT/BMI if necessary to convert CRCL to serum creatinine. (CRCL_MDRD_norm means CRCL in mL/min/1.73 m² used for Mellon and CRCL_MDRD in mL/min.). Different correlation matrices are used based on sex. This way two different mutltivariate distributions are simulated based on the two matrices with a number of patients that respects the original article proportions.\nWe can find correlations for the log-transforms of certain variables. For the covariates where a log-normal distribution fits better the log mean and standard deviation of this distribution will be used to sample log values with a multivariate normal distribution. At the end, the log variables will be retransformed to normal ones.",
    "crumbs": [
      "Simulations",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Covariate simulation</span>"
    ]
  },
  {
    "objectID": "Simulations/covariate_simulation.html#objective",
    "href": "Simulations/covariate_simulation.html#objective",
    "title": "5  Covariate simulation",
    "section": "",
    "text": "WT : Body weight (kg)\nCRCL : Creatinine clearance (mL/min)\nICU : Is the patient an ICU patient (=1) or not (=0)\nBURN : Is the patient a burn patient (=1) or not (=0)\nOBESE : Is the patient a obese - BMI &gt; 30 kg/m^2 (=1) or not (=0)\nSEX : Male (=0) or female (=1)\nHT : height (cm)\nAGE : age (years)\n\n\n\n\nCarlier et al. (2013)\nFournier et al. (2018)\nMellon et al. (2020)\nRambaud et al. (2020)",
    "crumbs": [
      "Simulations",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Covariate simulation</span>"
    ]
  },
  {
    "objectID": "Simulations/covariate_simulation.html#carlier2013-bq",
    "href": "Simulations/covariate_simulation.html#carlier2013-bq",
    "title": "5  Covariate simulation",
    "section": "5.2 Carlier et al. (2013)",
    "text": "5.2 Carlier et al. (2013)\n\n5.2.1 Covariate distribution\nAll patients are ICU patients and we will assume that they are not burn and not obese patients. Creatinine clearance was obtained using the measured urinary equation. Thus for all patients ICU = 1, BURN = 0.\nAs discussed in the article, renal replacement therapy is an exclusion criterion, therefore the minimum value of creatinine clearance is set to 10 mL/min, any simulated value below 10 mL/min will be resampled. CRCL was calculated using the measured urinary equation.\nFor WT and CRCL here are the data from the paper :\n\n\nShow the code\ncov_data_carlier &lt;- cov_data |&gt; \n  filter(Paper == \"Carlier_2013\")\n\ncov_data_carlier |&gt; \n  filter(Covariate %in% c(\"WT\",\"CRCL\",\"AGE\",\"BMI\")) |&gt; \n  kable()\n\n\n\n\n\nPaper\nCovariate\nUnit\nMedian\nQ1\nQ3\nMin\nMax\n\n\n\n\nCarlier_2013\nWT\nkg\n75\n70\n79\nNA\nNA\n\n\nCarlier_2013\nCRCL\nmL/min\n102\n50\n157\n10\nNA\n\n\nCarlier_2013\nBMI\nkg/m^{2}\n24\n21\n25\nNA\nNA\n\n\nCarlier_2013\nAGE\nyear\n62\n58\n72\nNA\nNA\n\n\n\n\n\n\n\nShow the code\ncor_matrix_Carlier_F &lt;- readRDS(here(\"Simulations/cor_matrix_Carlier_F.rds\"))\nprint(cor_matrix_Carlier_F)\n\n\n                    CREAT   CREAT_log         AGE          WT      WT_log\nCREAT          1.00000000  0.93719806  0.17043554  0.07114115  0.07024583\nCREAT_log      0.93719806  1.00000000  0.22904749  0.09016458  0.09019928\nAGE            0.17043554  0.22904749  1.00000000 -0.11058359 -0.10874794\nWT             0.07114115  0.09016458 -0.11058359  1.00000000  0.99663272\nWT_log         0.07024583  0.09019928 -0.10874794  0.99663272  1.00000000\nHT            -0.02615290 -0.03452481 -0.22145176  0.36158540  0.35423946\nHT_log        -0.02656759 -0.03481661 -0.22200991  0.36341580  0.35641748\nBMI            0.09120381  0.11653457  0.01416104  0.83213862  0.83590568\nBMI_log        0.08905860  0.11477057  0.01748252  0.82644900  0.83409794\nCRCL_MDRD     -0.73311938 -0.90200963 -0.35625197  0.05193539  0.05083450\nCRCL_MDRD_log -0.91894029 -0.98323371 -0.33894619  0.05521443  0.05501799\n                       HT      HT_log         BMI     BMI_log   CRCL_MDRD\nCREAT         -0.02615290 -0.02656759  0.09120381  0.08905860 -0.73311938\nCREAT_log     -0.03452481 -0.03481661  0.11653457  0.11477057 -0.90200963\nAGE           -0.22145176 -0.22200991  0.01416104  0.01748252 -0.35625197\nWT             0.36158540  0.36341580  0.83213862  0.82644900  0.05193539\nWT_log         0.35423946  0.35641748  0.83590568  0.83409794  0.05083450\nHT             1.00000000  0.99908709 -0.21054270 -0.21983890  0.15405745\nHT_log         0.99908709  1.00000000 -0.20907388 -0.21810288  0.15428482\nBMI           -0.21054270 -0.20907388  1.00000000  0.99655760 -0.03784624\nBMI_log       -0.21983890 -0.21810288  0.99655760  1.00000000 -0.03799028\nCRCL_MDRD      0.15405745  0.15428482 -0.03784624 -0.03799028  1.00000000\nCRCL_MDRD_log  0.14873339  0.14934183 -0.03146339 -0.03070224  0.92275219\n              CRCL_MDRD_log\nCREAT           -0.91894029\nCREAT_log       -0.98323371\nAGE             -0.33894619\nWT               0.05521443\nWT_log           0.05501799\nHT               0.14873339\nHT_log           0.14934183\nBMI             -0.03146339\nBMI_log         -0.03070224\nCRCL_MDRD        0.92275219\nCRCL_MDRD_log    1.00000000\n\n\nShow the code\nggcorrplot(cor_matrix_Carlier_F, lab = TRUE, title = \"Sex: female\")\n\n\n\n\n\n\n\n\n\nShow the code\ncor_matrix_Carlier_M &lt;- readRDS(here(\"Simulations/cor_matrix_Carlier_M.rds\"))\nprint(cor_matrix_Carlier_M)\n\n\n                    CREAT   CREAT_log          AGE          WT      WT_log\nCREAT          1.00000000  0.93656904  0.129584751  0.03477888  0.03489511\nCREAT_log      0.93656904  1.00000000  0.191015858  0.06256888  0.06255796\nAGE            0.12958475  0.19101586  1.000000000 -0.05978080 -0.05792048\nWT             0.03477888  0.06256888 -0.059780801  1.00000000  0.99691085\nWT_log         0.03489511  0.06255796 -0.057920475  0.99691085  1.00000000\nHT            -0.01562634 -0.02015099 -0.099371429  0.33471772  0.33277207\nHT_log        -0.01514335 -0.01943840 -0.098654543  0.33778296  0.33606644\nBMI            0.04448518  0.07478234  0.002442579  0.78722872  0.78753911\nBMI_log        0.04503665  0.07581809  0.004260007  0.79489820  0.79912510\nCRCL_MDRD     -0.73662552 -0.90639303 -0.327115476  0.04508957  0.04511819\nCRCL_MDRD_log -0.92158994 -0.98613183 -0.287263519  0.06492902  0.06504475\n                       HT      HT_log          BMI      BMI_log   CRCL_MDRD\nCREAT         -0.01562634 -0.01514335  0.044485175  0.045036646 -0.73662552\nCREAT_log     -0.02015099 -0.01943840  0.074782343  0.075818092 -0.90639303\nAGE           -0.09937143 -0.09865454  0.002442579  0.004260007 -0.32711548\nWT             0.33471772  0.33778296  0.787228725  0.794898201  0.04508957\nWT_log         0.33277207  0.33606644  0.787539107  0.799125098  0.04511819\nHT             1.00000000  0.99918214 -0.312182156 -0.300458114  0.12810278\nHT_log         0.99918214  1.00000000 -0.309805459 -0.297640862  0.12729396\nBMI           -0.31218216 -0.30980546  1.000000000  0.996020588 -0.03549251\nBMI_log       -0.30045811 -0.29764086  0.996020588  1.000000000 -0.03551703\nCRCL_MDRD      0.12810278  0.12729396 -0.035492514 -0.035517032  1.00000000\nCRCL_MDRD_log  0.11829734  0.11791657 -0.010057809 -0.009333342  0.92462410\n              CRCL_MDRD_log\nCREAT          -0.921589942\nCREAT_log      -0.986131825\nAGE            -0.287263519\nWT              0.064929019\nWT_log          0.065044752\nHT              0.118297341\nHT_log          0.117916569\nBMI            -0.010057809\nBMI_log        -0.009333342\nCRCL_MDRD       0.924624105\nCRCL_MDRD_log   1.000000000\n\n\nShow the code\nggcorrplot(cor_matrix_Carlier_M, lab = TRUE, title = \"Sex: male\")\n\n\n\n\n\n\n\n\n\nWe are going to fit normal and log-normal distributions to the observed quantiles and select the best fitting one\n\n\nShow the code\ncompute_cv_from_sd_lnorm &lt;- function(sdlog){\n  #' Compute the geometric coefficient of variation from the standard deviation of a lognormal distribution\n  #'\n  #' @param sdlog numeric. standard deviation of the log transformed variable\n  #' \n  #' @return numeric. geometric coefficient of variation\n  sqrt(exp(sdlog^2)-1)\n}\n\nextract_cov_param &lt;- function(cov_data, cov_name) {\n  \n  #' Get covariate quantiles from covariate characteristics table\n  #'\n  #' @param cov_data tibble containing the covariate information\n  #' @param cov_name character. name of the covariate to select, comes from the Covariate column of cov_data.\n  #' @return list with :\n  #'  - p : numeric vector of probabilities\n  #'  - q : numeric vector of quantiles\n  #'  - cov_name : character string containing the covariate name\n  #'  - cov_unit : character string containing the unit of the covariate\n  \n  \n  cov_filtered_df &lt;- cov_data |&gt;\n    filter(Covariate == cov_name) |&gt;\n    pivot_longer(\n      cols = c(Median, Q1, Q3, Min, Max), # if the format of the csv columns ever changes, this will need to change\n      names_to = \"p\",\n      values_to = \"q\"\n    ) |&gt;\n    mutate(p = case_match(p, \"Median\" ~ 0.5, \"Q1\" ~ 0.25, \"Q3\" ~ 0.75, \"Min\" ~ 0.01, \"Max\" ~ 0.99)) |&gt;\n    # if the format of the csv columns ever changes, the code above will need to change\n    filter(!is.na(q)) |&gt;\n    group_by(Paper) |&gt;\n    arrange(p, .by_group = TRUE) |&gt;\n    ungroup()\n  \n  list(\n    p = cov_filtered_df$p,\n    q = cov_filtered_df$q,\n    cov_name = unique(cov_filtered_df$Covariate),\n    cov_unit = unique(cov_filtered_df$Unit)\n  )\n  \n  \n}\n\nevaluate_distrib &lt;- function(p, q, cov_name, cov_unit, min_plot, max_plot,tol = 0.001) {\n  #' Fit normal and lognormal distribution to observed quantiles\n  #' @param p numeric vector of probabilities\n  #' @param q numeric vector of quantiles\n  #' @param cov_name character string containing the covariate name\n  #' @param cov_unit character string containing the unit of the covariate\n  #' @param min_plot minimal value of the covariate for which the distribution should be plotted\n  #' @param max_plot maximal value of the covariate for which the distribution should be plotted\n  #' @param tol numeric. tolerance value for the fitting algorithm, default is 0.001\n  #' @return list with :\n  #'  - plot : ggplot2 showing the fitted distributions and the observed covariate\n  #'  - lnorm_par : named numeric vector with the lognormal distribution parameters\n  #'  - norm_par : named numeric vector with the normal distribution parameters\n  \n  \n  lnorm_par &lt;- get.lnorm.par(p = p, q = q, plot = FALSE, show.output = FALSE,tol = tol)\n  norm_par &lt;- get.norm.par(p = p, q = q, plot = FALSE, show.output = FALSE,tol=tol)\n  \n  #create a dataset with the true percentiles to be able to show them on the plot\n  true_percentiles &lt;- tibble(p, q) |&gt; \n    mutate(label = case_match(p, \n                              0 ~ \"True min\",\n                              0.25 ~ \"True Q1\",\n                              0.5 ~ \"True median\",\n                              0.75 ~ \"True Q3\",\n                              1 ~ \"True max\")) \n  \n  #create a dataset with the percentiles of the fitted distributiosn to be able to show them on the plot\n  distrib_percentiles &lt;-  tibble(\n    probability = p,\n    lnorm = qlnorm(probability, meanlog = lnorm_par[\"meanlog\"], sdlog =\n                     lnorm_par[\"sdlog\"]),\n    norm = qnorm(probability, mean = norm_par[\"mean\"], sd = norm_par[\"sd\"])\n  ) |&gt;\n    pivot_longer(cols = c(lnorm, norm), names_to = \"distrib\") |&gt;\n    mutate(density = case_match(\n      distrib,\n      \"norm\" ~ dnorm(value, mean = norm_par[\"mean\"], sd =\n                       norm_par[\"sd\"]),\n      \"lnorm\" ~ dlnorm(value, meanlog = lnorm_par[\"meanlog\"], sdlog =\n                         lnorm_par[\"sdlog\"])\n    )) |&gt; \n    mutate(label = case_match(probability, \n                              0 ~ \"Min\",\n                              0.25 ~ \"Q1\",\n                              0.5 ~ \"Median\",\n                              0.75 ~ \"Q3\",\n                              1 ~ \"Max\")) \n  \n  \n  #simulate 1000 datapoints from the fitted distributions to show on the plot\n  param_data &lt;- tibble(\n    variable = seq(min_plot, max_plot, length.out = 1000),\n    lnorm = dlnorm(variable, meanlog = lnorm_par[\"meanlog\"], sdlog = lnorm_par[\"sdlog\"]),\n    norm = dnorm(variable, mean = norm_par[\"mean\"], sd = norm_par[\"sd\"])\n  ) |&gt;\n    pivot_longer(cols = c(lnorm, norm), names_to = \"distrib\")\n  \n  \n  plot &lt;- ggplot(param_data, aes(x = variable, y = value, color = distrib)) +\n    geom_vline(data = true_percentiles, mapping = aes(xintercept = q),lty = \"dashed\") +\n    geom_line() +\n    geom_segment(data = distrib_percentiles, aes(x = value, y = 0, yend =\n                                                   density)) +\n    theme_bw() +\n    scale_color_brewer(\"Distribution\", palette = \"Dark2\") +\n    ylab(\"Density\") +\n    xlab(paste0(cov_name, \" (\", cov_unit, \")\")) +\n    annotate(\n      geom = \"text\",\n      label = paste0(\n        \"N ~ (\",\n        signif(norm_par[\"mean\"], 3),\n        \", \",\n        signif(norm_par[\"sd\"], 3),\n        \")\\n\",\n        \"LN ~ (\",\n        signif(exp(lnorm_par[\"meanlog\"]), 3),\n        \", \",\n        signif(compute_cv_from_sd_lnorm(lnorm_par[\"sdlog\"]), 3) * 100,\n        \" %)\"\n      ),\n      x = min(param_data$variable) + 0.99 * diff(range(param_data$variable)),\n      y = min(param_data$value) + 0.99 * diff(range(param_data$value)),\n      hjust = 1,\n      vjust = 1\n    )+\n    geom_text(\n      data = true_percentiles,\n      mapping = aes(x = q,label = label,color=NULL),\n      show.legend = FALSE,\n      y = min(param_data$value) + 0.95 * diff(range(param_data$value)),\n      hjust = 1,\n      vjust = -1,\n      angle = 90\n    )+\n    geom_text(\n      data = distrib_percentiles,\n      mapping = aes(x = value, y=density,label = label),\n      show.legend = FALSE,\n      hjust = 1,\n      vjust = -1,\n      angle = 90\n    )\n  \n  list(plot = plot,\n       lnorm_par = lnorm_par,\n       norm_par = norm_par)\n  \n}\n\nfit_cov_wrapper &lt;- function(cov_data, cov_name, min_plot, max_plot, tol = 0.001) {\n  \n  #' Wrapper to get covariate quantiles from covariate characteristics table and fit normal and lognormal distribution\n  #' to observed quantiles \n  #'\n  #' @param cov_data tibble containing the covariate information\n  #' @param cov_name character. name of the covariate to select, comes from the Covariate column of cov_data.\n  #' @param min_plot minimal value of the covariate for which the distribution should be plotted\n  #' @param max_plot maximal value of the covariate for which the distribution should be plotted\n  #' @param tol numeric. tolerance value for the fitting algorithm, default is 0.001\n  #' @return list with :\n  #'  - plot : ggplot2 showing the fitted distributions and the observed covariate\n  #'  - lnorm_par : named numeric vector with the lognormal distribution parameters\n  #'  - norm_par : named numeric vector with the normal distribution parameters\n  \n  \n  cov_df &lt;- extract_cov_param(cov_data, cov_name)\n  \n  evaluate_distrib(\n    p = cov_df$p,\n    q = cov_df$q,\n    min_plot = min_plot,\n    max_plot = max_plot,\n    cov_name = cov_df$cov_name,\n    cov_unit = cov_df$cov_unit,\n    tol = tol\n  )\n  \n}\n\n\n\n\nShow the code\ncarlier_crcl &lt;- fit_cov_wrapper(\n  cov_data = cov_data_carlier,\n  cov_name = \"CRCL\",\n  min_plot = 0,\n  max_plot = 250\n)\n\ncarlier_crcl$plot\n\n\n\n\n\n\n\n\n\nNormal distribution seems better than log-normal.\n\n\nShow the code\ncarlier_wt &lt;- fit_cov_wrapper(\n  cov_data = cov_data_carlier,\n  cov_name = \"WT\",\n  min_plot = 40,\n  max_plot = 120\n)\n\ncarlier_wt$plot\n\n\n\n\n\n\n\n\n\nNo discernable difference in fit. We have to use the log-normal distribution to be able to calculate height.\n\n\nShow the code\ncarlier_age &lt;- fit_cov_wrapper(\n  cov_data = cov_data_carlier,\n  cov_name = \"AGE\",\n  min_plot = 0,\n  max_plot = 120\n)\n\ncarlier_age$plot\n\n\n\n\n\n\n\n\n\nNo discernible difference in fit. We will use the normal distribution as generally, age is normally distributed.\n\n\nShow the code\ncarlier_bmi &lt;- fit_cov_wrapper(\n  cov_data = cov_data_carlier,\n  cov_name = \"BMI\",\n  min_plot = 0,\n  max_plot = 40,\n  tol=0.002\n)\n\ncarlier_bmi$plot\n\n\n\n\n\n\n\n\n\nTolerance was increased to 0.002. No discernible difference in fit. We have to use the log-normal distribution to be able to obtain height.\n\n\n5.2.2 Simulation of covariates\nCovariates will be sampled from the following distributions :\n\nCRCL : Normal distribution with a minimum of 10 mL/min, with mean 105 mL/min and standard deviation 68.5 mL/min\nWT : Lognormal distribution with mean 74.6 kg, and coefficient of variation 9.04 %\nAGE : Normal distribution with mean 63.7 mL/min and standard deviation 11 years and with a minimum of 18 years\nBMI : Log-normal distribution with mean 3.15 mL/min and standard deviation 0.141 kg/m^{2}\n\n\n\nShow the code\nsim_norm_without_negatives &lt;- function(n,mean,sd){\n      \n  #' Simulate values from normal distribution but resample negative values\n  #'\n  #' @param n numeric. number of samples to simulate\n  #' @param mean numeric. mean of the normal distribution\n  #' @param sd numeric. standard deviation of the normal distribtuion\n  #' @return numeric vector of n values\n  sim_values &lt;- rnorm(n,mean,sd)\n  neg_values &lt;- sim_values[sim_values&lt;=0]\n  pos_values &lt;- sim_values[sim_values&gt;0]\n\n  while(length(neg_values)&gt;0){\n    new_values &lt;- rnorm(length(neg_values),mean,sd)\n    sim_values &lt;- c(pos_values,new_values)\n    neg_values &lt;- sim_values[sim_values&lt;=0]\n    pos_values &lt;- sim_values[sim_values&gt;0]\n    }\n  sim_values\n}\n\n# Only for normal distribution when the minimum is 10 ml/min, resample below 10\nsim_norm_without_dialysis &lt;- function(n,mean,sd){\n      \n  #' Simulate values from normal distribution but resample negative values\n  #'\n  #' @param n numeric. number of samples to simulate\n  #' @param mean numeric. mean of the normal distribution\n  #' @param sd numeric. standard deviation of the normal distribtuion\n  #' @return numeric vector of n values\n  sim_values &lt;- rnorm(n,mean,sd)\n  neg_values &lt;- sim_values[sim_values&lt;=10]\n  pos_values &lt;- sim_values[sim_values&gt;10]\n\n  while(length(neg_values)&gt;0){\n    new_values &lt;- rnorm(length(neg_values),mean,sd)\n    sim_values &lt;- c(pos_values,new_values)\n    neg_values &lt;- sim_values[sim_values&lt;=10]\n    pos_values &lt;- sim_values[sim_values&gt;10]\n    }\n  sim_values\n}\n# Resimulate subjects younger than 18 years for normally distributed age\nsim_norm_without_minors &lt;- function(n,mean,sd){\n      \n  #' Simulate values from normal distribution but resample negative values\n  #'\n  #' @param n numeric. number of samples to simulate\n  #' @param mean numeric. mean of the normal distribution\n  #' @param sd numeric. standard deviation of the normal distribtuion\n  #' @return numeric vector of n values\n  sim_values &lt;- rnorm(n,mean,sd)\n  neg_values &lt;- sim_values[sim_values&lt;18]\n  pos_values &lt;- sim_values[sim_values&gt;=18]\n\n  while(length(neg_values)&gt;0){\n    new_values &lt;- rnorm(length(neg_values),mean,sd)\n    sim_values &lt;- c(pos_values,new_values)\n    neg_values &lt;- sim_values[sim_values&lt;18]\n    pos_values &lt;- sim_values[sim_values&gt;=18]\n    }\n  sim_values\n}\n\n\nThe relevant part of the correlation matrix is converted to a covariance matrix by multiplying the already calculated standard deviations of the variables with the diagonal of the correlation matrix. More information can be found at SAS and at stats. A multivariate normal distribution is fitted with resimulation of CRCL below 10 ml/min, AGE below 18 years, and other variables below 0.\nThe proportion of males is 0.85 in the original article, so the number of males is 531 and the number of females is 94 to add up to 625.\n\n\nShow the code\nmean_WT_log &lt;- as.numeric(carlier_wt$lnorm_par[\"meanlog\"])\nsd_WT_log &lt;- as.numeric(carlier_wt$lnorm_par[\"sdlog\"])\nmean_BMI_log &lt;- as.numeric(carlier_bmi$lnorm_par[\"meanlog\"])\nsd_BMI_log &lt;- as.numeric(carlier_bmi$lnorm_par[\"sdlog\"])\nr_M &lt;- 0.34 # Pearson correlation between HT_log and WT_log for males\nr_F &lt;- 0.36 # Pearson correlation for females\n\n# sd is different based on sex\nmean_HT_log = (mean_WT_log - mean_BMI_log) / 2\nsd_HT_M_log = (-r_M * sd_WT_log + sqrt(r_M^2 * sd_WT_log^2 - sd_WT_log^2 + sd_BMI_log^2))/2 # quadratic equation with positive result\nsd_HT_F_log = (-r_F * sd_WT_log + sqrt(r_F^2 * sd_WT_log^2 - sd_WT_log^2 + sd_BMI_log^2))/2 # quadratic equation with positive\n\ncorrelated_simulation &lt;- function(n, means, cov_matrix) {\n  set.seed(1991)\n  collected &lt;- matrix(NA, 0, length(means))\n  colnames(collected) &lt;- names(means)\n\n  while (nrow(collected) &lt; n) {\n    batch &lt;- MASS::mvrnorm(n = n, mu = means, Sigma = cov_matrix)\n    colnames(batch) &lt;- names(means)\n\n    valid &lt;- batch[, \"AGE\"] &gt;= 18 &\n             batch[, \"CRCL_MDRD\"] &gt;= 10\n\n    batch_valid &lt;- batch[valid, , drop = FALSE]\n    collected &lt;- rbind(collected, batch_valid)\n  }\n\n  collected[1:n, , drop = FALSE]\n}\n\nmeans &lt;- c(\n  CRCL_MDRD = carlier_crcl$norm_par[\"mean\"],\n  WT_log      = carlier_wt$lnorm_par[\"meanlog\"],\n  AGE     = carlier_age$norm_par[\"mean\"],\n  HT_log     = mean_HT_log\n)\n\nsds_M &lt;- c(\n  CRCL_MDRD = carlier_crcl$norm_par[\"sd\"],\n  WT_log      = carlier_wt$lnorm_par[\"sdlog\"], \n  AGE     = carlier_age$norm_par[\"sd\"],\n  HT_log     = sd_HT_M_log\n)\n\nsds_F &lt;- c(\n  CRCL_MDRD = carlier_crcl$norm_par[\"sd\"],\n  WT_log      = carlier_wt$lnorm_par[\"sdlog\"], \n  AGE     = carlier_age$norm_par[\"sd\"],\n  HT_log     = sd_HT_F_log\n)\n\ncovariates &lt;- c(\"CRCL_MDRD\", \"WT_log\", \"AGE\", \"HT_log\")\n\nnames(means) &lt;- covariates\n\n# Correlation and Covariance Matrix\ncor_carlier_M &lt;- cor_matrix_Carlier_M[covariates, covariates]\ncov_matrix_M &lt;- diag(sds_M) %*% cor_carlier_M %*% diag(sds_M)\neigen(cov_matrix_M)$values\n\n\n[1] 4.705706e+03 1.077951e+02 8.326780e-03 1.446538e-03\n\n\nShow the code\ncor_carlier_F &lt;- cor_matrix_Carlier_F[covariates, covariates]\ncov_matrix_F &lt;- diag(sds_F) %*% cor_carlier_F %*% diag(sds_F)\neigen(cov_matrix_F)$values\n\n\n[1] 4.708164e+03 1.053367e+02 8.259148e-03 1.338558e-03\n\n\nShow the code\n# Simulate\nsim_data_M &lt;- correlated_simulation(n = 531, means = means, cov_matrix = cov_matrix_M)\nsim_data_M &lt;- as_tibble(sim_data_M) %&gt;%\n  mutate(SEX = 0)\n\nsim_data_F &lt;- correlated_simulation(n = 94, means = means, cov_matrix = cov_matrix_F)\nsim_data_F &lt;- as_tibble(sim_data_F) %&gt;%\n  mutate(SEX = 1)\n\nsim_data &lt;- rbind(sim_data_M, sim_data_F)\n\n# Put the covariates together\nsim_cov_carlier &lt;- tibble(\n  Paper = \"Carlier_2013\",\n  ID_within_paper = 1:n_patient,\n  ICU = 1,\n  BURN = 0,\n  OBESE = 0,\n  CRCL = sim_data$CRCL_MDRD,\n  WT_log   = sim_data$WT_log,\n  AGE  = sim_data$AGE,\n  HT_log  = sim_data$HT_log,\n  SEX = sim_data$SEX\n)\n\n# Add OBESE variable and reconvert logWT to WT\nsim_cov_carlier &lt;- sim_cov_carlier %&gt;%\n  mutate(WT = exp(WT_log),\n         HT = (exp(HT_log))*100,\n         BMI = WT / (HT/100)^2,\n         OBESE = ifelse(BMI &gt; 30, 1, 0))\n\nsummary_sim_cov_carlier &lt;- sim_cov_carlier |&gt; \n  pivot_longer(cols = c(ICU,BURN,OBESE,CRCL,WT,AGE,BMI),\n               names_to = \"Covariate\") |&gt; \n  summarise(.by = c(Covariate,Paper),\n            Min = min(value),\n            Q1 = quantile(value, 0.25),\n            Median = quantile(value, 0.5),\n            Q3 = quantile(value, 0.75),\n            Max = max(value))\n\n\n\n\nShow the code\ncov_carlier_compare &lt;- summary_sim_cov_carlier |&gt;\n  rename_with(~ paste0(.x, \"_sim\"), -one_of(\"Covariate\", \"Paper\")) |&gt;\n  left_join(rename_with(\n    cov_data_carlier,\n    ~ paste0(.x, \"_true\"),\n    -one_of(\"Covariate\", \"Paper\", \"Unit\")\n  )) |&gt; \n  relocate(Covariate, .after = Paper) |&gt; \n  relocate(Unit, .after = Covariate)\n\ncov_carlier_compare |&gt;\n  gt() |&gt;\n  fmt_scientific() |&gt; \n    tab_spanner(columns = starts_with(\"Min\"),\n              label = \"Min\") |&gt; \n      tab_spanner(columns = starts_with(\"Q1\"),\n              label = \"Q1\") |&gt; \n      tab_spanner(columns = starts_with(\"Median\"),\n              label = \"Median\") |&gt; \n      tab_spanner(columns = starts_with(\"Q3\"),\n              label = \"Q3\") |&gt; \n  tab_spanner(columns = starts_with(\"Max\"),\n              label = \"Max\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPaper\nCovariate\nUnit\n\nMin\n\n\nQ1\n\n\nMedian\n\n\nQ3\n\n\nMax\n\n\n\nMin_sim\nMin_true\nQ1_sim\nQ1_true\nMedian_sim\nMedian_true\nQ3_sim\nQ3_true\nMax_sim\nMax_true\n\n\n\n\nCarlier_2013\nICU\nUnitless\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n\n\nCarlier_2013\nBURN\nUnitless\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n\n\nCarlier_2013\nOBESE\nUnitless\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n1.00\n0.00\n\n\nCarlier_2013\nCRCL\nmL/min\n1.18 × 101\n1.00 × 101\n6.68 × 101\n5.00 × 101\n1.15 × 102\n1.02 × 102\n1.64 × 102\n1.57 × 102\n3.64 × 102\nNA\n\n\nCarlier_2013\nWT\nkg\n5.89 × 101\nNA\n7.02 × 101\n7.00 × 101\n7.47 × 101\n7.50 × 101\n7.98 × 101\n7.90 × 101\n1.01 × 102\nNA\n\n\nCarlier_2013\nAGE\nyear\n2.84 × 101\nNA\n5.38 × 101\n5.80 × 101\n6.30 × 101\n6.20 × 101\n7.00 × 101\n7.20 × 101\n9.82 × 101\nNA\n\n\nCarlier_2013\nBMI\nkg/m^{2}\n1.66 × 101\nNA\n2.19 × 101\n2.10 × 101\n2.32 × 101\n2.40 × 101\n2.50 × 101\n2.50 × 101\n3.14 × 101\nNA\n\n\n\n\n\n\n\n\n\nShow the code\nevaluate_cov_sim &lt;- function(p, q, cov_name, cov_unit, cov_sim) {\n  #' Plot simulated covariate distribution versus observed quantiles from the paper\n  #' @param p numeric vector of probabilities\n  #' @param q numeric vector of quantiles\n  #' @param cov_name character string containing the covariate name\n  #' @param cov_unit character string containing the unit of the covariate\n  #' @param cov_sim tibble containing the simulated values for the covariate\n  #' @return ggplot2 showing the distributions of the simulated covariate and the observed covariate quantiles\n  \n  \n  #create a dataset with the true percentiles to be able to show them on the plot\n  true_percentiles &lt;- tibble(p, q) |&gt; \n    mutate(label = case_match(p, \n                              0 ~ \"True min\",\n                              0.25 ~ \"True Q1\",\n                              0.5 ~ \"True median\",\n                              0.75 ~ \"True Q3\",\n                              1 ~ \"True max\")) \n  \n  #create a dataset with the percentiles of the fitted distributions to be able to show them on the plot\n   sim_percentiles &lt;-  tibble(\n    probability = p,\n    q = quantile(pull(cov_sim,cov_name),p) \n  ) |&gt; \n        mutate(label = case_match(probability, \n                              0 ~ \"Sim min\",\n                              0.25 ~ \"Sim Q1\",\n                              0.5 ~ \"Sim median\",\n                              0.75 ~ \"Sim Q3\",\n                              1 ~ \"Sim max\"))\n   \n# create an initial histogram in order to be able to extract statistics of the binned covariate\nhist_ini &lt;- ggplot(cov_sim, aes(x = .data[[cov_name]])) +\n  geom_histogram(bins=15)\n   \nhist_data &lt;- layer_data(hist_ini)\n   \nplot &lt;- ggplot(hist_data) +\n  geom_rect(aes(xmin=xmin,xmax=xmax, ymin=0, ymax=count),\n            alpha = 0.5) +\n     geom_vline(data = true_percentiles,\n                mapping = aes(xintercept = q,color = \"True\"),\n                lty = \"dashed\") +\n     geom_vline(data = sim_percentiles,\n                mapping = aes(xintercept = q,color = \"Sim\"),\n                lty = \"solid\") +\n     theme_bw() +\n     ylab(\"Count\") +\n     xlab(paste0(cov_name, \" (\", cov_unit, \")\"))  +\n\n     geom_text(\n       data = true_percentiles,\n       mapping = aes(x = q, label = label, color = \"True\"),\n       show.legend = FALSE,\n       y = 0.95*max(hist_data$ymax),\n       hjust = 1,\n       vjust = -1,\n       angle = 90\n     ) +\n     geom_text(\n       data = sim_percentiles,\n       mapping = aes(x = q, label = label, color = \"Sim\"),\n       show.legend = FALSE,\n       y = 0.95*max(hist_data$ymax),\n       hjust = 1,\n       vjust = -1,\n       angle = 90\n     ) +\n     scale_color_brewer(name = \"Quantiles\",\n                        palette =\"Dark2\")\n   plot\n}\n\nplot_sim_cov_wrapper &lt;- function(cov_data,cov_name,cov_sim){\n  cov_df &lt;- extract_cov_param(cov_data, cov_name)\n\nevaluate_cov_sim(cov_df$p,cov_df$q,cov_df$cov_name,cov_df$cov_unit,\n                 cov_sim)\n}\n\n\n\n\nShow the code\nplot_sim_cov_wrapper(cov_data_carlier,\"CRCL\",sim_cov_carlier)\n\n\n\n\n\n\n\n\n\nShow the code\nplot_sim_cov_wrapper(cov_data_carlier,\"WT\",sim_cov_carlier)\n\n\n\n\n\n\n\n\n\nShow the code\nplot_sim_cov_wrapper(cov_data_carlier,\"AGE\",sim_cov_carlier)\n\n\n\n\n\n\n\n\n\nShow the code\nplot_sim_cov_wrapper(cov_data_carlier,\"BMI\",sim_cov_carlier)\n\n\n\n\n\n\n\n\n\nThen, based on BMI and WT, height (HT) is calculated to be able to calculate the body surface area (BSA). CRCL was calculated using the measured urinary equation, and as we have know information about the urinary volume or urinary creatinine concentration, we cannot reconvert CRCL to CREAT based on this equation. The most recommended equation is CKD-EPI, however as different exponents are used based on the value of CREAT, it can’t be used for reconversion of CRCL to CREAT. Thus, the second best equation, MDRD is used.\n\n\nShow the code\nreconvert_MDRD &lt;- function(AGE, CRCL, SEX) {\n    # Mutliply by 0.742 for females\n    sex_factor &lt;- ifelse(SEX == 0, 1, 0.742)\n    \n    # Calculate DFG\n   CREAT &lt;- (CRCL / (175 * (AGE^(-0.203)) * sex_factor))^(-1 / 1.154)\n  \n  return(CREAT)\n}\n\nsim_cov_carlier &lt;- sim_cov_carlier %&gt;%\n  mutate(\n    BSA = (WT^0.425 * (HT^0.725) * 0.007184), # Calculate body surface area based on Dubois&Dubois formula\n    CRCL = CRCL * (1.73 /BSA) # convert mL/min to mL/min/1.73 m2\n  )\nsim_cov_carlier$CREAT &lt;- mapply(reconvert_MDRD, sim_cov_carlier$AGE, sim_cov_carlier$CRCL, sim_cov_carlier$SEX)\nsim_cov_carlier &lt;- sim_cov_carlier %&gt;%\n  dplyr::select(Paper, ID_within_paper, ICU, BURN, OBESE, CREAT, WT, BSA, BMI, AGE, SEX, HT)\n\n# Calculate the simulated correlation matrices separately for the two sexes to compare with the original\nsim_cov_carlier_M &lt;- sim_cov_carlier %&gt;% filter(SEX == 0)\nsim_cov_carlier_F &lt;- sim_cov_carlier %&gt;% filter(SEX == 1)\n\ncor_sim_M &lt;- cor(sim_cov_carlier_M %&gt;% dplyr::select(WT, CREAT, AGE, HT, BMI), use = \"complete.obs\")\ncor_sim_F &lt;- cor(sim_cov_carlier_F %&gt;% dplyr::select(WT, CREAT, AGE, HT, BMI), use = \"complete.obs\")\n\nggcorrplot(cor_matrix_Carlier_F, lab = TRUE, title = \"Carlier original (females)\")\n\n\n\n\n\n\n\n\n\nShow the code\nCarlier_F &lt;- ggcorrplot(cor_sim_F, lab = TRUE, title = \"Carlier simulated (females)\")\nCarlier_F \n\n\n\n\n\n\n\n\n\nShow the code\nggcorrplot(cor_matrix_Carlier_M, lab = TRUE, title = \"Carlier original (males)\")\n\n\n\n\n\n\n\n\n\nShow the code\nCarlier_M &lt;- ggcorrplot(cor_sim_M, lab = TRUE, title = \"Carlier simulated (males)\")\nCarlier_M",
    "crumbs": [
      "Simulations",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Covariate simulation</span>"
    ]
  },
  {
    "objectID": "Simulations/covariate_simulation.html#fournier2018",
    "href": "Simulations/covariate_simulation.html#fournier2018",
    "title": "5  Covariate simulation",
    "section": "5.3 Fournier et al. (2018)",
    "text": "5.3 Fournier et al. (2018)",
    "crumbs": [
      "Simulations",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Covariate simulation</span>"
    ]
  },
  {
    "objectID": "Simulations/covariate_simulation.html#general-considerations-about-the-paper",
    "href": "Simulations/covariate_simulation.html#general-considerations-about-the-paper",
    "title": "5  Covariate simulation",
    "section": "5.4 General considerations about the paper",
    "text": "5.4 General considerations about the paper\nThis study includes only 21 patients, thus deriving distributions from the reported covariates values might be difficult\n\n5.4.1 Covariate distribution\nAll patients are ICU patients with burns who are assumed to be non obese. Creatinine clearance is calculated based on the Cockcroft & Gault equation, whose output is in mL/min, so there is no need to calculate BSA. Thus for all patients ICU = 1, BURN = 1 and OBESE=0.\nIt is not mentioned in the article if certain patients are on renal replacement therapy, therefore we assume that they are not, and set the minimum value of creatinine clearance to 10 mL/min. CRCL was estimated using the Cockroft and Gault equation.\nFor AGE, not the median and IQR is given but the mean (50.1) and standard deviation (24.3). As we cannot compare the simulated distribution to the true one, so we suppose that the distribution follows a normal distribution.\nThe proportion of males in the original article is 0.762.\nNeither BMI nor HT or BSA are provided in the article, thus the height is simulated based on the height obtained from the MIMIC clinical dataset (normal distribution with mean of 169 and sd of 10.3).\nFor WT, AGE and CRCL here are the data from the paper :\n\n\nShow the code\ncov_data_fournier &lt;- cov_data |&gt; \n  filter(Paper == \"Fournier_2018\")\n\ncov_data_fournier |&gt; \n  filter(Covariate %in% c(\"WT\",\"CRCL\",\"AGE\")) |&gt; \n  kable()\n\n\n\n\n\nPaper\nCovariate\nUnit\nMedian\nQ1\nQ3\nMin\nMax\n\n\n\n\nFournier_2018\nWT\nkg\n72.4\n67\n83.6\nNA\nNA\n\n\nFournier_2018\nCRCL\nmL/min\n128.0\n65\n150.0\n10\nNA\n\n\nFournier_2018\nAGE\nyear\n50.1\nNA\nNA\nNA\nNA\n\n\n\n\n\n\n\nShow the code\ncor_matrix_Fournier_F &lt;- readRDS(here(\"Simulations/cor_matrix_Fournier_F.rds\"))\nprint(cor_matrix_Fournier_F)\n\n\n              CREAT         AGE         WT     WT_log          HT      HT_log\nCREAT    1.00000000  0.11092068  0.1240980  0.1236777 -0.01115272 -0.01163038\nAGE      0.11092068  1.00000000 -0.1411092 -0.1377268 -0.21810675 -0.21757157\nWT       0.12409798 -0.14110923  1.0000000  0.9910295  0.26291857  0.26261857\nWT_log   0.12367767 -0.13772678  0.9910295  1.0000000  0.27210890  0.27214801\nHT      -0.01115272 -0.21810675  0.2629186  0.2721089  1.00000000  0.99936169\nHT_log  -0.01163038 -0.21757157  0.2626186  0.2721480  0.99936169  1.00000000\nBMI      0.13219801 -0.06085883  0.9199729  0.9108563 -0.12595561 -0.12641807\nCRCL_CG -0.57789581 -0.60548019  0.3271195  0.3230419  0.20870474  0.20811864\n                BMI    CRCL_CG\nCREAT    0.13219801 -0.5778958\nAGE     -0.06085883 -0.6054802\nWT       0.91997291  0.3271195\nWT_log   0.91085635  0.3230419\nHT      -0.12595561  0.2087047\nHT_log  -0.12641807  0.2081186\nBMI      1.00000000  0.2518084\nCRCL_CG  0.25180837  1.0000000\n\n\nShow the code\nggcorrplot(cor_matrix_Fournier_F, lab = TRUE, title = \"Sex: female\")\n\n\n\n\n\n\n\n\n\nShow the code\ncor_matrix_Fournier_M &lt;- readRDS(here(\"Simulations/cor_matrix_Fournier_M.rds\"))\nprint(cor_matrix_Fournier_M)\n\n\n              CREAT         AGE          WT      WT_log          HT      HT_log\nCREAT    1.00000000  0.08421679  0.07887415  0.07757763 -0.01796103 -0.01782471\nAGE      0.08421679  1.00000000 -0.11683417 -0.11039865 -0.13268497 -0.13114182\nWT       0.07887415 -0.11683417  1.00000000  0.99316445  0.36730646  0.36578272\nWT_log   0.07757763 -0.11039865  0.99316445  1.00000000  0.36989373  0.36884368\nHT      -0.01796103 -0.13268497  0.36730646  0.36989373  1.00000000  0.99929302\nHT_log  -0.01782471 -0.13114182  0.36578272  0.36884368  0.99929302  1.00000000\nBMI      0.09421423 -0.05819520  0.87199105  0.86717872 -0.12604976 -0.12807159\nCRCL_CG -0.60813562 -0.55803721  0.29302773  0.28921272  0.18756329  0.18568377\n                BMI    CRCL_CG\nCREAT    0.09421423 -0.6081356\nAGE     -0.05819520 -0.5580372\nWT       0.87199105  0.2930277\nWT_log   0.86717872  0.2892127\nHT      -0.12604976  0.1875633\nHT_log  -0.12807159  0.1856838\nBMI      1.00000000  0.2145950\nCRCL_CG  0.21459503  1.0000000\n\n\nShow the code\nggcorrplot(cor_matrix_Fournier_M, lab = TRUE, title = \"Sex: male\")\n\n\n\n\n\n\n\n\n\n\n\nShow the code\nfournier_crcl &lt;- fit_cov_wrapper(\n  cov_data = cov_data_fournier,\n  cov_name = \"CRCL\",\n  min_plot = 0,\n  max_plot = 250,\n  tol=0.002\n)\n\nfournier_crcl$plot\n\n\n\n\n\n\n\n\n\nTolerance was increased to 0.002 to have a fit for log-normal. Normal distribution is better suited.\n\n\nShow the code\nfournier_wt &lt;- fit_cov_wrapper(\n  cov_data = cov_data_fournier,\n  cov_name = \"WT\",\n  min_plot = 40,\n  max_plot = 120\n)\n\nfournier_wt$plot\n\n\n\n\n\n\n\n\n\nIn this case the log-normal distribution quantiles are closer to the true quantiles than the normal ones. We will take the log-normal ones.\n\n\n5.4.2 Simulation of covariates\nCovariates will be sampled from the following distributions :\n\nCRCL : Normal distribution with mean 117.016 mL/min and standard deviation 63.3 mL/min\nWT : Lognormal distribution with mean 73.8 kg, and coefficient of variation 17 %\nAGE : Supposed normal distribution with mean of 50.1 years and standard deviation of 24.3\n\nThe proportion of males is 0.762 in the original article, so the number of males is 476 and the number of females is 149 to add up to 625.\n\n\nShow the code\ncorrelated_simulation &lt;- function(n, means, cov_matrix) {\n  set.seed(1991)\n  collected &lt;- matrix(NA, 0, length(means))\n  colnames(collected) &lt;- names(means)\n\n  while (nrow(collected) &lt; n) {\n    batch &lt;- MASS::mvrnorm(n = n, mu = means, Sigma = cov_matrix)\n    colnames(batch) &lt;- names(means)\n\n    valid &lt;- batch[, \"AGE\"] &gt;= 18 &\n             batch[, \"CRCL_CG\"] &gt;= 10\n\n    batch_valid &lt;- batch[valid, , drop = FALSE]\n    collected &lt;- rbind(collected, batch_valid)\n  }\n\n  collected[1:n, , drop = FALSE]\n}\n\nmeans &lt;- c(\n  CRCL_CG = fournier_crcl$norm_par[\"mean\"],\n  WT_log      = fournier_wt$lnorm_par[\"meanlog\"],\n  AGE     = 50.1,\n  HT = 169\n)\n\nsds &lt;- c(\n  CRCL_CG = fournier_crcl$norm_par[\"sd\"],\n  WT_log      = fournier_wt$lnorm_par[\"sdlog\"],\n  AGE     = 24.3,\n  HT = 10.3\n)\n\ncovariates &lt;- c(\"CRCL_CG\", \"WT_log\", \"AGE\", \"HT\")\n\nnames(means) &lt;- covariates\n\n# Correlation and Covariance Matrix\ncor_fournier_M &lt;- cor_matrix_Fournier_M[covariates, covariates]\ncov_matrix_M &lt;- diag(sds) %*% cor_fournier_M %*% diag(sds)\neigen(cov_matrix_M)$values\n\n\n[1] 4218.3820076  387.0322287  102.1295861    0.0230053\n\n\nShow the code\ncor_fournier_F &lt;- cor_matrix_Fournier_F[covariates, covariates]\ncov_matrix_F &lt;- diag(sds) %*% cor_fournier_F %*% diag(sds)\neigen(cov_matrix_F)$values\n\n\n[1] 4.253434e+03 3.545807e+02 9.952763e+01 2.398513e-02\n\n\nShow the code\n# Simulate\nsim_data_M &lt;- correlated_simulation(n = 476, means = means, cov_matrix = cov_matrix_M)\nsim_data_M &lt;- as_tibble(sim_data_M) %&gt;%\n  mutate(SEX = 0)\n\nsim_data_F &lt;- correlated_simulation(n = 149, means = means, cov_matrix = cov_matrix_F)\nsim_data_F &lt;- as_tibble(sim_data_F) %&gt;%\n  mutate(SEX = 1)\n\nsim_data &lt;- rbind(sim_data_M, sim_data_F)\n\n# Put the covariates together\nsim_cov_fournier &lt;- tibble(\n  Paper = \"Fournier_2018\",\n  ID_within_paper = 1:n_patient,\n  ICU = 1,\n  BURN = 1,\n  OBESE = 0,\n  CRCL = sim_data$CRCL_CG,\n  WT_log   = sim_data$WT_log,\n  AGE  = sim_data$AGE,\n  HT  = sim_data$HT,\n  SEX = sim_data$SEX)\n\nsim_cov_fournier &lt;- sim_cov_fournier %&gt;%\n  mutate(WT = exp(WT_log))\n\nsummary_sim_cov_fournier &lt;- sim_cov_fournier |&gt; \n  pivot_longer(cols = c(ICU,BURN,OBESE,CRCL,WT,AGE),\n               names_to = \"Covariate\") |&gt; \n  summarise(.by = c(Covariate,Paper),\n            Min = min(value),\n            Q1 = quantile(value, 0.25),\n            Median = quantile(value, 0.5),\n            Q3 = quantile(value, 0.75),\n            Max = max(value))\n\npaste0(\"The proportion of males is \", round(mean(sim_cov_fournier$SEX == 0), 3), \" compared to the original 0.762.\")\n\n\n[1] \"The proportion of males is 0.762 compared to the original 0.762.\"\n\n\n\n\nShow the code\ncov_fournier_compare &lt;- summary_sim_cov_fournier |&gt;\n  rename_with(~ paste0(.x, \"_sim\"), -one_of(\"Covariate\", \"Paper\")) |&gt;\n  left_join(rename_with(\n    cov_data_fournier,\n    ~ paste0(.x, \"_true\"),\n    -one_of(\"Covariate\", \"Paper\", \"Unit\")\n  )) |&gt; \n  relocate(Covariate, .after = Paper) |&gt; \n  relocate(Unit, .after = Covariate)\n\ncov_fournier_compare |&gt;\n  gt() |&gt;\n  fmt_scientific() |&gt; \n    tab_spanner(columns = starts_with(\"Min\"),\n              label = \"Min\") |&gt; \n      tab_spanner(columns = starts_with(\"Q1\"),\n              label = \"Q1\") |&gt; \n      tab_spanner(columns = starts_with(\"Median\"),\n              label = \"Median\") |&gt; \n      tab_spanner(columns = starts_with(\"Q3\"),\n              label = \"Q3\") |&gt; \n  tab_spanner(columns = starts_with(\"Max\"),\n              label = \"Max\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPaper\nCovariate\nUnit\n\nMin\n\n\nQ1\n\n\nMedian\n\n\nQ3\n\n\nMax\n\n\n\nMin_sim\nMin_true\nQ1_sim\nQ1_true\nMedian_sim\nMedian_true\nQ3_sim\nQ3_true\nMax_sim\nMax_true\n\n\n\n\nFournier_2018\nICU\nUnitless\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n\n\nFournier_2018\nBURN\nUnitless\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n\n\nFournier_2018\nOBESE\nUnitless\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n\n\nFournier_2018\nCRCL\nmL/min\n1.01 × 101\n1.00 × 101\n7.32 × 101\n6.50 × 101\n1.16 × 102\n1.28 × 102\n1.55 × 102\n1.50 × 102\n2.88 × 102\nNA\n\n\nFournier_2018\nWT\nkg\n4.53 × 101\nNA\n6.66 × 101\n6.70 × 101\n7.45 × 101\n7.24 × 101\n8.40 × 101\n8.36 × 101\n1.18 × 102\nNA\n\n\nFournier_2018\nAGE\nyear\n1.80 × 101\nNA\n3.49 × 101\nNA\n5.03 × 101\n5.01 × 101\n6.72 × 101\nNA\n1.31 × 102\nNA\n\n\n\n\n\n\n\n\n\nShow the code\nplot_sim_cov_wrapper(cov_data_fournier,\"CRCL\",sim_cov_fournier)\n\n\n\n\n\n\n\n\n\nShow the code\nplot_sim_cov_wrapper(cov_data_fournier,\"WT\",sim_cov_fournier)\n\n\n\n\n\n\n\n\n\nShow the code\nplot_sim_cov_wrapper(cov_data_fournier,\"AGE\",sim_cov_fournier)\n\n\n\n\n\n\n\n\n\nThen, based on the BMI and WT, the height (HT) is calculated to be able to calculate the body surface area (BSA). CRCL is reconverted to serum creatinine (CREAT) based on the Cockroft and Gault equation.\n\n\nShow the code\nreconvert_CG &lt;- function(AGE, CRCL, SEX, WT) {\n    # Mutliply by 0.85 for females\n    sex_factor &lt;- ifelse(SEX == 0, 1, 0.85)\n    \n    # Calculate DFG\n    CREAT = ((140 - AGE) * WT * sex_factor) / (CRCL * 72)\n  \n  return(CREAT)\n}\n\nsim_cov_fournier$CREAT &lt;- mapply(reconvert_CG, sim_cov_fournier$AGE, sim_cov_fournier$CRCL, sim_cov_fournier$SEX, sim_cov_fournier$WT)\nsim_cov_fournier &lt;- sim_cov_fournier %&gt;%\n  mutate(\n     BSA = (WT^0.425 * (HT^0.725) * 0.007184),\n     BMI = WT / (HT/100)^2,\n     OBESE = ifelse(BMI &gt; 30, 1, 0)\n  ) %&gt;%\n  dplyr::select(Paper, ID_within_paper, ICU, BURN, OBESE, CREAT, WT, BSA, BMI, AGE, SEX, HT)\n# Calculate the simulated correlation matrices separately for the two sexes to compare with the original\nsim_cov_fournier_M &lt;- sim_cov_fournier %&gt;% filter(SEX == 0)\nsim_cov_fournier_F &lt;- sim_cov_fournier %&gt;% filter(SEX == 1)\n\ncor_sim_M &lt;- cor(sim_cov_fournier_M %&gt;% dplyr::select(WT, CREAT, AGE, HT, BMI), use = \"complete.obs\")\ncor_sim_F &lt;- cor(sim_cov_fournier_F %&gt;% dplyr::select(WT, CREAT, AGE, HT, BMI), use = \"complete.obs\")\n\nggcorrplot(cor_matrix_Fournier_F, lab = TRUE, title = \"Fournier original (females)\")\n\n\n\n\n\n\n\n\n\nShow the code\nFournier_F &lt;- ggcorrplot(cor_sim_F, lab = TRUE, title = \"Fournier simulated (females)\")\nFournier_F\n\n\n\n\n\n\n\n\n\nShow the code\nggcorrplot(cor_matrix_Fournier_M, lab = TRUE, title = \"Fournier original (males)\")\n\n\n\n\n\n\n\n\n\nShow the code\nFournier_M &lt;- ggcorrplot(cor_sim_M, lab = TRUE, title = \"Fournier simulated (males)\")\nFournier_M",
    "crumbs": [
      "Simulations",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Covariate simulation</span>"
    ]
  },
  {
    "objectID": "Simulations/covariate_simulation.html#mellon2020",
    "href": "Simulations/covariate_simulation.html#mellon2020",
    "title": "5  Covariate simulation",
    "section": "5.5 Mellon et al. (2020)",
    "text": "5.5 Mellon et al. (2020)\n\n5.5.1 Covariate distribution\nPatients are obese, but otherwise healthy, meaning that they are not in intensive care and not burn victims. They are all obese (BMI &gt; 30 kg/m^2). Creatinine clearance is calculated based on the MDRD equation. Thus for all patients ICU = 0, BURN = 0, OBESE=1.\nFor WT, BMI and CRCL here are the data from the paper :\n\n\nShow the code\ncov_data_mellon &lt;- cov_data |&gt; \n  filter(Paper == \"Mellon_2020\")\n\ncov_data_mellon |&gt; \n  filter(Covariate %in% c(\"WT\",\"CRCL\", \"AGE\", \"BMI\", \"BMI_log\")) |&gt; \n  kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPaper\nCovariate\nUnit\nMedian\nQ1\nQ3\nMin\nMax\n\n\n\n\nMellon_2020\nWT\nkg\n109.3\nNA\nNA\n88.00\n151.50\n\n\nMellon_2020\nCRCL\nmL/min/1.73m^{2}\n94.0\nNA\nNA\n62.00\n133.00\n\n\nMellon_2020\nBMI\nkg/m^{2}\n40.6\nNA\nNA\n35.20\n67.30\n\n\nMellon_2020\nBMI_log\nkg/m^{2}\n3.7\nNA\nNA\n3.56\n4.21\n\n\nMellon_2020\nCRCL\nml/min\nNA\nNA\nNA\nNA\nNA\n\n\nMellon_2020\nAGE\nyear\n51.7\nNA\nNA\n22.90\n62.90\n\n\n\n\n\n\n\nShow the code\ncor_matrix_Mellon_F &lt;- readRDS(here(\"Simulations/cor_matrix_Mellon_F.rds\"))\nprint(cor_matrix_Mellon_F)\n\n\n                      CREAT          AGE          WT       WT_log          HT\nCREAT           1.000000000  0.022643469  0.03125540  0.031968067  0.05795702\nAGE             0.022643469  1.000000000 -0.07488881 -0.077065515 -0.11168121\nWT              0.031255400 -0.074888809  1.00000000  0.997431167  0.43988528\nWT_log          0.031968067 -0.077065515  0.99743117  1.000000000  0.45364368\nHT              0.057957020 -0.111681207  0.43988528  0.453643683  1.00000000\nHT_log          0.057716460 -0.110775924  0.43501172  0.448949779  0.99935506\nBMI            -0.006435320 -0.004011043  0.76869713  0.758978914 -0.23142245\nBMI_log        -0.006781559 -0.004085614  0.77244329  0.765197692 -0.22615779\nCRCL_MDRD_norm -0.936664533 -0.319596180 -0.00640208 -0.006556334 -0.02317188\n                    HT_log          BMI      BMI_log CRCL_MDRD_norm\nCREAT           0.05771646 -0.006435320 -0.006781559   -0.936664533\nAGE            -0.11077592 -0.004011043 -0.004085614   -0.319596180\nWT              0.43501172  0.768697132  0.772443287   -0.006402080\nWT_log          0.44894978  0.758978914  0.765197692   -0.006556334\nHT              0.99935506 -0.231422452 -0.226157792   -0.023171879\nHT_log          1.00000000 -0.237225021 -0.231732528   -0.023241184\nBMI            -0.23722502  1.000000000  0.997187131    0.009471973\nBMI_log        -0.23173253  0.997187131  1.000000000    0.009607333\nCRCL_MDRD_norm -0.02324118  0.009471973  0.009607333    1.000000000\n\n\nShow the code\nggcorrplot(cor_matrix_Mellon_F, lab = TRUE, title = \"Sex: female\")\n\n\n\n\n\n\n\n\n\nShow the code\ncor_matrix_Mellon_M &lt;- readRDS(here(\"Simulations/cor_matrix_Mellon_M.rds\"))\nprint(cor_matrix_Mellon_M)\n\n\n                      CREAT          AGE           WT       WT_log           HT\nCREAT           1.000000000 -0.079420098 -0.005155970 -0.002021643  0.062039693\nAGE            -0.079420098  1.000000000 -0.020403922 -0.018224696 -0.002835067\nWT             -0.005155970 -0.020403922  1.000000000  0.997694029  0.617330996\nWT_log         -0.002021643 -0.018224696  0.997694029  1.000000000  0.634363996\nHT              0.062039693 -0.002835067  0.617330996  0.634363996  1.000000000\nHT_log          0.061429587 -0.001756480  0.613093576  0.631018266  0.999227265\nBMI            -0.070072797 -0.019345942  0.535836189  0.518641232 -0.328796339\nBMI_log        -0.069673338 -0.020297428  0.545596150  0.528796578 -0.319827206\nCRCL_MDRD_norm -0.940158336 -0.215895006  0.007018922  0.003387753 -0.059982333\n                    HT_log         BMI     BMI_log CRCL_MDRD_norm\nCREAT           0.06142959 -0.07007280 -0.06967334   -0.940158336\nAGE            -0.00175648 -0.01934594 -0.02029743   -0.215895006\nWT              0.61309358  0.53583619  0.54559615    0.007018922\nWT_log          0.63101827  0.51864123  0.52879658    0.003387753\nHT              0.99922726 -0.32879634 -0.31982721   -0.059982333\nHT_log          1.00000000 -0.33401211 -0.32475168   -0.059647213\nBMI            -0.33401211  1.00000000  0.99775044    0.069173500\nBMI_log        -0.32475168  0.99775044  1.00000000    0.069388818\nCRCL_MDRD_norm -0.05964721  0.06917350  0.06938882    1.000000000\n\n\nShow the code\nggcorrplot(cor_matrix_Mellon_M, lab = TRUE, title = \"Sex: male\")\n\n\n\n\n\n\n\n\n\nMellon is different from the other papers as CRCL is given as ml/min/1.73m^{2} based on the MDRD equation, and instead of Q1 and Q3, the minimum and maxiumum of the covariates is given (apart from BMI). Another particularity is that due to the particularity of the subjects (obesity), the distribution of body weight is positively (right) skewed. Positively skewed distribution is relatively rare, so it is not easy to find a distribution function to describe it. Beta distribution needs scaling the data between 0 and 1. and 4 parameter stable distribution et gamma distribution have several parameters that need to be defined, and in the absence of the original data, it is not possible to estimate these parameters.\nThe proportion of males is 0.148.\n\n\nShow the code\nmellon_crcl &lt;- fit_cov_wrapper(\n  cov_data = cov_data_mellon,\n  cov_name = \"CRCL\",\n  min_plot = 0,\n  max_plot = 250\n)\n\nmellon_crcl$plot\n\n\n\n\n\n\n\n\n\nSimilar fits; normal distribution is selected.\n\n\nShow the code\nmellon_wt &lt;- fit_cov_wrapper(\n  cov_data = cov_data_mellon,\n  cov_name = \"WT\",\n  min_plot = 40,\n  max_plot = 170\n)\n\nmellon_wt$plot\n\n\n\n\n\n\n\n\n\nLog-normal distribution fits slightly better than normal.\n\n\nShow the code\nmellon_age &lt;- fit_cov_wrapper(\n  cov_data = cov_data_mellon,\n  cov_name = \"AGE\",\n  min_plot = 0,\n  max_plot = 120\n)\n\nmellon_age$plot\n\n\n\n\n\n\n\n\n\nNormal distribution fits a bit better.\n\n\nShow the code\nmellon_bmi &lt;- fit_cov_wrapper(\n  cov_data = cov_data_mellon,\n  cov_name = \"BMI\",\n  min_plot = 0,\n  max_plot = 100, \n  tol = 0.001\n)\n\nmellon_bmi$plot\n\n\n\n\n\n\n\n\n\n\n\nShow the code\nmellon_bmi_log &lt;- fit_cov_wrapper(\n  cov_data = cov_data_mellon,\n  cov_name = \"BMI_log\",\n  min_plot = 2.5,\n  max_plot = 5, \n  tol = 0.001\n)\n\nmellon_bmi_log$plot\n\n\n\n\n\n\n\n\n\nLog-normal distribution fits a bit better.\n\n\n5.5.2 Simulation of covariates\nCovariates will be sampled from the following distributions :\n\nCRCL : Normal distribution from which negative values have been resampled, with mean 94 mL/min and standard deviation 14.3 mL/min\nWT : Log-normal distribution with mean 109 kg, and coefficient of variation 9.41 %\nAGE : Normal distribution with mean 2.84^{22} years, and standard deviation 4.81 %\nBMI : Log-normal distribution with mean 40.6 \\(kg/m^{2}\\), and coefficient of variation 6.14 %\n\nThe proportion of males is 0.148 in the original article, so the number of males is 93 and the number of females is 532 to add up to 625.\n\n\nShow the code\ncorrelated_simulation &lt;- function(n, means, cov_matrix) {\n  set.seed(1991)\n  collected &lt;- matrix(NA, 0, length(means))\n  colnames(collected) &lt;- names(means)\n\n  while (nrow(collected) &lt; n) {\n    batch &lt;- MASS::mvrnorm(n = n, mu = means, Sigma = cov_matrix)\n    colnames(batch) &lt;- names(means)\n\n    valid &lt;- batch[, \"AGE\"] &gt;= 18 &\n             batch[, \"CRCL_MDRD_norm\"] &gt;= 10 &\n             batch[, \"BMI_log\"] &gt; 3.401197 # log(30)\n\n    batch_valid &lt;- batch[valid, , drop = FALSE]\n    collected &lt;- rbind(collected, batch_valid)\n  }\n\n  collected[1:n, , drop = FALSE]\n}\n\nmeans &lt;- c(\n  CRCL_MDRD_norm = mellon_crcl$norm_par[\"mean\"],\n  WT_log      = mellon_wt$lnorm_par[\"meanlog\"],\n  AGE     = mellon_age$norm_par[\"mean\"],\n  BMI_log     = mellon_bmi$lnorm_par[\"meanlog\"]\n)\n\nsds &lt;- c(\n  CRCL_MDRD_norm = mellon_crcl$norm_par[\"sd\"],\n  WT_log      = mellon_wt$lnorm_par[\"sdlog\"], \n  AGE = mellon_age$norm_par[\"sd\"],\n  BMI_log     = mellon_bmi$lnorm_par[\"sdlog\"]\n)\n\ncovariates &lt;- c(\"CRCL_MDRD_norm\", \"WT_log\", \"AGE\", \"BMI_log\")\n\nnames(means) &lt;- covariates\n\n# Correlation and Covariance Matrix\ncor_mellon_M &lt;- cor_matrix_Mellon_M[covariates, covariates]\ncov_matrix_M &lt;- diag(sds) %*% cor_mellon_M %*% diag(sds)\neigen(cov_matrix_M)$values\n\n\n[1] 2.050769e+02 2.197051e+01 1.024041e-02 2.320348e-03\n\n\nShow the code\ncor_mellon_F &lt;- cor_matrix_Mellon_F[covariates, covariates]\ncov_matrix_F &lt;- diag(sds) %*% cor_mellon_F %*% diag(sds)\neigen(cov_matrix_F)$values\n\n\n[1] 2.064991e+02 2.054837e+01 1.132511e-02 1.194553e-03\n\n\nShow the code\n# Simulate\nsim_data_M &lt;- correlated_simulation(n = 93, means = means, cov_matrix = cov_matrix_M)\nsim_data_M &lt;- as_tibble(sim_data_M) %&gt;%\n  mutate(SEX = 0)\n\nsim_data_F &lt;- correlated_simulation(n = 532, means = means, cov_matrix = cov_matrix_F)\nsim_data_F &lt;- as_tibble(sim_data_F) %&gt;%\n  mutate(SEX = 1)\n\nsim_data &lt;- rbind(sim_data_M, sim_data_F)\n\n# Put the covariates together\nsim_cov_mellon &lt;- tibble(\n  Paper = \"Mellon_2020\",\n  ID_within_paper = 1:n_patient,\n  ICU = 0,\n  BURN = 0,\n  OBESE = 1,\n  CRCL = sim_data$CRCL_MDRD_norm,\n  WT_log   = sim_data$WT_log,\n  AGE  = sim_data$AGE,\n  BMI_log  = sim_data$BMI_log,\n  SEX = sim_data$SEX)\n\nsim_cov_mellon &lt;- sim_cov_mellon %&gt;%\n  mutate(WT = exp(WT_log),\n         BMI = exp(BMI_log))\n\nsummary_sim_cov_mellon &lt;- sim_cov_mellon |&gt; \n  pivot_longer(cols = c(ICU,BURN,OBESE,CRCL,WT,AGE),\n               names_to = \"Covariate\") |&gt; \n  summarise(.by = c(Covariate,Paper),\n            Min = min(value),\n            Q1 = quantile(value, 0.25),\n            Median = quantile(value, 0.5),\n            Q3 = quantile(value, 0.75),\n            Max = max(value))\n\n\n\n\nShow the code\nsim_cov_mellon &lt;- sim_cov_mellon %&gt;%\n  dplyr::select(Paper, ID_within_paper, ICU, BURN, OBESE, CRCL, WT, AGE, BMI, SEX)\n\ncov_mellon_compare &lt;- summary_sim_cov_mellon |&gt;\n  rename_with(~ paste0(.x, \"_sim\"), -one_of(\"Covariate\", \"Paper\")) |&gt;\n  left_join(rename_with(\n    cov_data_mellon,\n    ~ paste0(.x, \"_true\"),\n    -one_of(\"Covariate\", \"Paper\", \"Unit\")\n  )) |&gt; \n  relocate(Covariate, .after = Paper) |&gt; \n  relocate(Unit, .after = Covariate)\n\ncov_mellon_compare |&gt;\n  gt() |&gt;\n  fmt_scientific() |&gt; \n  tab_spanner(columns = starts_with(\"Min\"),\n              label = \"Min\") |&gt; \n  tab_spanner(columns = starts_with(\"Q1\"),\n              label = \"Q1\") |&gt; \n  tab_spanner(columns = starts_with(\"Median\"),\n              label = \"Median\") |&gt; \n  tab_spanner(columns = starts_with(\"Q3\"),\n              label = \"Q3\") |&gt; \n  tab_spanner(columns = starts_with(\"Max\"),\n              label = \"Max\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPaper\nCovariate\nUnit\n\nMin\n\n\nQ1\n\n\nMedian\n\n\nQ3\n\n\nMax\n\n\n\nMin_sim\nMin_true\nQ1_sim\nQ1_true\nMedian_sim\nMedian_true\nQ3_sim\nQ3_true\nMax_sim\nMax_true\n\n\n\n\nMellon_2020\nICU\nUnitless\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n\n\nMellon_2020\nBURN\nUnitless\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n\n\nMellon_2020\nOBESE\nUnitless\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n\n\nMellon_2020\nCRCL\nmL/min/1.73m^{2}\n5.18 × 101\n6.20 × 101\n8.24 × 101\nNA\n9.39 × 101\n9.40 × 101\n1.05 × 102\nNA\n1.48 × 102\n1.33 × 102\n\n\nMellon_2020\nCRCL\nml/min\n5.18 × 101\nNA\n8.24 × 101\nNA\n9.39 × 101\nNA\n1.05 × 102\nNA\n1.48 × 102\nNA\n\n\nMellon_2020\nWT\nkg\n8.10 × 101\n8.80 × 101\n1.02 × 102\nNA\n1.09 × 102\n1.09 × 102\n1.16 × 102\nNA\n1.41 × 102\n1.51 × 102\n\n\nMellon_2020\nAGE\nyear\n3.51 × 101\n2.29 × 101\n4.87 × 101\nNA\n5.22 × 101\n5.17 × 101\n5.57 × 101\nNA\n7.07 × 101\n6.29 × 101\n\n\n\n\n\n\n\nThen, based on the BMI and WT, the height (HT) is calculated to be able to calculate the body surface area (BSA). CRCL is reconverted to serum creatinine (CREAT) based on the MDRD equation.\n\n\nShow the code\nreconvert_MDRD &lt;- function(AGE, CRCL, SEX) {\n    # Mutliply by 0.85 for females\n    sex_factor &lt;- ifelse(SEX == 0, 1, 0.742)\n    \n    # Calculate DFG\n   CREAT &lt;- (CRCL / (175 * (AGE^(-0.203)) * sex_factor))^(-1 / 1.154)\n  \n  return(CREAT)\n}\n\nsim_cov_mellon$CREAT &lt;- mapply(reconvert_MDRD, sim_cov_mellon$AGE, sim_cov_mellon$CRCL, sim_cov_mellon$SEX)\nsim_cov_mellon &lt;- sim_cov_mellon %&gt;%\n  mutate(\n   HT = sqrt(WT/BMI) * 100, # mutliplied by 100 to convert m to cm\n    BSA = (WT^0.425 * (HT^0.725) * 0.007184),\n    OBESE = ifelse(BMI &gt; 30, 1, 0)\n  ) %&gt;%\n  dplyr::select(Paper, ID_within_paper, ICU, BURN, OBESE, CREAT, WT, BSA, BMI, AGE, SEX, HT)\n\n# Calculate the simulated correlation matrices separately for the two sexes to compare with the original\nsim_cov_mellon_M &lt;- sim_cov_mellon %&gt;% filter(SEX == 0)\nsim_cov_mellon_F &lt;- sim_cov_mellon %&gt;% filter(SEX == 1)\n\ncor_sim_M &lt;- cor(sim_cov_mellon_M %&gt;% dplyr::select(WT, CREAT, AGE, HT, BMI), use = \"complete.obs\")\ncor_sim_F &lt;- cor(sim_cov_mellon_F %&gt;% dplyr::select(WT, CREAT, AGE, HT, BMI), use = \"complete.obs\")\n\nggcorrplot(cor_matrix_Mellon_F, lab = TRUE, title = \"Mellon original (females)\")\n\n\n\n\n\n\n\n\n\nShow the code\nMellon_F &lt;- ggcorrplot(cor_sim_F, lab = TRUE, title = \"Mellon simulated (females)\")\nMellon_F\n\n\n\n\n\n\n\n\n\nShow the code\nggcorrplot(cor_matrix_Mellon_M, lab = TRUE, title = \"Mellon original (males)\")\n\n\n\n\n\n\n\n\n\nShow the code\nMellon_M &lt;- ggcorrplot(cor_sim_M, lab = TRUE, title = \"Mellon simulated (males)\")\nMellon_M",
    "crumbs": [
      "Simulations",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Covariate simulation</span>"
    ]
  },
  {
    "objectID": "Simulations/covariate_simulation.html#rambaud2020",
    "href": "Simulations/covariate_simulation.html#rambaud2020",
    "title": "5  Covariate simulation",
    "section": "5.6 Rambaud et al. (2020)",
    "text": "5.6 Rambaud et al. (2020)\n\n5.6.1 Covariate distribution\nAll patients are ICU patients with endocarditis. They are not considered to be burn victims or obese. Creatinine clearance was calculated using the CKD-EPI equation. Thus for all patients ICU = 1, BURN = 0 and OBESE=0. In this paper, the distribution of serum creatinine is given (in micromol/L), so it can be directly simulated instead of reconverting CRCL. The proportion of males is 0.794.\nFor WT and CRCL here are the data from the paper :\n\n\nShow the code\ncov_data_rambaud &lt;- cov_data |&gt; \n  filter(Paper == \"Rambaud_2020\")\n\ncov_data_rambaud |&gt; \n  filter(Covariate %in% c(\"WT\",\"CREAT\",\"AGE\",\"HT\")) |&gt; \n  kable()\n\n\n\n\n\nPaper\nCovariate\nUnit\nMedian\nQ1\nQ3\nMin\nMax\n\n\n\n\nRambaud_2020\nWT\nkg\n76\n69\n87.0\nNA\nNA\n\n\nRambaud_2020\nHT\ncm\n170\n166\n175.0\nNA\nNA\n\n\nRambaud_2020\nAGE\nyear\n72\n62\n80.5\nNA\nNA\n\n\nRambaud_2020\nCREAT\nmicromol/L\n87\n73\n115.5\nNA\nNA\n\n\n\n\n\n\n\nShow the code\ncor_matrix_Rambaud_F &lt;- readRDS(here(\"Simulations/cor_matrix_Rambaud_F.rds\"))\nprint(cor_matrix_Rambaud_F)\n\n\n                     CREAT   CREAT_log        AGE         WT     WT_log\nCREAT           1.00000000  0.96241769  0.2320510  0.1329905  0.1360852\nCREAT_log       0.96241769  1.00000000  0.2429180  0.1521950  0.1565402\nAGE             0.23205099  0.24291801  1.0000000 -0.1726236 -0.1683232\nWT              0.13299046  0.15219495 -0.1726236  1.0000000  0.9894565\nWT_log          0.13608520  0.15654017 -0.1683232  0.9894565  1.0000000\nHT             -0.04892509 -0.04044581 -0.1889338  0.2517176  0.2592944\nHT_log         -0.04916482 -0.04082750 -0.1894298  0.2520660  0.2599500\nBMI             0.15464517  0.17128168 -0.1162404  0.9435277  0.9336719\nCRCL_MDRD_norm -0.78792478 -0.91391033 -0.2872002 -0.1410118 -0.1466372\n                        HT      HT_log        BMI CRCL_MDRD_norm\nCREAT          -0.04892509 -0.04916482  0.1546452    -0.78792478\nCREAT_log      -0.04044581 -0.04082750  0.1712817    -0.91391033\nAGE            -0.18893375 -0.18942976 -0.1162404    -0.28720016\nWT              0.25171756  0.25206601  0.9435277    -0.14101184\nWT_log          0.25929441  0.25994996  0.9336719    -0.14663719\nHT              1.00000000  0.99970438 -0.0747791     0.04109155\nHT_log          0.99970438  1.00000000 -0.0742787     0.04153856\nBMI            -0.07477910 -0.07427870  1.0000000    -0.15925725\nCRCL_MDRD_norm  0.04109155  0.04153856 -0.1592572     1.00000000\n\n\nShow the code\nggcorrplot(cor_matrix_Rambaud_F, lab = TRUE, title = \"Sex: female\")\n\n\n\n\n\n\n\n\n\nShow the code\ncor_matrix_Rambaud_M &lt;- readRDS(here(\"Simulations/cor_matrix_Rambaud_M.rds\"))\nprint(cor_matrix_Rambaud_M)\n\n\n                      CREAT     CREAT_log        AGE          WT      WT_log\nCREAT           1.000000000  0.9686820232  0.1909639  0.09370644  0.09181062\nCREAT_log       0.968682023  1.0000000000  0.1982311  0.12356685  0.12378068\nAGE             0.190963871  0.1982311079  1.0000000 -0.18051719 -0.17233815\nWT              0.093706437  0.1235668470 -0.1805172  1.00000000  0.99225399\nWT_log          0.091810623  0.1237806818 -0.1723382  0.99225399  1.00000000\nHT             -0.005710820  0.0007327162 -0.1229902  0.37551772  0.37978066\nHT_log         -0.005537361  0.0010029509 -0.1228308  0.37500256  0.37967684\nBMI             0.103837382  0.1331126943 -0.1347419  0.89436959  0.88815355\nCRCL_MDRD_norm -0.769174641 -0.8857730397 -0.2449519 -0.12508733 -0.12881176\n                          HT       HT_log         BMI CRCL_MDRD_norm\nCREAT          -0.0057108200 -0.005537361  0.10383738   -0.769174641\nCREAT_log       0.0007327162  0.001002951  0.13311269   -0.885773040\nAGE            -0.1229902101 -0.122830828 -0.13474194   -0.244951935\nWT              0.3755177211  0.375002564  0.89436959   -0.125087326\nWT_log          0.3797806561  0.379676845  0.88815355   -0.128811758\nHT              1.0000000000  0.999598212 -0.07118055   -0.003915605\nHT_log          0.9995982117  1.000000000 -0.07162513   -0.004244813\nBMI            -0.0711805452 -0.071625134  1.00000000   -0.133475436\nCRCL_MDRD_norm -0.0039156049 -0.004244813 -0.13347544    1.000000000\n\n\nShow the code\nggcorrplot(cor_matrix_Rambaud_M, lab = TRUE, title = \"Sex: male\")\n\n\n\n\n\n\n\n\n\n\n\nShow the code\nrambaud_creat &lt;- fit_cov_wrapper(\n  cov_data = cov_data_rambaud,\n  cov_name = \"CREAT\",\n  min_plot = 0,\n  max_plot = 250\n)\n\nrambaud_creat$plot\n\n\n\n\n\n\n\n\n\nLog-normal distribution fits the best the data, so it is selected.\n\n\nShow the code\nrambaud_wt &lt;- fit_cov_wrapper(\n  cov_data = cov_data_rambaud,\n  cov_name = \"WT\",\n  min_plot = 40,\n  max_plot = 120\n)\n\nrambaud_wt$plot\n\n\n\n\n\n\n\n\n\nNo discernable difference between the two fits. The log-normal distribution is selected.\n\n\nShow the code\nrambaud_age &lt;- fit_cov_wrapper(\n  cov_data = cov_data_rambaud,\n  cov_name = \"AGE\",\n  min_plot = 0,\n  max_plot = 120\n)\n\nrambaud_age$plot\n\n\n\n\n\n\n\n\n\nNo discernable difference, so normal distribution is selected, as age usually follows a normal distribution.\n\n\nShow the code\nrambaud_ht &lt;- fit_cov_wrapper(\n  cov_data = cov_data_rambaud,\n  cov_name = \"HT\",\n  min_plot = 140,\n  max_plot = 200\n)\n\nrambaud_ht$plot\n\n\n\n\n\n\n\n\n\nNo discernable difference. Log-normal distribution is selected.\n\n\n5.6.2 Simulation of covariates\nCovariates will be sampled from the following distributions :\n\nCREAT : Log-normal distribution with a minimum 10 micromol/L with mean 89.7 micromol/L and standard deviation 0.346 micromol/L\nWT : Normal distribution with resampling of negative values with mean 76.8 kg, and standard deviation 17.3 %\nAGE : Normal distribution with resampling of negative values with mean 1.22^{31} years, and coefficient of variation 1370 %\nHT : Normal distribution with resampling of negative values with mean 170 cm, and standard deviation 3.93 %\n\nThe proportion of males is 0.794 in the original article, so the number of males is 496 and the number of females is 129 to add up to 625.\n\n\nShow the code\ncorrelated_simulation &lt;- function(n, means, cov_matrix) {\n  set.seed(1991)\n  collected &lt;- matrix(NA, 0, length(means))\n  colnames(collected) &lt;- names(means)\n\n  while (nrow(collected) &lt; n) {\n    batch &lt;- MASS::mvrnorm(n = n, mu = means, Sigma = cov_matrix)\n    colnames(batch) &lt;- names(means)\n\n    valid &lt;- batch[, \"AGE\"] &gt;= 18 &\n             batch[, \"CREAT_log\"] &lt; 5.991465 # log(400) corresponding to CRCL of 10 mL/min for a patient of 24 kg and 116 years\n\n    batch_valid &lt;- batch[valid, , drop = FALSE]\n    collected &lt;- rbind(collected, batch_valid)\n  }\n\n  collected[1:n, , drop = FALSE]\n}\n\nmeans &lt;- c(\n  CREAT_log = rambaud_creat$lnorm_par[\"meanlog\"],\n  WT_log      = rambaud_wt$lnorm_par[\"meanlog\"], \n  AGE     = rambaud_age$norm_par[\"mean\"],\n  HT_log      = rambaud_ht$lnorm_par[\"meanlog\"]\n)\n\nsds &lt;- c(\n  CREAT_log = rambaud_creat$lnorm_par[\"sdlog\"],\n  WT_log     = rambaud_wt$lnorm_par[\"sdlog\"],\n  AGE = rambaud_age$norm_par[\"sd\"],\n  HT_log     = rambaud_ht$lnorm_par[\"sdlog\"]\n)\n\ncovariates &lt;- c(\"CREAT_log\", \"WT_log\", \"AGE\", \"HT_log\")\n\nnames(means) &lt;- covariates\n\n# Correlation and Covariance Matrix\ncor_rambaud_M &lt;- cor_matrix_Rambaud_M[covariates, covariates]\ncov_matrix_M &lt;- diag(sds) %*% cor_rambaud_M %*% diag(sds)\neigen(cov_matrix_M)$values\n\n\n[1] 1.888441e+02 1.160604e-01 2.831560e-02 1.302147e-03\n\n\nShow the code\ncor_rambaud_F &lt;- cor_matrix_Rambaud_F[covariates, covariates]\ncov_matrix_F &lt;- diag(sds) %*% cor_rambaud_F %*% diag(sds)\neigen(cov_matrix_F)$values\n\n\n[1] 1.888465e+02 1.143105e-01 2.761902e-02 1.396003e-03\n\n\nShow the code\n# Simulate\nsim_data_M &lt;- correlated_simulation(n = 496, means = means, cov_matrix = cov_matrix_M)\nsim_data_M &lt;- as_tibble(sim_data_M) %&gt;%\n  mutate(SEX = 0)\n\nsim_data_F &lt;- correlated_simulation(n = 129, means = means, cov_matrix = cov_matrix_F)\nsim_data_F &lt;- as_tibble(sim_data_F) %&gt;%\n  mutate(SEX = 1)\n\nsim_data &lt;- rbind(sim_data_M, sim_data_F)\n\n# Put the covariates together\nsim_cov_rambaud &lt;- tibble(\n  Paper = \"Rambaud_2020\",\n  ID_within_paper = 1:n_patient,\n  ICU = 1,\n  BURN = 0,\n  OBESE = 0,\n  CREAT_log = sim_data$CREAT_log,\n  WT_log   = sim_data$WT_log,\n  AGE  = sim_data$AGE,\n  HT_log  = sim_data$HT_log,\n  SEX = sim_data$SEX)\n\nsim_cov_rambaud &lt;- sim_cov_rambaud %&gt;%\n  mutate(CREAT = exp(CREAT_log),\n         HT = exp(HT_log),\n         WT = exp(WT_log))\n\nsummary_sim_cov_rambaud &lt;- sim_cov_rambaud |&gt; \n  pivot_longer(cols = c(ICU,BURN,OBESE,CREAT,WT,AGE,HT),\n               names_to = \"Covariate\") |&gt; \n  summarise(.by = c(Covariate,Paper),\n            Min = min(value),\n            Q1 = quantile(value, 0.25),\n            Median = quantile(value, 0.5),\n            Q3 = quantile(value, 0.75),\n            Max = max(value))\n\n\n\n\nShow the code\ncov_rambaud_compare &lt;- summary_sim_cov_rambaud |&gt;\n  rename_with(~ paste0(.x, \"_sim\"), -one_of(\"Covariate\", \"Paper\")) |&gt;\n  left_join(rename_with(\n    cov_data_rambaud,\n    ~ paste0(.x, \"_true\"),\n    -one_of(\"Covariate\", \"Paper\", \"Unit\")\n  )) |&gt; \n  relocate(Covariate, .after = Paper) |&gt; \n  relocate(Unit, .after = Covariate)\n\ncov_rambaud_compare |&gt;\n  gt() |&gt;\n  fmt_scientific() |&gt; \n    tab_spanner(columns = starts_with(\"Min\"),\n              label = \"Min\") |&gt; \n      tab_spanner(columns = starts_with(\"Q1\"),\n              label = \"Q1\") |&gt; \n      tab_spanner(columns = starts_with(\"Median\"),\n              label = \"Median\") |&gt; \n      tab_spanner(columns = starts_with(\"Q3\"),\n              label = \"Q3\") |&gt; \n  tab_spanner(columns = starts_with(\"Max\"),\n              label = \"Max\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPaper\nCovariate\nUnit\n\nMin\n\n\nQ1\n\n\nMedian\n\n\nQ3\n\n\nMax\n\n\n\nMin_sim\nMin_true\nQ1_sim\nQ1_true\nMedian_sim\nMedian_true\nQ3_sim\nQ3_true\nMax_sim\nMax_true\n\n\n\n\nRambaud_2020\nICU\nUnitless\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n1.00\n\n\nRambaud_2020\nBURN\nUnitless\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n\n\nRambaud_2020\nOBESE\nUnitless\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n0.00\n\n\nRambaud_2020\nCREAT\nmicromol/L\n2.08 × 101\nNA\n6.79 × 101\n7.30 × 101\n8.67 × 101\n8.70 × 101\n1.12 × 102\n1.15 × 102\n3.08 × 102\nNA\n\n\nRambaud_2020\nWT\nkg\n4.13 × 101\nNA\n6.75 × 101\n6.90 × 101\n7.65 × 101\n7.60 × 101\n8.64 × 101\n8.70 × 101\n1.21 × 102\nNA\n\n\nRambaud_2020\nAGE\nyear\n1.97 × 101\nNA\n6.04 × 101\n6.20 × 101\n7.08 × 101\n7.20 × 101\n8.20 × 101\n8.05 × 101\n1.12 × 102\nNA\n\n\nRambaud_2020\nHT\ncm\n1.50 × 102\nNA\n1.64 × 102\n1.66 × 102\n1.69 × 102\n1.70 × 102\n1.75 × 102\n1.75 × 102\n1.96 × 102\nNA\n\n\n\n\n\n\n\n\n\nShow the code\nplot_sim_cov_wrapper(cov_data_rambaud,\"CREAT\",sim_cov_rambaud)\n\n\n\n\n\n\n\n\n\nShow the code\nplot_sim_cov_wrapper(cov_data_rambaud,\"WT\",sim_cov_rambaud)\n\n\n\n\n\n\n\n\n\nShow the code\nplot_sim_cov_wrapper(cov_data_rambaud,\"AGE\",sim_cov_rambaud)\n\n\n\n\n\n\n\n\n\nShow the code\nplot_sim_cov_wrapper(cov_data_rambaud,\"HT\",sim_cov_rambaud)\n\n\n\n\n\n\n\n\n\nCREAT is converted from micromol/L to mg/dL.\n\n\nShow the code\nsim_cov_rambaud &lt;- sim_cov_rambaud %&gt;%\n  mutate(\n    BSA = (WT^0.425 * (HT^0.725) * 0.007184),\n    CREAT = CREAT/88.4,\n    BMI = WT / (HT/100)^2,\n    OBESE = ifelse(BMI &gt; 30, 1, 0)\n  ) %&gt;%\n  dplyr::select(Paper, ID_within_paper, ICU, BURN, OBESE, CREAT, WT, BSA, BMI, AGE, SEX, HT)\n\n# Calculate the simulated correlation matrices separately for the two sexes to compare with the original\nsim_cov_rambaud_M &lt;- sim_cov_rambaud %&gt;% filter(SEX == 0)\nsim_cov_rambaud_F &lt;- sim_cov_rambaud %&gt;% filter(SEX == 1)\n\ncor_sim_M &lt;- cor(sim_cov_rambaud_M %&gt;% dplyr::select(WT, CREAT, AGE, HT, BMI), use = \"complete.obs\")\ncor_sim_F &lt;- cor(sim_cov_rambaud_F %&gt;% dplyr::select(WT, CREAT, AGE, HT, BMI), use = \"complete.obs\")\n\nggcorrplot(cor_matrix_Rambaud_F, lab = TRUE, title = \"Rambaud original (females)\")\n\n\n\n\n\n\n\n\n\nShow the code\nRambaud_F &lt;- ggcorrplot(cor_sim_F, lab = TRUE, title = \"Rambaud simulated (females)\")\nRambaud_F\n\n\n\n\n\n\n\n\n\nShow the code\nggcorrplot(cor_matrix_Rambaud_M, lab = TRUE, title = \"Rambaud original (males)\")\n\n\n\n\n\n\n\n\n\nShow the code\nRambaud_M &lt;- ggcorrplot(cor_sim_M, lab = TRUE, title = \"Rambaud simulated (males)\")\nRambaud_M",
    "crumbs": [
      "Simulations",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Covariate simulation</span>"
    ]
  },
  {
    "objectID": "Simulations/covariate_simulation.html#final-covariate-table",
    "href": "Simulations/covariate_simulation.html#final-covariate-table",
    "title": "5  Covariate simulation",
    "section": "5.7 Final covariate table",
    "text": "5.7 Final covariate table\nMake the final covariate dataset with 2500 sets of covariates in a way that in each 100 sets, we have 25-25 from each covariate’s cohort, as later, each dosing regimen will be simulated for 100 sets of covariates, and it is important that the 4 cohorts are equally represented.\nAlso, for the concentration simulation part, we have to know before applying the models, if a patient needs a different regiment due to his renal failure or not. That is why an additional IR column is added where 1 indicates a renal failure patient who needs a dose adjustement. For Carlier, the MDRD equation is used, and for Fournier, the Cockroft and Gault. For Mellon and Rambaud, all patients have 0 in the IR column, as it is not explicited in the articles that a dose adjustement was applied to renal failure patients.\n\n\nShow the code\n# Patchwork simulated correlation plots\ncorr_simulated &lt;- (Carlier_F + Fournier_F + Mellon_F + Rambaud_F +\n  Carlier_M + Fournier_M + Mellon_M + Rambaud_M) + \n  plot_layout(ncol = 4, nrow = 2, byrow = TRUE)\nggsave(filename = here(\"Figures/S5.jpg\"),\n       plot = corr_simulated,\n       width = 14, height = 8, dpi = 300)\n\n# Row-bind the datasets to have 25 subjects from each in a sample of 100\ndatasets &lt;- list(sim_cov_carlier, sim_cov_fournier, sim_cov_mellon, sim_cov_rambaud)\n\ninterleave_rows &lt;- function(datasets, chunk_size) {\n  n_chunks &lt;- nrow(datasets[[1]]) / chunk_size\n  interleaved &lt;- do.call(rbind, lapply(1:n_chunks, function(i) {\n    do.call(rbind, lapply(datasets, function(dataset) {\n      dataset[((i - 1) * chunk_size + 1):(i * chunk_size), ]\n    }))\n  }))\n  return(interleaved)\n}\n\nCOV &lt;- interleave_rows(datasets, chunk_size = 25)\n\n# Convert Paper column to MODEL_COHORT column which indicates the model that is used to simulated the covariates\nCOV &lt;- COV %&gt;%\n  mutate(MODEL_COHORT = case_when(\n    Paper == \"Carlier_2013\" ~ \"CARLIER\",\n    Paper == \"Fournier_2018\" ~ \"FOURNIER\",\n    Paper == \"Mellon_2020\" ~ \"MELLON\",\n    Paper == \"Rambaud_2020\" ~ \"RAMBAUD\")\n  )\n\n# Adding ID\nCOV$ID &lt;- seq(1:2500)\n\n# CRCL calculation functions\ncalculate_MDRD &lt;- function(AGE, CREAT, SEX) {\n  # Mutliply by 0.742 for females\n    sex_factor &lt;- ifelse(SEX == 0, 1, 0.742)\n    eGFR &lt;- 175 * (CREAT^(-1.154)) * AGE^(-0.203) * sex_factor\n    return(eGFR)\n}\n\ncalculate_CG &lt;- function(AGE, CREAT, SEX, WT) {\n  sex_factor &lt;- ifelse(SEX == 0, 1, 0.85)\n  eGFR &lt;- ((140 - AGE) * WT * sex_factor) / (CREAT * 72)\n  return(eGFR)\n}\n\n# Add 1 for dose adjustement for CRCL &lt; 30 mL/min for Carlier and Fournier\nCOV &lt;- COV %&gt;%\n  rowwise() %&gt;%\n  mutate(\n    CRCL = case_when(\n      MODEL_COHORT == \"CARLIER\" ~ calculate_MDRD(AGE, CREAT, SEX) * (BSA / 1.73),\n      MODEL_COHORT == \"FOURNIER\" ~ calculate_CG(AGE, CREAT, SEX, WT),\n      TRUE ~ NA_real_\n    ),\n    IR = case_when(\n      MODEL_COHORT == \"CARLIER\" & CRCL &lt; 30 ~ 1,\n      MODEL_COHORT == \"FOURNIER\" & CRCL &lt; 30 ~ 1,\n      MODEL_COHORT %in% c(\"MELLON\", \"RAMBAUD\") ~ 0,\n      TRUE ~ 0\n    )\n  ) %&gt;%\n  ungroup()\n\nCOV &lt;- COV %&gt;%\n  dplyr::select(ID, MODEL_COHORT, WT, CREAT, BURN, ICU, OBESE, BSA, AGE, SEX, HT, IR)\n\n# Export to csv\nwrite.csv(COV, here(\"Data/COV.csv\"), quote = F, row.names = F)\n\n# Check correlation (Pearson)\ncor_sim &lt;- cor(COV %&gt;% dplyr::select(WT, CREAT, BURN, ICU, OBESE, AGE, SEX, HT), use = \"complete.obs\")\nggcorrplot(cor_sim, lab = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\nCarlier, Mieke, Michaël Noë, Jan J De Waele, Veronique Stove, Alain G Verstraete, Jeffrey Lipman, and Jason A Roberts. 2013. “Population Pharmacokinetics and Dosing Simulations of Amoxicillin/Clavulanic Acid in Critically Ill Patients.” J. Antimicrob. Chemother. 68 (11): 2600–2608.\n\n\nFournier, Anne, Sylvain Goutelle, Yok-Ai Que, Philippe Eggimann, Olivier Pantet, Farshid Sadeghipour, Pierre Voirol, and Chantal Csajka. 2018. “Population Pharmacokinetic Study of Amoxicillin-Treated Burn Patients Hospitalized at a Swiss Tertiary-Care Center.” Antimicrobial Agents and Chemotherapy 62 (9): e00505–18. https://doi.org/10.1128/AAC.00505-18.\n\n\nJohnson, Alistair E W, Lucas Bulgarelli, Lu Shen, Alvin Gayles, Ayad Shammout, Steven Horng, Tom J Pollard, et al. 2023. “MIMIC-IV, a Freely Accessible Electronic Health Record Dataset.” Sci. Data 10 (1): 1.\n\n\nMellon, G, K Hammas, C Burdet, X Duval, C Carette, N El-Helali, L Massias, F Mentré, S Czernichow, and A -C Crémieux. 2020. “Population Pharmacokinetics and Dosing Simulations of Amoxicillin in Obese Adults Receiving Co-Amoxiclav.” Journal of Antimicrobial Chemotherapy 75 (12): 3611–18. https://doi.org/10.1093/jac/dkaa368.\n\n\nRambaud, Antoine, Benjamin Jean Gaborit, Colin Deschanvres, Paul Le Turnier, Raphaël Lecomte, Nathalie Asseray-Madani, Anne-Gaëlle Leroy, et al. 2020. “Development and Validation of a Dosing Nomogram for Amoxicillin in Infective Endocarditis.” The Journal of Antimicrobial Chemotherapy 75 (10): 2941–50. https://doi.org/10.1093/jac/dkaa232.",
    "crumbs": [
      "Simulations",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Covariate simulation</span>"
    ]
  },
  {
    "objectID": "Simulations/concentrations_simulation.html",
    "href": "Simulations/concentrations_simulation.html",
    "title": "6  Simulation of concentrations and secondary PK parameters",
    "section": "",
    "text": "6.1 Concentrations (PRED, IPRED, Y)\nThe objective is to simulate concentrations and secondary PK parameters (Cmax, Cmin & AUC) using 4 validated PopPK models for amoxicillin. The 4 papers are:\nThe original Rambaud model was non-parametric which was approximated using a parametric model (details in “Rambaud_validation.html”).\nThe only route of administration is intraveinous infusion.\nThree types of infusion are simulated:\nThere are 8 different dosing schemes. For each model cohort the dosing scheme that was in the original article is used for simulation. For patients with renal failure (IR = CRCL &lt; 30 mL/min), a different dosing scheme is applied if it is explicited in the articles (i. e. Carlier, Fournier). For Mellon, there was a single administration in the original model. To have a dosing scheme compatible with the clinical context in which we want to apply our methods, administration frequency is set to every 6 h for intermittent administrations. ID means a set of covariates, not a subject (to make data manipulation easier later).\n144 observations are simulated for each subject to have a sufficient number of observations after the first dose, as well as during a steady-state interdose interval. Observations are simulated for the period between the first and second doses and for the same duration for the first interdose interval that is entirely at steady-state. The number of observations has been determined to have at least three observations during the first interdose interval for all dosing schemes. For example, in the case of an intermittent infusion of 0.5 g q6h, there is an observation in each 5 minutes between 0 and 6 h & between 24 h and 30 h (if steady-state is reached at 22 h). This means, that not only the dosing grid changes for each dosing scheme, but the observation grid as well.\nFirst, the dataset needs to be created with all the information that mrgsolve needs for the simulation. In the function create_dosing_data, the input data is created for all the lines that contain an administered dose.\nThen, the information is created for all the lines, that do not contain a dose, but an observation. The latest possible time is 120 h, as amoxicillin has a short half life and all subjects have had a complete steady-state dosing interval by then.\nTo remove outliers, the non-physiological PK parameter values are resimulated (at most 100 times per value) using the simeta function of mrgsolve. A central volume of distribution smaller than 3 L (the volume of plasma) and a clearance higher than 180 L/h (normal blood flow) is considered non-physiological. (However, the maximum simulated clearance is around 100 L/h, so its resimulation is unnecessary.)\nSimulations are done using the mrgsolve models in .cpp format. To find the interdose interval which is entirely in steady-state, first, the time to reach steady state (TSS) has to be calculated. \\[\nK_{10} = \\frac{CL}{V_c}\n\\]\n\\[\nK_{12} = \\frac{Q}{V_c}\n\\]\n\\[\nK_{21} = \\frac{Q}{V_p}\n\\]\n\\[\nL_2 = \\frac{ \\left( K_{10} + K_{12} + K_{21} \\right) -\n\\sqrt{ \\left( K_{10} + K_{12} + K_{21} \\right)^2 - 4 K_{10} K_{21} } }{2}\n\\] \\[\nt_{1/2} = \\frac{ln(2)}{L_2}\n\\] We can consider that steady state is reached when the concentration is 90 % of the steady state concentration, which corresponds to a time of 3.3 times the half life ( as \\(1 - e^{(-k_e \\cdot t)} = 0.9\\) ).\nFirst, concentrations are simulated for all data points between 0 and 120 h, then the results are filtered to choose the first interdose interval and the first interdose interval entirely in steady-state.\nThen, the filtered dataset, and the covariates will be put together, and the observation and dosing grids will be simulated based on the functions defined earlier. The dosing scheme is added as three columns (DOSE, FREQuency, DURation). Each model control stream is used two times for each simulation. Once, to simulate IPRED and Y (and \\(Cmax_{\\text{ind}}\\), \\(Cmin_{\\text{ind}}\\) and \\(AUC_{\\text{ind}}\\) which are based on IPRED), then a second time, the omega matrix is set to 0 to simulate PRED (and CMAX_PRED and AUC_PRED based on PRED). PRED are typical concentrations which do not contain inter-individual variability. IPRED has inter-individual variability incorporated, and Y has both inter-and intra-individual variability.\n8 different dosing schemes are used depending on the model cohort.\nFinally, the simulations are done with each respective model, the results are merged and a MODEL column is added to identify the model used for the simulation of each concentration.\nBelow quantification limit observations are removed (M1 method). LLOQ concentrations for each model can be found in “mrgsolve/LLOQ.txt”.\nShow the code\nAMOX_SIM &lt;- all_results %&gt;%\n  select(ID, TIME, IPRED, Y, WT, CREAT, BURN, ICU, OBESE, AGE, SEX, HT, BSA, MODEL, MODEL_COHORT, DOSE_ADM, FREQ, DUR, Vc, CL, TSS) %&gt;%\n  distinct()\n\n# Dataset to plot CL\nsummarized_SIM &lt;- AMOX_SIM %&gt;%\n  distinct(ID, MODEL, CL, Vc)\n\n# Box plot for CL\nplot_CL &lt;- ggplot(summarized_SIM, aes(x = MODEL, y = CL, fill = MODEL)) +\n  geom_boxplot() +\n  theme_minimal() +\n  labs(title = \"Clearance distribution\", x = \"Model\", y = \"CL (L/h)\") +\n  theme(\n    axis.text.x = element_text(angle = 30, hjust = 1),\n    axis.text = element_text(size = 16),    \n    axis.title = element_text(size = 20), \n    plot.title = element_text(size=24),\n  )\n\nplot_CL\n\n\n\n\n\n\n\n\n\nShow the code\n# Box plot for Vc\nplot_V &lt;- ggplot(summarized_SIM, aes(x = MODEL, y = Vc, fill = MODEL)) +\n  geom_boxplot() +\n  theme_minimal() +\n  scale_y_log10() + \n  labs(title = \"Central volume distribution\", x = \"Model\", y = \"Vc (L)\") +\n  theme(\n    axis.text.x = element_text(angle = 30, hjust = 1),\n    axis.text = element_text(size = 16),    \n    axis.title = element_text(size = 20), \n    plot.title = element_text(size=24),\n  )\n\nplot_V",
    "crumbs": [
      "Simulations",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Simulation of concentrations and secondary PK parameters</span>"
    ]
  },
  {
    "objectID": "Simulations/concentrations_simulation.html#trough-concentration-cmin",
    "href": "Simulations/concentrations_simulation.html#trough-concentration-cmin",
    "title": "6  Simulation of concentrations and secondary PK parameters",
    "section": "6.2 Trough concentration (Cmin)",
    "text": "6.2 Trough concentration (Cmin)\nThe trough concentration is the last concentration for the steady-state interdose interval\n\n\nShow the code\n# Add CMIN column by taking the last steady-state concentration\nAMOX_CMIN1 &lt;- AMOX_SIM %&gt;%\n  group_by(ID, MODEL) %&gt;%\n  arrange(TIME) %&gt;%\n  mutate(CMIN_IND = last(IPRED[TIME == max(TIME)])) %&gt;%\n  slice_max(TIME, n = 1, with_ties = FALSE) %&gt;%\n  ungroup() %&gt;%\n  distinct(ID, MODEL, CMIN_IND, .keep_all = TRUE) %&gt;%\n  mutate(CON = ifelse(DUR == 24, 1, 0))\n\n  \n# Box plot for CL before removing the outliers\nplot_CMIN &lt;- ggplot(AMOX_CMIN1, aes(x = MODEL, y = CMIN_IND, fill = MODEL)) +\n  geom_boxplot() +\n  scale_y_log10() +\n  theme_minimal() +\n  labs(title = \"Cmin distribution\", x = \"Model\", y = \"Cmin (mg/L)\") +\n  theme(\n    axis.text.x = element_text(angle = 30, hjust = 1),\n    axis.text = element_text(size = 16),    \n    axis.title = element_text(size = 20), \n    plot.title = element_text(size=24),\n  )\n\nplot_CMIN\n\n\n\n\n\n\n\n\n\nShow the code\n# Create test data by taking 2400 subjects (24 from each dosing scheme and 6-6 for each model covariate cohorte per dosing scheme)\nCMIN_test &lt;- AMOX_CMIN1 %&gt;%\n  dplyr::filter(\n    ID %% 100 &gt;= 1 & ID %% 100 &lt;= 6 |\n      ID %% 100 &gt;= 26 & ID %% 100 &lt;= 31 |\n      ID %% 100 &gt;= 51 & ID %% 100 &lt;= 56 |\n      ID %% 100 &gt;= 76 & ID %% 100 &lt;= 81\n  )\n\n# Create training data by taking 7600 subjects (76 from each dosing scheme and 19-19 for each model covariate cohorte per dosing scheme)\nCMIN_train &lt;- AMOX_CMIN1 %&gt;%\n  dplyr::filter(\n    ID %% 100 &gt;= 7 & ID %% 100 &lt;= 25 |\n      ID %% 100 &gt;= 32 & ID %% 100 &lt;= 50 |\n      ID %% 100 &gt;= 57 & ID %% 100 &lt;= 75 |\n      ID %% 100 &gt;= 82 & ID %% 100 &lt;= 100\n  )\n\n# Dataset identifyer\nCMIN_train_compare &lt;- CMIN_train %&gt;% mutate(Dataset = \"Train\")\nCMIN_test_compare &lt;- CMIN_test %&gt;% mutate(Dataset = \"Test\")\n\n# Combine the three datasets\ncombined_CMIN &lt;- bind_rows(CMIN_train_compare, CMIN_test_compare)\n\n# Compare the train and test sets\nvars &lt;- c(\"CREAT\", \"WT\", \"CMIN_IND\", \"CL\", \"Vc\")\ntableOne5 &lt;- CreateTableOne(vars = vars, strata = \"Dataset\", data = combined_CMIN)\ntableOne6 &lt;- print(tableOne5, nonnormal = c(\"CREAT\", \"WT\", \"CMIN_IND\", \"CL\", \"Vc\"), printToggle=F, minMax=T)\n\nkableone(tableOne6)\n\n\n\n\n\n\n\n\n\n\n\n\n\nTest\nTrain\np\ntest\n\n\n\n\nn\n600\n1875\n\n\n\n\nCREAT (median [range])\n0.76 [0.24, 5.32]\n0.77 [0.13, 8.23]\n0.410\nnonnorm\n\n\nWT (median [range])\n80.03 [41.33, 139.60]\n79.99 [47.36, 141.17]\n0.884\nnonnorm\n\n\nCMIN_IND (median [range])\n3.03 [0.00, 201.92]\n2.96 [0.00, 443.50]\n0.539\nnonnorm\n\n\nCL (median [range])\n13.08 [0.68, 61.52]\n12.70 [1.08, 71.87]\n0.467\nnonnorm\n\n\nVc (median [range])\n9.60 [2.17, 38.10]\n9.42 [1.73, 51.90]\n0.312\nnonnorm\n\n\n\n\n\nShow the code\n# Export to csv\nwrite.csv(CMIN_train, here(\"Data/AMOX_CMIN_OBS_TRAIN.csv\"), row.names = FALSE, quote = FALSE)\nwrite.csv(CMIN_test, here(\"Data/AMOX_CMIN_OBS_TEST.csv\"), row.names = FALSE, quote = FALSE)",
    "crumbs": [
      "Simulations",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Simulation of concentrations and secondary PK parameters</span>"
    ]
  },
  {
    "objectID": "Simulations/concentrations_simulation.html#data-visualization-stratified-by-dosing-schemes",
    "href": "Simulations/concentrations_simulation.html#data-visualization-stratified-by-dosing-schemes",
    "title": "6  Simulation of concentrations and secondary PK parameters",
    "section": "6.3 Data visualization stratified by dosing schemes",
    "text": "6.3 Data visualization stratified by dosing schemes\nThe following graphs show the individual observed concentration-time curves for the data stratified by model. One graph shows the concentration-time curves for the first interdose interval and the other graph for the interdose interval after the dose which permits to reach steady state.\n\n\nShow the code\n# Add dosing scheme as a categorical variable (to separate dosing schemes)\ndata_ref &lt;- AMOX_SIM %&gt;%\n  mutate(DOSING_SCHEME = paste(\"FREQ:\", FREQ, \"DOSE:\", DOSE_ADM, \"DUR:\", DUR, sep = \" \"))\n\ndosing_schemes &lt;- unique(data_ref$DOSING_SCHEME)\n\n# Loop through each dosing scheme\nplot_dosing_schemes &lt;- function(data_ref, dosing_schemes) {\n  plot_list_before &lt;- list()\n  plot_list_after &lt;- list()\n  \n  for (i in seq_along(dosing_schemes)) {\n    scheme &lt;- dosing_schemes[i]\n    \n    # Extract FREQ (=interdose interval)\n    scheme_data &lt;- subset(data_ref, DOSING_SCHEME == scheme)\n    freq_value &lt;- unique(scheme_data$FREQ)\n    \n    \n    # Split data before and after SS\n    data_before &lt;- subset(scheme_data, TIME &lt;= freq_value)\n    data_after &lt;- subset(scheme_data, TIME &gt; TSS) %&gt;%\n      mutate(TIME = TIME - TSS)  # Adjust time so that it means time after SS dose\n    \n    # Plot for before SS\n    plot_list_before[[i]] &lt;- ggplot(data_before, aes(x = TIME, y = IPRED, color = MODEL, group = ID)) +\n      geom_line() + \n      facet_wrap(~MODEL) +\n      theme_minimal() + \n      labs(\n        title = paste(\"First interdose interval\", freq_value, scheme),\n        x = \"Time (h)\",\n        y = \"IPRED (mg/L)\",\n        color = \"MODEL\"\n      ) +\n      theme(\n        plot.title = element_text(size=10),\n        strip.text = element_text(size = 8), \n        axis.text = element_text(size = 8),\n        legend.position = \"none\"\n      )\n    \n    # Plot for after SS is reached\n    plot_list_after[[i]] &lt;- ggplot(data_after, aes(x = TIME, y = IPRED, color = MODEL, group = ID)) +\n      geom_line() + \n      facet_wrap(~MODEL) +\n      theme_minimal() + \n      labs(\n        title = paste(\"Steady-state\", freq_value, scheme),\n        x = \"Time after steady-state dose (h)\",\n        y = \"IPRED (mg/L)\",\n        color = \"MODEL\"\n      ) +\n      theme(\n        plot.title = element_text(size=10),\n        strip.text = element_text(size = 8), \n        axis.text = element_text(size = 8),\n        legend.position = \"none\"\n      )\n  }\n  \n  list(before = plot_list_before, after = plot_list_after)\n}\n\nconc_profile_plots &lt;- plot_dosing_schemes(data_ref, dosing_schemes)\nconc_profile_plots\n\n\n$before\n$before[[1]]\n\n\n\n\n\n\n\n\n\n\n$before[[2]]\n\n\n\n\n\n\n\n\n\n\n$before[[3]]\n\n\n\n\n\n\n\n\n\n\n$before[[4]]\n\n\n\n\n\n\n\n\n\n\n$before[[5]]\n\n\n\n\n\n\n\n\n\n\n$before[[6]]\n\n\n\n\n\n\n\n\n\n\n$before[[7]]\n\n\n\n\n\n\n\n\n\n\n$before[[8]]\n\n\n\n\n\n\n\n\n\n\n$before[[9]]\n\n\n\n\n\n\n\n\n\n\n\n$after\n$after[[1]]\n\n\n\n\n\n\n\n\n\n\n$after[[2]]\n\n\n\n\n\n\n\n\n\n\n$after[[3]]\n\n\n\n\n\n\n\n\n\n\n$after[[4]]\n\n\n\n\n\n\n\n\n\n\n$after[[5]]\n\n\n\n\n\n\n\n\n\n\n$after[[6]]\n\n\n\n\n\n\n\n\n\n\n$after[[7]]\n\n\n\n\n\n\n\n\n\n\n$after[[8]]\n\n\n\n\n\n\n\n\n\n\n$after[[9]]\n\n\n\n\n\n\n\n\n\nVisualization of 5th, 50th and 95th percentiles (5th and 95th percentiles in dashed)\n\n\nShow the code\n# The data is binned to 40 bins to make it smoother\ndata_percentiles_ref &lt;- data_ref %&gt;% filter(TIME &gt; TSS) %&gt;%\n      mutate(TIME = TIME - TSS) |&gt; \n  mutate(TIME_bin = ntile(TIME, 40)) %&gt;%\n  group_by(DOSING_SCHEME, MODEL, TIME_bin) %&gt;%\n  summarise(\n    P5 = quantile(IPRED, 0.05, na.rm = TRUE),\n    P50 = quantile(IPRED, 0.50, na.rm = TRUE),\n    P95 = quantile(IPRED, 0.95, na.rm = TRUE),\n    TIME = median(TIME, na.rm = TRUE),\n    .groups = 'drop'\n  )\n\n# Loop through each dosing scheme\nplot_percentiles &lt;- function(data_percentiles_ref, dosing_schemes) {\n  library(ggplot2)\n  library(patchwork)\n  \n  plot_list_ref &lt;- list()\n  \n  for (i in seq_along(dosing_schemes)) {\n    plot_list_ref[[i]] &lt;- ggplot(\n      subset(data_percentiles_ref, DOSING_SCHEME == dosing_schemes[i]),\n      aes(x = TIME)\n    ) +\n      geom_line(aes(y = P5, color = MODEL), linetype = \"dashed\") +\n      geom_line(aes(y = P50, color = MODEL), size = 1) +\n      geom_line(aes(y = P95, color = MODEL), linetype = \"dashed\") +\n      theme_minimal() +\n      labs(\n        title = paste(dosing_schemes[i]),\n        x = \"Time post steady-state (binned)\",\n        y = \"IPRED (mg/L)\",\n        color = \"MODEL\"\n      ) +\n      theme(\n        plot.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        strip.text = element_text(size = 8),\n        legend.position = \"bottom\"\n      )\n  }\n  \n  return(plot_list_ref)\n}\n\n\npercentile_plots &lt;- plot_percentiles(data_percentiles_ref, dosing_schemes)",
    "crumbs": [
      "Simulations",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Simulation of concentrations and secondary PK parameters</span>"
    ]
  },
  {
    "objectID": "Simulations/concentrations_simulation.html#appendix-what-if-you-were-interested-in-something-else-than-cmin",
    "href": "Simulations/concentrations_simulation.html#appendix-what-if-you-were-interested-in-something-else-than-cmin",
    "title": "6  Simulation of concentrations and secondary PK parameters",
    "section": "6.4 Appendix : What if you were interested in something else than Cmin ?",
    "text": "6.4 Appendix : What if you were interested in something else than Cmin ?\n\n6.4.1 Exposure (AUC)\nAUC is calculated based on the sum of the integrals of IPRED values and cumulated for both the steady-state and non stead-state inter-dose interval.\n\n\nShow the code\nAMOX_AUC1 &lt;- all_results %&gt;%\n  group_by(ID, MODEL) %&gt;% \n  summarize(\n    ID = first(ID),\n    MODEL = first(MODEL),\n    MODEL_COHORT = first(MODEL_COHORT),\n    AUC_IND = sum(AUC, na.rm = TRUE), #total AUC (based on IPRED)\n    WT = first(WT),    \n    CREAT = first(CREAT), \n    BURN = first(BURN),\n    ICU = first(ICU),\n    OBESE = first(OBESE),\n    AGE = first(AGE),\n    SEX = first(SEX),\n    HT = first(HT),\n    DUR = first(DUR),\n    FREQ = first(FREQ),\n    DOSE_ADM = first(DOSE_ADM),\n    TSS = first(TSS),\n    Vc = first(Vc),\n    CL = first(CL)\n  )\n\nsummarized_AUC &lt;- AMOX_AUC1 %&gt;%\n  distinct(ID, MODEL, AUC_IND) \n\n# Box plot for AUC\nplot_AUC &lt;- ggplot(summarized_AUC, aes(x = MODEL, y = AUC_IND, fill = MODEL)) +\n  geom_boxplot() +\n  scale_y_log10() +\n  theme_minimal() +\n  labs(title = \"AUC distribution\", x = \"Model\", y = \"AUC (mg.h/L)\") +\n  theme(\n    axis.text.x = element_text(angle = 30, hjust = 1),\n    axis.text = element_text(size = 16),    \n    axis.title = element_text(size = 20), \n    plot.title = element_text(size=24),\n  )\n\nplot_AUC\n\n\n\n\n\n\n\n\n\nShow the code\n# Create test data by taking 2400 subjects (24 from each dosing scheme and 6-6 for each model covariate cohorte per dosing scheme)\nAUC_test &lt;- AMOX_AUC1 %&gt;%\n  dplyr::filter(\n    ID %% 100 &gt;= 1 & ID %% 100 &lt;= 6 |\n      ID %% 100 &gt;= 26 & ID %% 100 &lt;= 31 |\n      ID %% 100 &gt;= 51 & ID %% 100 &lt;= 56 |\n      ID %% 100 &gt;= 76 & ID %% 100 &lt;= 81\n  )\n\n# Create training data by taking 7600 subjects (76 from each dosing scheme and 19-19 for each model covariate cohorte per dosing scheme)\nAUC_train &lt;- AMOX_AUC1 %&gt;%\n  dplyr::filter(\n    ID %% 100 &gt;= 7 & ID %% 100 &lt;= 25 |\n      ID %% 100 &gt;= 32 & ID %% 100 &lt;= 50 |\n      ID %% 100 &gt;= 57 & ID %% 100 &lt;= 75 |\n      ID %% 100 &gt;= 82 & ID %% 100 &lt;= 100\n  )\n\n# Dataset identifyer\nAUC_train_compare &lt;- AUC_train %&gt;% mutate(Dataset = \"Train\")\nAUC_test_compare &lt;- AUC_test %&gt;% mutate(Dataset = \"Test\")\n\n# Combine the three datasets\ncombined_AUC &lt;- bind_rows(AUC_train_compare, AUC_test_compare)\n\n# Compare the train and test sets\nvars &lt;- c(\"CREAT\", \"WT\", \"AUC_IND\", \"CL\", \"Vc\")\ntableOne &lt;- CreateTableOne(vars = vars, strata = \"Dataset\", data = combined_AUC)\ntableOne2 &lt;- print(tableOne, nonnormal = c(\"CREAT\", \"WT\", \"AUC_IND\", \"CL\", \"Vc\"), printToggle=F, minMax=T)\n\nkableone(tableOne2)\n\n\n\n\n\n\n\n\n\n\n\n\n\nTest\nTrain\np\ntest\n\n\n\n\nn\n600\n1875\n\n\n\n\nCREAT (median [range])\n0.76 [0.24, 5.32]\n0.77 [0.13, 8.23]\n0.410\nnonnorm\n\n\nWT (median [range])\n80.03 [41.33, 139.60]\n79.99 [47.36, 141.17]\n0.884\nnonnorm\n\n\nAUC_IND (median [range])\n39901.06 [7690.40, 1939532.48]\n39701.47 [6336.94, 2247745.51]\n0.926\nnonnorm\n\n\nCL (median [range])\n13.08 [0.68, 61.52]\n12.70 [1.08, 71.87]\n0.462\nnonnorm\n\n\nVc (median [range])\n9.60 [2.17, 38.10]\n9.42 [1.73, 51.90]\n0.312\nnonnorm\n\n\n\n\n\n\n\n6.4.2 Maximal concentration (Cmax)\nCmax is the true Cmax, not the highest observed concentration.\n\n\nShow the code\nAMOX_CMAX1 &lt;- all_results %&gt;%\n  group_by(ID, MODEL) %&gt;% \n  summarize(\n    ID = first(ID),\n    MODEL = first(MODEL),\n    MODEL_COHORT = first(MODEL_COHORT),\n    CMAX_IND = max(Cmax, na.rm = TRUE),  # Cmax based on IPRED\n    WT = first(WT), \n    CREAT = first(CREAT), \n    BURN = first(BURN),\n    ICU = first(ICU),\n    OBESE = first(OBESE),\n    AGE = first(AGE),\n    SEX = first(SEX),\n    HT = first(HT),\n    DUR = first(DUR),\n    FREQ = first(FREQ),\n    DOSE_ADM = first(DOSE_ADM),\n    TSS = first(TSS),\n    Vc = first(Vc),\n    CL = first(CL)\n  ) %&gt;%\n  mutate(CON = ifelse(DUR == 24, 1, 0))\n\nsummarized_CMAX &lt;- AMOX_CMAX1 %&gt;%\n  distinct(ID, MODEL, CMAX_IND)\n\n# Box plot for Cmax\nplot_CMAX &lt;- ggplot(summarized_CMAX, aes(x = MODEL, y = CMAX_IND, fill = MODEL)) +\n  geom_boxplot() +\n  theme_minimal() +\n  labs(title = \"Cmax distribution\", x = \"Model\", y = \"Cmax (mg/L)\") +\n  theme(\n    axis.text.x = element_text(angle = 30, hjust = 1),\n    axis.text = element_text(size = 16),    \n    axis.title = element_text(size = 20), \n    plot.title = element_text(size=24),\n  )\n\nplot_CMAX\n\n\n\n\n\n\n\n\n\nShow the code\n# Create test data by taking 2400 subjects (24 from each dosing scheme and 6-6 for each model covariate cohorte per dosing scheme)\nCMAX_test &lt;- AMOX_CMAX1 %&gt;%\n  dplyr::filter(\n    ID %% 100 &gt;= 1 & ID %% 100 &lt;= 6 |\n      ID %% 100 &gt;= 26 & ID %% 100 &lt;= 31 |\n      ID %% 100 &gt;= 51 & ID %% 100 &lt;= 56 |\n      ID %% 100 &gt;= 76 & ID %% 100 &lt;= 81\n  )\n\n# Create training data by taking 7600 subjects (76 from each dosing scheme and 19-19 for each model covariate cohorte per dosing scheme)\nCMAX_train &lt;- AMOX_CMAX1 %&gt;%\n  dplyr::filter(\n    ID %% 100 &gt;= 7 & ID %% 100 &lt;= 25 |\n      ID %% 100 &gt;= 32 & ID %% 100 &lt;= 50 |\n      ID %% 100 &gt;= 57 & ID %% 100 &lt;= 75 |\n      ID %% 100 &gt;= 82 & ID %% 100 &lt;= 100\n  )\n\n# Dataset identifier\nCMAX_train_compare &lt;- CMAX_train %&gt;% mutate(Dataset = \"Train\")\nCMAX_test_compare &lt;- CMAX_test %&gt;% mutate(Dataset = \"Test\")\n\n# Combine the three datasets\ncombined_CMAX &lt;- bind_rows(CMAX_train_compare, CMAX_test_compare)\n\n# Compare the train and test sets\nvars &lt;- c(\"CREAT\", \"WT\", \"CMAX_IND\", \"CL\", \"Vc\")\ntableOne3 &lt;- CreateTableOne(vars = vars, strata = \"Dataset\", data = combined_CMAX)\ntableOne4&lt;-print(tableOne3, nonnormal = c(\"CREAT\", \"WT\", \"CMAX_IND\", \"CL\", \"Vc\"), printToggle=F, minMax=T)\n\nkableone(tableOne4)\n\n\n\n\n\n\n\n\n\n\n\n\n\nTest\nTrain\np\ntest\n\n\n\n\nn\n600\n1875\n\n\n\n\nCREAT (median [range])\n0.76 [0.24, 5.32]\n0.77 [0.13, 8.23]\n0.410\nnonnorm\n\n\nWT (median [range])\n80.03 [41.33, 139.60]\n79.99 [47.36, 141.17]\n0.884\nnonnorm\n\n\nCMAX_IND (median [range])\n56.16 [13.38, 289.41]\n57.91 [8.12, 443.50]\n0.138\nnonnorm\n\n\nCL (median [range])\n13.08 [0.68, 61.52]\n12.70 [1.08, 71.87]\n0.462\nnonnorm\n\n\nVc (median [range])\n9.60 [2.17, 38.10]\n9.42 [1.73, 51.90]\n0.312\nnonnorm\n\n\n\n\n\n\n\n\n\nCarlier, Mieke, Michaël Noë, Jan J De Waele, Veronique Stove, Alain G Verstraete, Jeffrey Lipman, and Jason A Roberts. 2013. “Population Pharmacokinetics and Dosing Simulations of Amoxicillin/Clavulanic Acid in Critically Ill Patients.” J. Antimicrob. Chemother. 68 (11): 2600–2608.\n\n\nFournier, Anne, Sylvain Goutelle, Yok-Ai Que, Philippe Eggimann, Olivier Pantet, Farshid Sadeghipour, Pierre Voirol, and Chantal Csajka. 2018. “Population Pharmacokinetic Study of Amoxicillin-Treated Burn Patients Hospitalized at a Swiss Tertiary-Care Center.” Antimicrobial Agents and Chemotherapy 62 (9): e00505–18. https://doi.org/10.1128/AAC.00505-18.\n\n\nMellon, G, K Hammas, C Burdet, X Duval, C Carette, N El-Helali, L Massias, F Mentré, S Czernichow, and A -C Crémieux. 2020. “Population Pharmacokinetics and Dosing Simulations of Amoxicillin in Obese Adults Receiving Co-Amoxiclav.” Journal of Antimicrobial Chemotherapy 75 (12): 3611–18. https://doi.org/10.1093/jac/dkaa368.\n\n\nRambaud, Antoine, Benjamin Jean Gaborit, Colin Deschanvres, Paul Le Turnier, Raphaël Lecomte, Nathalie Asseray-Madani, Anne-Gaëlle Leroy, et al. 2020. “Development and Validation of a Dosing Nomogram for Amoxicillin in Infective Endocarditis.” The Journal of Antimicrobial Chemotherapy 75 (10): 2941–50. https://doi.org/10.1093/jac/dkaa232.",
    "crumbs": [
      "Simulations",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Simulation of concentrations and secondary PK parameters</span>"
    ]
  },
  {
    "objectID": "Simulations/references.html",
    "href": "Simulations/references.html",
    "title": "References",
    "section": "",
    "text": "Agema, Bram C, Tolra Kocher, Ayşenur B Öztürk, Eline L Giraud, Nielka P\nvan Erp, Brenda C M de Winter, Ron H J Mathijssen, Stijn L W Koolen,\nBirgit C P Koch, and Sebastiaan D T Sassen. 2024. “Selecting the\nBest Pharmacokinetic Models for a Priori Model-Informed Precision Dosing\nwith Model Ensembling.” Clin. Pharmacokinet. 63 (10):\n1449–61.\n\n\nCarlier, Mieke, Michaël Noë, Jan J De Waele, Veronique Stove, Alain G\nVerstraete, Jeffrey Lipman, and Jason A Roberts. 2013. “Population\nPharmacokinetics and Dosing Simulations of Amoxicillin/Clavulanic Acid\nin Critically Ill Patients.” J. Antimicrob. Chemother.\n68 (11): 2600–2608.\n\n\nFournier, Anne, Sylvain Goutelle, Yok-Ai Que, Philippe Eggimann, Olivier\nPantet, Farshid Sadeghipour, Pierre Voirol, and Chantal Csajka. 2018.\n“Population Pharmacokinetic Study of Amoxicillin-Treated Burn\nPatients Hospitalized at a Swiss Tertiary-Care Center.”\nAntimicrobial Agents and Chemotherapy 62 (9): e00505–18. https://doi.org/10.1128/AAC.00505-18.\n\n\nGuilhaumou, Romain, Sihem Benaboud, Youssef Bennis, Claire\nDahyot-Fizelier, Eric Dailly, Peggy Gandia, Sylvain Goutelle, et al.\n2019. “Optimization of the Treatment with Beta-Lactam Antibiotics\nin Critically Ill Patients-Guidelines from the French Society of\nPharmacology and Therapeutics (Société\nFrançaise de Pharmacologie Et Thérapeutique-SFPT) and the French Society of\nAnaesthesia and Intensive Care Medicine\n(Société Française\nd’anesthésie Et Réanimation-SFAR).” Crit.\nCare 23 (1): 104.\n\n\nJohnson, Alistair E W, Lucas Bulgarelli, Lu Shen, Alvin Gayles, Ayad\nShammout, Steven Horng, Tom J Pollard, et al. 2023.\n“MIMIC-IV, a Freely Accessible Electronic Health\nRecord Dataset.” Sci. Data 10 (1): 1.\n\n\nMellon, G, K Hammas, C Burdet, X Duval, C Carette, N El-Helali, L\nMassias, F Mentré, S Czernichow, and A -C Crémieux. 2020.\n“Population Pharmacokinetics and Dosing Simulations of Amoxicillin\nin Obese Adults Receiving Co-Amoxiclav.” Journal of\nAntimicrobial Chemotherapy 75 (12): 3611–18. https://doi.org/10.1093/jac/dkaa368.\n\n\nRambaud, Antoine, Benjamin Jean Gaborit, Colin Deschanvres, Paul Le\nTurnier, Raphaël Lecomte, Nathalie Asseray-Madani, Anne-Gaëlle Leroy, et\nal. 2020. “Development and Validation of a Dosing Nomogram for\nAmoxicillin in Infective Endocarditis.” The Journal of\nAntimicrobial Chemotherapy 75 (10): 2941–50. https://doi.org/10.1093/jac/dkaa232.",
    "crumbs": [
      "Simulations",
      "References"
    ]
  },
  {
    "objectID": "MIPD/Objectives.html",
    "href": "MIPD/Objectives.html",
    "title": "7  Objectives",
    "section": "",
    "text": "To compare the capacity of different MIPD approaches to predict (first) dose to obtain target concentrations of 40-80 mg.\\(L^{-1}\\) based on the patient’s covariates.\n\n8 Judgement criteria\nThe proportion of subjects whose predicted dose allows for obtaining concentrations in the target interval of 40-80 mg.\\(L^{-1}\\) (target interval is based on the guidelines of SFPT - the French Society of Pharmacology and Therapeutics Guilhaumou et al. (2019)). For patients, whose extrapolated dose to reach 40 mg/L was higher than 20 g, the ability to predict the fact that the dose is above 20 g was evaluated.\n\n\n9 Context\nNumerous MIPD approaches have already been developed to predict a posteriori concentrations. Application of the a priori approaches developed in this project could help certain patients to reach target concentrations interval faster this way improving clinical results and to reduce the number of necessary blood samples.\n\n\n\n\nGuilhaumou, Romain, Sihem Benaboud, Youssef Bennis, Claire Dahyot-Fizelier, Eric Dailly, Peggy Gandia, Sylvain Goutelle, et al. 2019. “Optimization of the Treatment with Beta-Lactam Antibiotics in Critically Ill Patients-Guidelines from the French Society of Pharmacology and Therapeutics (Société Française de Pharmacologie Et Thérapeutique-SFPT) and the French Society of Anaesthesia and Intensive Care Medicine (Société Française d’anesthésie Et Réanimation-SFAR).” Crit. Care 23 (1): 104.",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Objectives</span>"
    ]
  },
  {
    "objectID": "MIPD/Precision_dosing_methods.html",
    "href": "MIPD/Precision_dosing_methods.html",
    "title": "8  Precision dosing approaches",
    "section": "",
    "text": "9 Generate predictions with each model\nShow the code\nAMOX_CMIN_OBS_TRAIN &lt;- read.csv(here(\"Data/AMOX_CMIN_OBS_TRAIN.csv\"), quote = \"\") |&gt; \n  mutate(\n    SEX_CAT = case_when(\n      SEX == 0 ~ \"M\",\n      SEX == 1 ~ \"F\"\n    )\n  ) |&gt;\n  rowwise() |&gt; \n  mutate(CRCL_CKD_EPI_BSA_NORM = estimate_GFR(AGE,CREAT,SEX_CAT)) |&gt; \n  ungroup() |&gt; \n  mutate(CRCL_CKD_EPI_ABSOLUTE = CRCL_CKD_EPI_BSA_NORM * (BSA/1.73))\n\nAMOX_CMIN_OBS_TEST &lt;- read.csv(here(\"Data/AMOX_CMIN_OBS_TEST.csv\"), quote = \"\") |&gt; \n  mutate(\n    SEX_CAT = case_when(\n      SEX == 0 ~ \"M\",\n      SEX == 1 ~ \"F\"\n    )\n  ) |&gt;\n  rowwise() |&gt; \n  mutate(CRCL_CKD_EPI_BSA_NORM = estimate_GFR(AGE,CREAT,SEX_CAT)) |&gt; \n  ungroup() |&gt; \n  mutate(CRCL_CKD_EPI_ABSOLUTE = CRCL_CKD_EPI_BSA_NORM * (BSA/1.73))\nShow the code\nperform_mrgsolve_prediction &lt;- function(input_data,\n                                        mrgsolve_model_path,\n                                        model_name,\n                                        cmin_target) {\n  \n  full_data &lt;- select(input_data,-MODEL) #MODEL column identifies the model with which the prediction was made thus we have to drop it to be able to join later on\n\ndata_for_mrgsolve &lt;- input_data |&gt;\n  select(\n    ID,\n    TIME,\n    CREAT,\n    BURN,\n    ICU,\n    OBESE,\n    AGE,\n    SEX,\n    HT,\n    BSA,\n    DOSE_ADM,\n    FREQ,\n    DUR,\n    CMIN_IND,\n    MODEL_COHORT\n  ) |&gt; distinct()\n\nmrgsolve_model &lt;- mread_cache(mrgsolve_model_path)\n\nmrgsolve_dose_data &lt;- \n      rename(data_for_mrgsolve,\n           AMT = DOSE_ADM,\n           II = FREQ\n           ) |&gt; \n  mutate(RATE = AMT/DUR,\n         ADDL = TIME/II - 1,\n         TIME = 0,\n         EVID = 1,\n         CMT = 1)\n\nmrgsolve_obs_data &lt;- rename(data_for_mrgsolve,\n           AMT = DOSE_ADM,\n           II = FREQ\n           ) |&gt; \n  mutate(RATE = NA,\n         ADDL = NA,\n         EVID = 0,\n         CMT = 1)\n  \nmrgsolve_input_data &lt;- bind_rows(mrgsolve_dose_data,\n                                        mrgsolve_obs_data) |&gt; \n  arrange(ID,-EVID)\n\nmrgsolve_model |&gt; \n  data_set(mrgsolve_input_data) |&gt; \n  zero_re() |&gt;  \n  mrgsim(obsonly = TRUE,\n         recover = colnames(mrgsolve_input_data)) |&gt;\n  as_tibble() |&gt; \n  rename(CMIN_PRED = IPRED) |&gt; \n  mutate(MODEL = model_name) |&gt; \n  select(ID,MODEL,CMIN_PRED) |&gt; \n  right_join(full_data) |&gt; \n  mutate(DOSE_PRED = cmin_target/CMIN_PRED * DOSE_ADM)\n  \n}",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "MIPD/Precision_dosing_methods.html#carlier",
    "href": "MIPD/Precision_dosing_methods.html#carlier",
    "title": "8  Precision dosing approaches",
    "section": "9.1 CARLIER",
    "text": "9.1 CARLIER\n\n\nShow the code\nAMOX_CMIN_PRED_TRAIN_CARLIER &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TRAIN ,\n  mrgsolve_model_path = here(\n    \"Simulations/amox_Carlier\"\n  ),\n  model_name = \"CARLIER\",\n  cmin_target = 60 #mg/L\n) \n\nAMOX_CMIN_PRED_TEST_CARLIER &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TEST ,\n  mrgsolve_model_path = here(\n    \"Simulations/amox_Carlier\"\n  ),\n  model_name = \"CARLIER\",\n  cmin_target = 60 #mg/L\n)",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "MIPD/Precision_dosing_methods.html#fournier",
    "href": "MIPD/Precision_dosing_methods.html#fournier",
    "title": "8  Precision dosing approaches",
    "section": "9.2 FOURNIER",
    "text": "9.2 FOURNIER\n\n\nShow the code\nAMOX_CMIN_PRED_TRAIN_FOURNIER &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TRAIN ,\n  mrgsolve_model_path = here(\n    \"Simulations/amox_Fournier\"\n  ),\n  model_name = \"FOURNIER\",\n  cmin_target = 60 #mg/L\n) \n\nAMOX_CMIN_PRED_TEST_FOURNIER &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TEST ,\n  mrgsolve_model_path = here(\n    \"Simulations/amox_Fournier\"\n  ),\n  model_name = \"FOURNIER\",\n  cmin_target = 60 #mg/L\n)",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "MIPD/Precision_dosing_methods.html#mellon",
    "href": "MIPD/Precision_dosing_methods.html#mellon",
    "title": "8  Precision dosing approaches",
    "section": "9.3 MELLON",
    "text": "9.3 MELLON\n\n\nShow the code\nAMOX_CMIN_PRED_TRAIN_MELLON &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TRAIN ,\n  mrgsolve_model_path = here(\n    \"Simulations/amox_Mellon\"\n  ),\n  model_name = \"MELLON\",\n  cmin_target = 60 #mg/L\n) \n\nAMOX_CMIN_PRED_TEST_MELLON &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TEST ,\n  mrgsolve_model_path = here(\n    \"Simulations/amox_Mellon\"\n  ),\n  model_name = \"MELLON\",\n  cmin_target = 60 #mg/L\n)",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "MIPD/Precision_dosing_methods.html#rambaud",
    "href": "MIPD/Precision_dosing_methods.html#rambaud",
    "title": "8  Precision dosing approaches",
    "section": "9.4 RAMBAUD",
    "text": "9.4 RAMBAUD\n\n\nShow the code\nAMOX_CMIN_PRED_TRAIN_RAMBAUD &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TRAIN ,\n  mrgsolve_model_path = here(\n    \"Simulations/amox_Rambaud\"\n  ),\n  model_name = \"RAMBAUD\",\n  cmin_target = 60 #mg/L\n) \n\nAMOX_CMIN_PRED_TEST_RAMBAUD &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TEST ,\n  mrgsolve_model_path = here(\n    \"Simulations/amox_Rambaud\"\n  ),\n  model_name = \"RAMBAUD\",\n  cmin_target = 60 #mg/L\n)",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "MIPD/Precision_dosing_methods.html#pool-all-predictions-and-save-them",
    "href": "MIPD/Precision_dosing_methods.html#pool-all-predictions-and-save-them",
    "title": "8  Precision dosing approaches",
    "section": "9.5 Pool all predictions and save them",
    "text": "9.5 Pool all predictions and save them\n\n\nShow the code\nAMOX_CMIN_TRAIN &lt;- bind_rows(\n  AMOX_CMIN_PRED_TRAIN_CARLIER,\n  AMOX_CMIN_PRED_TRAIN_FOURNIER,\n  AMOX_CMIN_PRED_TRAIN_MELLON,\n  AMOX_CMIN_PRED_TRAIN_RAMBAUD\n  ) |&gt; \n  arrange(ID,MODEL) |&gt; \n  mutate(REFERENCE = if_else(MODEL == MODEL_COHORT, 1, 0)) # Add a variable called REFERENCE which is 1 for the the line where the model used for simulation is the same as the model cohort (otherwise 0) and take only observed values\n\nwrite.csv(AMOX_CMIN_TRAIN, here(\"Data/AMOX_CMIN_TRAIN.csv\"), row.names = FALSE, quote = FALSE)\n\nAMOX_CMIN_TEST &lt;- bind_rows(\n  AMOX_CMIN_PRED_TEST_CARLIER,\n  AMOX_CMIN_PRED_TEST_FOURNIER,\n  AMOX_CMIN_PRED_TEST_MELLON,\n  AMOX_CMIN_PRED_TEST_RAMBAUD\n  ) |&gt; \n  arrange(ID,MODEL) |&gt; \n  mutate(REFERENCE = if_else(MODEL == MODEL_COHORT, 1, 0)) # Add a variable called REFERENCE which is 1 for the the line where the model used for simulation is the same as the model cohort (otherwise 0) and take only observed values\n\nwrite.csv(AMOX_CMIN_TEST, here(\"Data/AMOX_CMIN_TEST.csv\"), row.names = FALSE, quote = FALSE)",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "MIPD/Precision_dosing_methods.html#global-inspection-of-model-predictions",
    "href": "MIPD/Precision_dosing_methods.html#global-inspection-of-model-predictions",
    "title": "8  Precision dosing approaches",
    "section": "9.6 Global inspection of model predictions",
    "text": "9.6 Global inspection of model predictions\n\n9.6.1 Within-cohort performance (inter-individual variability)\nVisualization of the inter-individual variability of models by dividing PRED (predicted) values by IPRED (observed) both generated by the same model.\n\n\nShow the code\n# CMIN\n# Divide each PRED by the IPRED reference \nAMOX_CMIN2 &lt;- bind_rows(AMOX_CMIN_TRAIN,AMOX_CMIN_TEST) %&gt;%\n  filter(REFERENCE == 1) |&gt; \n  group_by(ID, MODEL) %&gt;%\n  mutate(\n    ratio = (CMIN_PRED / CMIN_IND) * 100\n  ) %&gt;%\n  ungroup()\n\n# Boxplot of ratios stratified by model\nstratified_ratios_CMIN &lt;- ggplot(AMOX_CMIN2, aes(x = MODEL, y = ratio, fill = MODEL)) +\n  geom_boxplot() +\n  geom_hline(yintercept = 80, linetype = \"dashed\", color = \"red\") + \n  geom_hline(yintercept = 125, linetype = \"dashed\", color = \"red\") +\n  labs(\n    title = \"Predicted/observed ratios for the same model (Cmax)\",\n    x = \"MODEL\",\n    y = \"Ratio (%)\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  theme(\n    axis.text.x = element_text(angle = 20, hjust = 1, size = 16),\n    axis.text = element_text(size = 16),    \n    axis.title = element_text(size = 20), \n    plot.title = element_text(size=20),\n  )\n\nstratified_ratios_CMIN + scale_y_log10()\n\n\n\n\n\n\n\n\n\n\n\n9.6.2 Full dataset performance (model performance)\nIn this section, the focus is no longer solely on observed concentrations (IPRED), but the performance of the models is explored by illustrating how the predicted concentrations (PRED) for all the cohorts (not just for covariates on which the model was developed) compare the the observed concentration. Visualization of PRED/IPRED ratios. In all cases we compare PRED (predicted) values to a reference IPRED (observed), which is the IPRED of the model whose cohort was used to simulate a particular set of covariates. Red lines indicate the bioequivalence range of 80-125 %.\n\n\nShow the code\n# CMIN\n# Divide each PRED by the IPRED reference \nAMOX_CMIN3 &lt;- bind_rows(AMOX_CMIN_TRAIN,AMOX_CMIN_TEST) %&gt;%\n  group_by(ID) %&gt;%\n  mutate(\n    ref_CMIN = first(CMIN_IND[REFERENCE == 1], default = NA),\n    ratio = (CMIN_PRED / ref_CMIN) * 100\n  ) %&gt;%\n  ungroup()\n\n# Boxplot of ratios stratified by model\nperf_CMIN &lt;- ggplot(AMOX_CMIN3, aes(x = MODEL, y = ratio, fill = MODEL)) +\n  geom_boxplot() +\n  scale_y_log10() +\n  geom_hline(yintercept = 80, linetype = \"dashed\", color = \"red\") + \n  geom_hline(yintercept = 125, linetype = \"dashed\", color = \"red\") +\n  labs(\n    title = \"Boxplots of predicted/observed ratios (CMIN)\",\n    x = \"MODEL\",\n    y = \"Ratio (%)\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  theme(\n    axis.text.x = element_text(angle = 20, hjust = 1, size = 16),\n    axis.text = element_text(size = 16),    \n    axis.title = element_text(size = 20), \n    plot.title = element_text(size=20),\n  )\n\nperf_CMIN",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "MIPD/Precision_dosing_methods.html#carlier-1",
    "href": "MIPD/Precision_dosing_methods.html#carlier-1",
    "title": "8  Precision dosing approaches",
    "section": "10.1 CARLIER",
    "text": "10.1 CARLIER\n\n\nShow the code\n# In this specific case predictions were already\n# created before, thus \"making predictions\"\n# simply involve loading them and filtering for the correct model\nAMOX_CMIN_PRED_TRAIN_CARLIER &lt;- read_csv(\n  here(\"Data/AMOX_CMIN_TRAIN.csv\")\n  ) |&gt; \n  filter(MODEL == \"CARLIER\")\n\nAMOX_CMIN_PRED_TEST_CARLIER &lt;- read_csv(\n  here(\"Data/AMOX_CMIN_TEST.csv\")\n  ) |&gt; \n  filter(MODEL == \"CARLIER\")\n\n\n\n\nShow the code\nresults_carlier_train &lt;- explore_predictions(AMOX_CMIN_PRED_TRAIN_CARLIER)\nresults_carlier_train$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_carlier_train &lt;- results_carlier_train$creat_plot\ncreat_plot_carlier_train\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_carlier_train &lt;- results_carlier_train$crcl_plot\ncrcl_plot_carlier_train\n\n\n\n\n\n\n\n\n\nShow the code\nresults_carlier_train$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     0.982    0.558    79.0  14.2     64.1   17.2   512\n2 Incorrect                   0.912    0.606    86.4  19.0     57.4   15.6  1363\n# ℹ 1 more variable: Proportion &lt;dbl&gt;\n\n\n\n\nShow the code\nresults_carlier_test &lt;- explore_predictions(AMOX_CMIN_PRED_TEST_CARLIER)\nresults_carlier_test$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_carlier_test &lt;- results_carlier_test$creat_plot\ncreat_plot_carlier_test\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_carlier_test &lt;- results_carlier_test$crcl_plot\ncrcl_plot_carlier_test\n\n\n\n\n\n\n\n\n\nShow the code\nresults_carlier_test$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     1.02     0.593    79.7  14.8     65.1   17.3   171\n2 Incorrect                   0.921    0.571    86.3  19.7     57.9   15.6   429\n# ℹ 1 more variable: Proportion &lt;dbl&gt;",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "MIPD/Precision_dosing_methods.html#fournier-1",
    "href": "MIPD/Precision_dosing_methods.html#fournier-1",
    "title": "8  Precision dosing approaches",
    "section": "10.2 FOURNIER",
    "text": "10.2 FOURNIER\n\n\nShow the code\n# In this specific case predictions were already\n# created before, thus \"making predictions\"\n# simply involve loading them and filtering for the correct model\nAMOX_CMIN_PRED_TRAIN_FOURNIER &lt;- read_csv(\n  here(\"Data/AMOX_CMIN_TRAIN.csv\")\n  ) |&gt; \n  filter(MODEL == \"FOURNIER\")\n\nAMOX_CMIN_PRED_TEST_FOURNIER &lt;- read_csv(\n  here(\"Data/AMOX_CMIN_TEST.csv\")\n  ) |&gt; \n  filter(MODEL == \"FOURNIER\")\n\n\n\n\nShow the code\nresults_fournier_train &lt;- explore_predictions(AMOX_CMIN_PRED_TRAIN_FOURNIER)\nresults_fournier_train$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_fournier_train &lt;- results_fournier_train$creat_plot\ncreat_plot_fournier_train\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_fournier_train &lt;- results_fournier_train$crcl_plot\ncrcl_plot_fournier_train\n\n\n\n\n\n\n\n\n\nShow the code\nresults_fournier_train$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     0.965    0.608    80.7  16.1     64.1   17.9   605\n2 Incorrect                   0.914    0.586    86.1  18.7     56.9   15.0  1270\n# ℹ 1 more variable: Proportion &lt;dbl&gt;\n\n\n\n\nShow the code\nresults_fournier_test &lt;- explore_predictions(AMOX_CMIN_PRED_TEST_FOURNIER)\nresults_fournier_test$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_fournier_test &lt;- results_fournier_test$creat_plot\ncreat_plot_fournier_test\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_fournier_test &lt;- results_fournier_test$crcl_plot\ncrcl_plot_fournier_test\n\n\n\n\n\n\n\n\n\nShow the code\nresults_fournier_test$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     0.907    0.432    79.0  15.8     62.7   16.9   191\n2 Incorrect                   0.970    0.635    86.9  19.4     58.6   16.0   409\n# ℹ 1 more variable: Proportion &lt;dbl&gt;",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "MIPD/Precision_dosing_methods.html#mellon-1",
    "href": "MIPD/Precision_dosing_methods.html#mellon-1",
    "title": "8  Precision dosing approaches",
    "section": "10.3 MELLON",
    "text": "10.3 MELLON\n\n\nShow the code\n# In this specific case predictions were already\n# created before, thus \"making predictions\"\n# simply involve loading them and filtering for the correct model\nAMOX_CMIN_PRED_TRAIN_MELLON &lt;- read_csv(\n  here(\"Data/AMOX_CMIN_TRAIN.csv\")\n  ) |&gt; \n  filter(MODEL == \"MELLON\")\n\nAMOX_CMIN_PRED_TEST_MELLON &lt;- read_csv(\n  here(\"Data/AMOX_CMIN_TEST.csv\")\n  ) |&gt; \n  filter(MODEL == \"MELLON\")\n\n\n\n\nShow the code\nresults_mellon_train &lt;- explore_predictions(AMOX_CMIN_PRED_TRAIN_MELLON)\nresults_mellon_train$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_mellon_train &lt;- results_mellon_train$creat_plot\ncreat_plot_mellon_train\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_mellon_train &lt;- results_mellon_train$crcl_plot\ncrcl_plot_mellon_train\n\n\n\n\n\n\n\n\n\nShow the code\nresults_mellon_train$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     0.681    0.177    94.9  19.3     52.9   11.9   290\n2 Incorrect                   0.977    0.630    82.4  17.2     60.4   16.8  1585\n# ℹ 1 more variable: Proportion &lt;dbl&gt;\n\n\n\n\nShow the code\nresults_mellon_test &lt;- explore_predictions(AMOX_CMIN_PRED_TEST_MELLON)\nresults_mellon_test$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_mellon_test &lt;- results_mellon_test$creat_plot\ncreat_plot_mellon_test\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_mellon_test &lt;- results_mellon_test$crcl_plot\ncrcl_plot_mellon_test\n\n\n\n\n\n\n\n\n\nShow the code\nresults_mellon_test$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     0.713    0.184    93.0  21.8     49.5   13.1    87\n2 Incorrect                   0.990    0.612    82.9  17.7     61.7   16.2   513\n# ℹ 1 more variable: Proportion &lt;dbl&gt;",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "MIPD/Precision_dosing_methods.html#rambaud-1",
    "href": "MIPD/Precision_dosing_methods.html#rambaud-1",
    "title": "8  Precision dosing approaches",
    "section": "10.4 RAMBAUD",
    "text": "10.4 RAMBAUD\n\n\nShow the code\n# In this specific case predictions were already\n# created before, thus \"making predictions\"\n# simply involve loading them and filtering for the correct model\nAMOX_CMIN_PRED_TRAIN_RAMBAUD &lt;- read_csv(\n  here(\"Data/AMOX_CMIN_TRAIN.csv\")\n  ) |&gt; \n  filter(MODEL == \"RAMBAUD\")\n\nAMOX_CMIN_PRED_TEST_RAMBAUD &lt;- read_csv(\n  here(\"Data/AMOX_CMIN_TEST.csv\")\n  ) |&gt; \n  filter(MODEL == \"RAMBAUD\")\n\n\n\n\nShow the code\nresults_rambaud_train &lt;- explore_predictions(AMOX_CMIN_PRED_TRAIN_RAMBAUD)\nresults_rambaud_train$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_rambaud_train &lt;- results_rambaud_train$creat_plot\ncreat_plot_rambaud_train\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_rambaud_train &lt;- results_rambaud_train$crcl_plot\ncrcl_plot_rambaud_train\n\n\n\n\n\n\n\n\n\nShow the code\nresults_rambaud_train$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     1.07     0.492    77.4  13.6     70.9   14.6   329\n2 Incorrect                   0.901    0.609    85.9  18.6     56.7   15.6  1546\n# ℹ 1 more variable: Proportion &lt;dbl&gt;\n\n\n\n\nShow the code\nresults_rambaud_test &lt;- explore_predictions(AMOX_CMIN_PRED_TEST_RAMBAUD)\nresults_rambaud_test$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_rambaud_test &lt;- results_rambaud_test$creat_plot\ncreat_plot_rambaud_test\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_rambaud_test &lt;- results_rambaud_test$crcl_plot\ncrcl_plot_rambaud_test\n\n\n\n\n\n\n\n\n\nShow the code\nresults_rambaud_test$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     1.09     0.645    76.5  15.2     70.1   14.1   104\n2 Incorrect                   0.921    0.560    86.1  19.0     57.8   16.0   496\n# ℹ 1 more variable: Proportion &lt;dbl&gt;",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "MIPD/Precision_dosing_methods.html#meta-model",
    "href": "MIPD/Precision_dosing_methods.html#meta-model",
    "title": "8  Precision dosing approaches",
    "section": "10.5 Meta model",
    "text": "10.5 Meta model\nThis is an ensembling method where a PopPK model is built based on data simulated with the four models (Carlier, Fournier, Mellon, and Rambaud).\nThe model is built on the training set used for the ensembling algorithms and tested on the test set. The data is rich and does not contain below quantification limit concentrations. The 3 three compartment structural model was a better fit than a two compartment one (OFV drop &lt; 0.1 %), however as the estimate of the second peripheral volume was negligeable (&lt; 1 L), the two-compartment model was preferred. The pharmacostatistical model is developed using the automatic statistical model building tool in Monolix 2024R1. The best model has IIV on all parameters with no covariance between them. The error model is combined with log-normal distribution.\nThe covariate model is built using the automatic SCM tool of Monolix with respective forward and backward p values of 5 and 1 % (Likelihood Ratio Test). CREAT and WT were added on the clearance.\n\n\nShow the code\nAMOX_CMIN_PRED_TEST_META &lt;- perform_mrgsolve_prediction(\n  input_data = AMOX_CMIN_OBS_TEST ,\n  mrgsolve_model_path = here(\n    \"MIPD/amox_Meta\"\n  ),\n  model_name = \"META\",\n  cmin_target = 60 #mg/L\n) \n\n\n\n\nShow the code\nresults_meta_test &lt;- explore_predictions(AMOX_CMIN_PRED_TEST_META)\nresults_meta_test$target_attainment \n\n\n\n\n\n\n\n\n\nShow the code\ncreat_plot_meta_test &lt;- results_meta_test$creat_plot\ncreat_plot_meta_test\n\n\n\n\n\n\n\n\n\nShow the code\ncrcl_plot_meta_test &lt;- results_meta_test$crcl_plot\ncrcl_plot_meta_test\n\n\n\n\n\n\n\n\n\nShow the code\nresults_meta_test$summary_stats \n\n\n# A tibble: 2 × 9\n  Prediction_correctness mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE sd_AGE Count\n  &lt;chr&gt;                       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;\n1 Correct                     0.839    0.301    86.3  20.4     60.4   15.7   168\n2 Incorrect                   0.993    0.651    83.6  17.9     59.7   16.6   432\n# ℹ 1 more variable: Proportion &lt;dbl&gt;",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Precision dosing approaches</span>"
    ]
  },
  {
    "objectID": "MIPD/Machine_Learning.html",
    "href": "MIPD/Machine_Learning.html",
    "title": "9  Machine learning dose prediction",
    "section": "",
    "text": "9.1 XGboost\nThe data is preprocessed to have the log-transformed daily dose as target variable which allows to reach the target concentration and the data is stratified based on dosing scheme.\nFor ML, algorithms are trained on covariates to predict the daily dose which allows to reach a concentration of 60 mg/L. The target dose is obtained by linear extrapolation to attain 60 mg/L. For intermittent infusion, the daily dose is fractioned by the number of administrations. The predictors are the covariates (WT, CREAT, BURN, OBESE, ICU, SEX, AGE) as well as the dosing scheme coded as the number of daily administrations (INF - 1 for continuous infusion).\nThe tidymodels workflow is used which is incorporated in a fit-for-purpose way in our openMIPD package.\nXGBoost is based on decision trees and the boosting algorithm, developing trees sequentially to correct the prediction errors of previous trees. Model overfitting is controlled by incorporating Lasso (L1) and Ridge (L2) algorithms. XGBoost is faster and has better computational efficiency compared to Random Forest. While XGBoost is less interpretable, it is better suited for larger datasets than Random Forest. Whereas Random Forest helps reduce variance, XGBoost primarily reduces bias.\nThe hyperparameters to define are as follows:\nShow the code\nXGB_results &lt;- openMIPD::xgb_train(train = train_preprocessed, continuous_cov = c(\"WT\", \"CREAT\", \"AGE\", \"INF\"), categorical_cov = c(\"BURN\", \"OBESE\", \"SEX\", \"ICU\"))\nA variable importance plot is generated which show the contribution of different predictors to the results. Also, the tuning and hyperparameter optimization is visualized.\nShow the code\nXGB_results$tune_plot_xgb # tuning\n\n\n\n\n\n\n\n\n\nShow the code\nXGB_results$final_wf_xgb # optimized hyperparameters\n\n\n══ Workflow ════════════════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: boost_tree()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n2 Recipe Steps\n\n• step_mutate_at()\n• step_dummy()\n\n── Model ───────────────────────────────────────────────────────────────────────\nBoosted Tree Model Specification (regression)\n\nMain Arguments:\n  trees = 223\n  min_n = 2\n  tree_depth = 10\n  learn_rate = 0.0129154966501488\n\nComputational engine: xgboost \n\n\nShow the code\nXGB_VIP &lt;- XGB_results$xgb_vip # variable importance plot\nXGB_VIP\n\n\n\n\n\n\n\n\n\nShow the code\nggsave(filename = here(\"Figures/S16a.jpg\"),\n       plot = XGB_VIP,\n       width = 8, height = 6, dpi = 600)\n\nfinal_xgb_fit &lt;- XGB_results$final_xgb_fit\nShow the code\ntest_XGB &lt;- openMIPD::xgb_test(final_fit = final_xgb_fit, test = test_preprocessed)\nShow the code\nta_results_XGB &lt;- explore_predictions(data = test_XGB, DOSE_PRED = \"XGBoost\")\nta_results_XGB$target_attainment\n\n\n\n\n\n\n\n\n\nShow the code\nta_results_XGB$summary_stats\n\n\n# A tibble: 2 × 10\n  Prediction_correctness Count Obese mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE\n  &lt;chr&gt;                  &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 Correct                  219    77      1.01     0.560    83.5  18.2     62.1\n2 Incorrect                381   140      0.917    0.587    84.9  19.0     58.6\n# ℹ 2 more variables: sd_AGE &lt;dbl&gt;, Proportion &lt;dbl&gt;",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Machine learning dose prediction</span>"
    ]
  },
  {
    "objectID": "MIPD/Machine_Learning.html#xgboost",
    "href": "MIPD/Machine_Learning.html#xgboost",
    "title": "9  Machine learning dose prediction",
    "section": "",
    "text": "η – learning rate (default: 0.3)\nγ – the minimum loss required for a new split; if increased, the algorithm becomes more conservative\nmax depth – tree depth (typical values range from 3 to 10)\nminimum child weight - minimum number of observations in the terminal node\nλ/α – regularization parameters for Ridge/Lasso\nmax levels – maximum number of nodes",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Machine learning dose prediction</span>"
    ]
  },
  {
    "objectID": "MIPD/Machine_Learning.html#random-forest",
    "href": "MIPD/Machine_Learning.html#random-forest",
    "title": "9  Machine learning dose prediction",
    "section": "9.2 Random forest",
    "text": "9.2 Random forest\nA decision tree is a model that represents possible decision paths in a schematic tree-like structure. In regression trees, node splitting is done to minimize intra-group variance. In classification trees, node purity can be measured using the Gini index, where f is the frequency of observations:\n\\[\n\\text{Gini index} = 2 \\cdot f \\cdot (1 - f)\n\\]\nIntroduced in 2001, Random Forest (RF) is a machine learning method based on an ensemble of decision trees. It uses the bootstrap aggregating algorithm (commonly known as bagging). The performance of an RF model is measured by prediction error, which corresponds to the mean squared error (MSE) for regression problems. Random Forest helps reduce variance, making it suitable for unstable, unbiased data.\nHyperparameters to define:\n\nNumber of trees (typically around 400)\nmtry – the number of variables considered at each node. Default value is \\(\\sqrt{\\text{number of predictors}}\\)\nNumber of observations in the terminal node (leaf)\n\n\n\nShow the code\nRF_results &lt;- openMIPD::rf_train(train = train_preprocessed, continuous_cov = c(\"WT\", \"CREAT\", \"AGE\", \"INF\"), categorical_cov = c(\"BURN\", \"OBESE\", \"SEX\", \"ICU\"))\n\n\nA variable importance plot is generated which show the contribution of different predictors to the results. Also, the tuning and hyperparameter optimization is visualized.\n\n\nShow the code\nRF_results$tune_plot_rf # tuning\n\n\n\n\n\n\n\n\n\nShow the code\nRF_results$final_wf_rf # optimized hyperparameters\n\n\n══ Workflow ════════════════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: rand_forest()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n2 Recipe Steps\n\n• step_mutate_at()\n• step_dummy()\n\n── Model ───────────────────────────────────────────────────────────────────────\nRandom Forest Model Specification (regression)\n\nMain Arguments:\n  mtry = 3\n  trees = 1777\n\nEngine-Specific Arguments:\n  importance = impurity\n\nComputational engine: ranger \n\n\nShow the code\nRF_VIP &lt;- RF_results$rf_vip # variable importance plot\nRF_VIP\n\n\n\n\n\n\n\n\n\nShow the code\nggsave(filename = here(\"Figures/S16b.jpg\"),\n       plot = RF_VIP,\n       width = 8, height = 6, dpi = 600)\nfinal_rf_fit &lt;- RF_results$final_rf_fit\n\n\n\n\nShow the code\ntest_RF &lt;- openMIPD::rf_test(final_fit = final_rf_fit, test = test_preprocessed)\n\n\n\n\nShow the code\nta_results_RF &lt;- explore_predictions(test_RF, DOSE_PRED = \"RF\")\nta_results_RF$target_attainment\n\n\n\n\n\n\n\n\n\nShow the code\nta_results_RF$summary_stats\n\n\n# A tibble: 2 × 10\n  Prediction_correctness Count Obese mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE\n  &lt;chr&gt;                  &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 Correct                  224    69      1.03     0.589    82.0  17.9     63.2\n2 Incorrect                376   148      0.905    0.569    85.8  19.0     58.0\n# ℹ 2 more variables: sd_AGE &lt;dbl&gt;, Proportion &lt;dbl&gt;",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Machine learning dose prediction</span>"
    ]
  },
  {
    "objectID": "MIPD/Machine_Learning.html#support-vector-machine",
    "href": "MIPD/Machine_Learning.html#support-vector-machine",
    "title": "9  Machine learning dose prediction",
    "section": "9.3 Support Vector Machine",
    "text": "9.3 Support Vector Machine\nIntroduced in 1995, Support Vector Machines (SVM) classify data by finding a hyperplane that maximizes the distance between classes in a multi-dimensional space. SVM regression predicts a continuous target by fitting a function with a tolerance for small deviations from the true values and penalizing large errors. SVM regression can capture non-linear relationships and is less sensible to outliers compared to linear regression. Unlike K-Nearest Neighbors (KNN), SVM is effective for high-dimensional data.\n\nCost – regularization parameter that determines the weight given to classification errors. If cost increases, tolerance for classification errors decreases. A smaller cost improves generalizability.\nσ – controls the shape of the decision boundary. A smaller value captures local trends better but may lead to overfitting and reduced generalizability.\n\n\n\nShow the code\nSVM_results &lt;- openMIPD::svm_train(train = train_preprocessed, continuous_cov = c(\"WT\", \"CREAT\", \"AGE\", \"INF\"), categorical_cov = c(\"BURN\", \"OBESE\", \"SEX\", \"ICU\"))\n\n\n\n\nShow the code\nSVM_results$tune_plot_svm # tuning\n\n\n\n\n\n\n\n\n\nShow the code\nSVM_results$final_wf_svm # optimized hyperparameters\n\n\n══ Workflow ════════════════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: svm_rbf()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n3 Recipe Steps\n\n• step_mutate_at()\n• step_dummy()\n• step_normalize()\n\n── Model ───────────────────────────────────────────────────────────────────────\nRadial Basis Function Support Vector Machine Model Specification (regression)\n\nMain Arguments:\n  cost = 0.0992125657480125\n  rbf_sigma = 0.0774263682681128\n\nComputational engine: kernlab \n\n\nShow the code\nfinal_svm_fit &lt;- SVM_results$final_svm_fit\n\n\n\n\nShow the code\ntest_SVM &lt;- openMIPD::svm_test(final_fit = final_svm_fit, test = test_preprocessed)\n\n\n\n\nShow the code\nta_results_SVM &lt;- explore_predictions(test_SVM, DOSE_PRED = \"SVM\")\nta_results_SVM$target_attainment\n\n\n\n\n\n\n\n\n\nShow the code\nta_results_SVM$summary_stats\n\n\n# A tibble: 2 × 10\n  Prediction_correctness Count Obese mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE\n  &lt;chr&gt;                  &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 Correct                  222    84      0.987    0.543    84.7  19.2     61.3\n2 Incorrect                378   133      0.929    0.598    84.2  18.4     59.1\n# ℹ 2 more variables: sd_AGE &lt;dbl&gt;, Proportion &lt;dbl&gt;",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Machine learning dose prediction</span>"
    ]
  },
  {
    "objectID": "MIPD/Machine_Learning.html#k-nearest-neighbors-knn",
    "href": "MIPD/Machine_Learning.html#k-nearest-neighbors-knn",
    "title": "9  Machine learning dose prediction",
    "section": "9.4 K-nearest neighbors (KNN)",
    "text": "9.4 K-nearest neighbors (KNN)\nKNN is a simple, non-parametric algorithm that is less sensitive to outliers and is used to create clusters and make predictions based on the similarity of data points. The disadvantage of KNN is that the algorithm can take a long time to run, and it is less suited for high-dimensional data.\n\nThe value of k is determined through 10-fold cross-validation.\nThe distance is calculated between all data points and the target point.\nThe k nearest neighbors are selected.\nThe average of the target values of these nearest neighbors will be the prediction for the given point.\n\nThe most commonly used distance metrics are as follows:\n\nEuclidean Distance: The most commonly used; a straight line connecting two points in vector space. This distance is well-suited for outliers and noise but less suitable for data with different scales or high dimensionality. \\[\nd(x, y) = \\sqrt{(x - y)^2}\n\\]\nManhattan Distance: Well-suited for categorical data and high-dimensional data. It is less suitable for data with different scales.\n\n\\[\nd(x, y) = |x - y|\n\\]\n\nMinkowski Distance: A generalization of the two previous distances. It has an additional parameter, p, that controls the importance given to differences between data points. If p = 2, it becomes the Euclidean distance, and if p = 1, it becomes the Manhattan distance. This distance is suitable for mixed data but is less interpretable, and the value of p needs to be defined.\n\n\\[\nd(x, y) = \\left| (x - y)^p \\right|^{1/p}\n\\]\nEuclidean distance is the default distance used and it is the most interpretable and intuitive. Hyperparameters to define:\n\nk\np (if Minkowski distance is used)\n\n\n\nShow the code\nKNN_results &lt;- openMIPD::knn_train(train = train_preprocessed, continuous_cov = c(\"WT\", \"CREAT\", \"AGE\", \"INF\"), categorical_cov = c(\"BURN\", \"OBESE\", \"SEX\", \"ICU\"))\n\n\n\n\nShow the code\nKNN_results$tune_plot_knn # tuning\n\n\n\n\n\n\n\n\n\nShow the code\nKNN_results$final_wf_knn # optimized hyperparameters\n\n\n══ Workflow ════════════════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: nearest_neighbor()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n3 Recipe Steps\n\n• step_mutate_at()\n• step_dummy()\n• step_normalize()\n\n── Model ───────────────────────────────────────────────────────────────────────\nK-Nearest Neighbor Model Specification (regression)\n\nMain Arguments:\n  neighbors = 15\n\nComputational engine: kknn \n\n\nShow the code\nfinal_knn_fit &lt;- KNN_results$final_knn_fit\n\n\n\n\nShow the code\ntest_KNN &lt;- openMIPD::knn_test(final_fit = final_knn_fit, test = test_preprocessed)\n\n\n\n\nShow the code\nta_results_KNN &lt;- explore_predictions(test_KNN, DOSE_PRED = \"KNN\")\nta_results_KNN$target_attainment\n\n\n\n\n\n\n\n\n\nShow the code\nta_results_KNN$summary_stats\n\n\n# A tibble: 2 × 10\n  Prediction_correctness Count Obese mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE\n  &lt;chr&gt;                  &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 Correct                  218    77      1.02     0.621    82.8  19.5     62.8\n2 Incorrect                382   140      0.909    0.550    85.3  18.2     58.3\n# ℹ 2 more variables: sd_AGE &lt;dbl&gt;, Proportion &lt;dbl&gt;",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Machine learning dose prediction</span>"
    ]
  },
  {
    "objectID": "MIPD/Machine_Learning.html#stacking",
    "href": "MIPD/Machine_Learning.html#stacking",
    "title": "9  Machine learning dose prediction",
    "section": "9.5 Stacking",
    "text": "9.5 Stacking\nThe blend_predictions function determines how member model output will ultimately be combined in the final prediction by fitting a Lasso model on the data stack, predicting the true assessment set outcome using the predictions from each of the candidate members. Candidates with nonzero stacking coefficients become members.\nThese plots the meta-learning model over a predefined grid of lasso penalty values and uses an internal resampling method to determine the best value. The autoplot() method, shown helps us understand if the default penalization method was sufficient. It can also be used to visualize the contribution of each model type.\n\n\nShow the code\namox_cmin &lt;- stacks() %&gt;%\n    add_candidates(XGB_results$tune_res_xgb) %&gt;%\n    add_candidates(SVM_results$tune_res_svm) %&gt;%\n    add_candidates(RF_results$tune_res_rf) %&gt;%\n    add_candidates(KNN_results$tune_res_knn)\n  \n  conflicted::conflicts_prefer(brulee::coef)\n  \n  set.seed(1234)\n  amox_cmin_ens &lt;- amox_cmin %&gt;% blend_predictions()\n  \n  # fit ensembled members\n  set.seed(1234)\n  amox_cmin_ens &lt;- amox_cmin_ens %&gt;% fit_members()\n\n\nTo evaluate training, the evolution of metrics with the number of members and the contribution of different stacking members are plotted.\n\n\nShow the code\n  # Stacking plots\n  stacking_autoplot_default &lt;- autoplot(amox_cmin_ens)\n  stacking_members_plot &lt;- autoplot(amox_cmin_ens, type = \"members\")\n  stacking_weights_plot &lt;- autoplot(amox_cmin_ens, type = \"weights\")\n  ggsave(filename = here(\"Figures/S17.jpg\"),\n       plot = stacking_weights_plot,\n       width = 8, height = 6, dpi = 600)\n  \n  stacking_autoplot_default\n\n\n\n\n\n\n\n\n\nShow the code\n  stacking_members_plot\n\n\n\n\n\n\n\n\n\nShow the code\n  stacking_weights_plot\n\n\n\n\n\n\n\n\n\n\n\nShow the code\n  # Make predictions with stacking\n  stack_preds &lt;- predict(amox_cmin_ens, new_data = test_preprocessed) %&gt;%\n    dplyr::pull(.pred)\n\n\nTarget attainment and corresponding statistics are calculated for the predictions.\n\n\nShow the code\n  # Add stacking to the test table\n  test_STACK &lt;- test_preprocessed %&gt;%\n    dplyr::mutate(\n      STACK = exp(stack_preds) * (II / 24)\n    )\n  \nta_results_STACK &lt;- explore_predictions(test_STACK, DOSE_PRED = \"STACK\")\nta_results_STACK$target_attainment\n\n\n\n\n\n\n\n\n\nShow the code\nta_results_STACK$summary_stats\n\n\n# A tibble: 2 × 10\n  Prediction_correctness Count Obese mean_CREAT sd_CREAT mean_WT sd_WT mean_AGE\n  &lt;chr&gt;                  &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;\n1 Correct                  165    51      0.983    0.555    80.5  16.7     66.2\n2 Incorrect                435   166      0.938    0.588    85.9  19.2     57.5\n# ℹ 2 more variables: sd_AGE &lt;dbl&gt;, Proportion &lt;dbl&gt;",
    "crumbs": [
      "MIPD",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Machine learning dose prediction</span>"
    ]
  },
  {
    "objectID": "Sensitivity_analysis/Sensitivity_analysis_explication.html",
    "href": "Sensitivity_analysis/Sensitivity_analysis_explication.html",
    "title": "10  Sensitivity analysis",
    "section": "",
    "text": "10.1 Dosing scheme\nThis folder contains the codes which are necessary to execute a sensitivity analysis combined with the other codes found in this repository (for example, the functions for the different MIPD methods).\nOur main approach was to use cohort-based dosing regimens. In this sensitivity analysis, we tested the simulation of the same dosing scheme for every subject. Two dosing regimens were tested, one continuous (10 g/day) and an intermittent (0.5 h infusion of 1000 mg four times daily). In the Dosing_scheme folder the codes can be found to simulate these two dosing schemes, then the same codes can be applied as in the MIPD folder.",
    "crumbs": [
      "Sensitivity analysis",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Sensitivity analysis</span>"
    ]
  },
  {
    "objectID": "Sensitivity_analysis/Sensitivity_analysis_explication.html#model-exclusion",
    "href": "Sensitivity_analysis/Sensitivity_analysis_explication.html#model-exclusion",
    "title": "10  Sensitivity analysis",
    "section": "10.2 Model exclusion",
    "text": "10.2 Model exclusion\nInstead of using all four PopPK models, all combinations involving the removal of one or two models from the simulated training set were explored. In the Model_exclusion folder the code can be found to create folders with training datasets with the same number of subjects, but with only two or three models and model cohorts.",
    "crumbs": [
      "Sensitivity analysis",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Sensitivity analysis</span>"
    ]
  },
  {
    "objectID": "Sensitivity_analysis/Sensitivity_analysis_explication.html#number-of-subjects",
    "href": "Sensitivity_analysis/Sensitivity_analysis_explication.html#number-of-subjects",
    "title": "10  Sensitivity analysis",
    "section": "10.3 Number of subjects",
    "text": "10.3 Number of subjects\nOriginally, 1900 subjects were simulated for model training. In this sensitivity analysis, one hundred datasets were generated for each of the following sample sizes: 100, 300, 600, 1200, 1900, 2500, and 3000. In the Number_of_subjects folder, the code can be found to simulate 300000 virtual subjects (to have enough subjects for the 100 replicates of the subject size of 3000), then simulate concentrations for these subjects in the form of a parquet dataset. Finally, 100 non-overlapping datasets are created for each subject size in different subfolders.",
    "crumbs": [
      "Sensitivity analysis",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Sensitivity analysis</span>"
    ]
  }
]